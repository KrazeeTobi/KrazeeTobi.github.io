<HTML>
<HEAD>
   <META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-8859-1">
   <META NAME="GENERATOR" CONTENT="Mozilla/4.04 [en] (Win95; I) [Netscape]">
   <TITLE>General Conventions for Makefiles</TITLE>
</HEAD>
<BODY>
<A NAME="Top"></A><A HREF="make.html">Contents</A>|<A HREF="makeindex.html">Index</A>|<A HREF="makeMakefile_Conventions.html">Previous</A>|<A HREF="makeUtilities_in_Makefiles.html">Next</A>
<BR><A NAME="off_2590724"></A><A NAME="e692ad09"></A><B><FONT FACE="Futura Md BT"><FONT SIZE=+3>General
conventions for makefiles</FONT></FONT></B>
<BR>
<HR SIZE=3 WIDTH="100%"><FONT FACE="Times New Roman"><FONT SIZE=+1>Every
makefile should contain the following line to avoid trouble on systems
where the </FONT></FONT><FONT FACE="Courier New"><FONT SIZE=+0>SHELL</FONT></FONT><FONT FACE="Times New Roman"><FONT SIZE=+1>
variable might be inherited from the environment. (This is never a problem
with GNU </FONT></FONT><FONT FACE="Courier New"><FONT SIZE=+0>make</FONT></FONT><FONT FACE="Times New Roman"><FONT SIZE=+1>.)</FONT></FONT>
<BR>&nbsp;
<UL><FONT FACE="Courier New"><FONT SIZE=+0>SHELL = /bin/sh</FONT></FONT></UL>


<P><FONT FACE="Times New Roman"><FONT SIZE=+1>Different </FONT></FONT><FONT FACE="Courier New"><FONT SIZE=+0>make</FONT></FONT><FONT FACE="Times New Roman"><FONT SIZE=+1>
programs have incompatible suffix lists and implicit rules, and this sometimes
creates confusion or misbehavior.</FONT></FONT>

<P><FONT FACE="Times New Roman"><FONT SIZE=+1>So it is a good idea to set
the suffix list explicitly using only the suffixes you need in the particular
Makefile, using something like the following.</FONT></FONT>
<BR>&nbsp;
<UL><FONT FACE="Courier New"><FONT SIZE=+0>.SUFFIXES:</FONT></FONT>
<BR><FONT FACE="Courier New"><FONT SIZE=+0>.SUFFIXES: .c .o</FONT></FONT></UL>


<P><FONT FACE="Times New Roman"><FONT SIZE=+1>The first line clears out
the suffix list, the second introduces all suffixes which may be subject
to implicit rules in this Makefile.</FONT></FONT>

<P><FONT FACE="Times New Roman"><FONT SIZE=+1>Don’t assume that ‘</FONT></FONT><FONT FACE="Courier New"><FONT SIZE=+0>.</FONT></FONT><FONT FACE="Times New Roman"><FONT SIZE=+1>’
is in the path for command execution. When you need to run programs that
are a part of your package during the make, please make sure that it uses
‘</FONT></FONT><FONT FACE="Courier New"><FONT SIZE=+0>./</FONT></FONT><FONT FACE="Times New Roman"><FONT SIZE=+1>’
if the program is built as part of the make or ‘</FONT></FONT><FONT FACE="Courier New"><FONT SIZE=+0>$(srcdir)/</FONT></FONT><FONT FACE="Times New Roman"><FONT SIZE=+1>’
if the file is an unchanging part of the source code. Without one of these
prefixes, the current search path is used.</FONT></FONT>

<P><FONT FACE="Times New Roman"><FONT SIZE=+1>The&nbsp;<A NAME="srcdir"></A>distinction
between ‘</FONT></FONT><FONT FACE="Courier New"><FONT SIZE=+0>./</FONT></FONT><FONT FACE="Times New Roman"><FONT SIZE=+1>’
and ‘</FONT></FONT><FONT FACE="Courier New"><FONT SIZE=+0>$(srcdir)/</FONT></FONT><FONT FACE="Times New Roman"><FONT SIZE=+1>’
is important when using the ‘</FONT></FONT><FONT FACE="Courier New"><FONT SIZE=+0>--srcdir</FONT></FONT><FONT FACE="Times New Roman"><FONT SIZE=+1>’
option to ‘</FONT></FONT><FONT FACE="Courier New"><FONT SIZE=+0>configure</FONT></FONT><FONT FACE="Times New Roman"><FONT SIZE=+1>’.
A rule of the following form will fail when the current directory is not
the source directory, because ‘</FONT></FONT><FONT FACE="Courier New"><FONT SIZE=+0>foo.man</FONT></FONT><FONT FACE="Times New Roman"><FONT SIZE=+1>’
and ‘</FONT></FONT><FONT FACE="Courier New"><FONT SIZE=+0>sedscript</FONT></FONT><FONT FACE="Times New Roman"><FONT SIZE=+1>’
are not in the current directory.</FONT></FONT>
<BR>&nbsp;
<UL><FONT FACE="Courier New"><FONT SIZE=+0>foo.1 : foo.man sedscript</FONT></FONT>
<BR><FONT FACE="Courier New"><FONT SIZE=+0>sed -e sedscript foo.man > foo.1</FONT></FONT></UL>


<P><FONT FACE="Times New Roman"><FONT SIZE=+1>When using GNU </FONT></FONT><FONT FACE="Courier New"><FONT SIZE=+0>make</FONT></FONT><FONT FACE="Times New Roman"><FONT SIZE=+1>,
relying on ‘</FONT></FONT><FONT FACE="Courier New"><FONT SIZE=+0>VPATH</FONT></FONT><FONT FACE="Times New Roman"><FONT SIZE=+1>’
to find the source file will work in the case where there is a single dependency
file, since the ‘</FONT></FONT><FONT FACE="Courier New"><FONT SIZE=+0>make</FONT></FONT><FONT FACE="Times New Roman"><FONT SIZE=+1>’
automatic variable ‘</FONT></FONT><FONT FACE="Courier New"><FONT SIZE=+0>$&lt;</FONT></FONT><FONT FACE="Times New Roman"><FONT SIZE=+1>’
will represent the source file wherever it is. (Many versions of </FONT></FONT><FONT FACE="Courier New"><FONT SIZE=+0>make</FONT></FONT><FONT FACE="Times New Roman"><FONT SIZE=+1>
set ‘</FONT></FONT><FONT FACE="Courier New"><FONT SIZE=+0>$&lt;</FONT></FONT><FONT FACE="Times New Roman"><FONT SIZE=+1>’
only in implicit rules.) A makefile target like the following should instead
be re-written in order to allow ‘</FONT></FONT><FONT FACE="Courier New"><FONT SIZE=+0>VPATH</FONT></FONT><FONT FACE="Times New Roman"><FONT SIZE=+1>’
to work correctly.</FONT></FONT>
<BR>&nbsp;
<UL><FONT FACE="Courier New"><FONT SIZE=+0>foo.o : bar.c</FONT></FONT>
<BR><FONT FACE="Courier New"><FONT SIZE=+0>$(CC) -I. -I$(srcdir) $(CFLAGS)
-c bar.c -o foo.o</FONT></FONT></UL>


<P><FONT FACE="Times New Roman"><FONT SIZE=+1>The makefile should be written
like the following.</FONT></FONT>
<BR>&nbsp;
<UL><FONT FACE="Courier New"><FONT SIZE=+0>foo.o : bar.c</FONT></FONT>
<BR><FONT FACE="Courier New"><FONT SIZE=+0>$(CC) -I. -I$(srcdir) $(CFLAGS)
-c $&lt; -o $@</FONT></FONT></UL>


<P><FONT FACE="Times New Roman"><FONT SIZE=+1>When the target has multiple
dependencies, using an explicit ‘</FONT></FONT><FONT FACE="Courier New"><FONT SIZE=+0>\$(srcdir)</FONT></FONT><FONT FACE="Times New Roman"><FONT SIZE=+1>’
is the easiest way to make the rule work well. For instance, the previous
target for ‘</FONT></FONT><FONT FACE="Courier New"><FONT SIZE=+0>foo.1</FONT></FONT><FONT FACE="Times New Roman"><FONT SIZE=+1>’
(see </FONT></FONT><FONT FACE="Courier New"><FONT COLOR="#008000"><FONT SIZE=+0><A HREF="#srcdir">(srcdir)</A></FONT></FONT></FONT><FONT FACE="Times New Roman"><FONT SIZE=+1>
) is best written as the following.</FONT></FONT>
<BR>&nbsp;
<UL><FONT FACE="Courier New"><FONT SIZE=+0>foo.1 : foo.man sedscript</FONT></FONT>
<BR><FONT FACE="Courier New"><FONT SIZE=+0>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
sed -e $(srcdir)/sedscript $(srcdir)/foo.man > $@</FONT></FONT></UL>

<CENTER>
<HR SIZE=3 WIDTH="100%"></CENTER>

<CENTER><A HREF="#Top">Top</A>|<A HREF="make.html">Contents</A>|<A HREF="makeindex.html">Index</A>|<A HREF="makeMakefile_Conventions.html">Previous</A>|<A HREF="makeUtilities_in_Makefiles.html">Next</A></CENTER>

</BODY>
</HTML>
