<HTML>
<HEAD>
   <META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-8859-1">
   <META NAME="GENERATOR" CONTENT="Mozilla/4.04 [en] (Win95; I) [Netscape]">
   <TITLE>Errors in Commands</TITLE>
</HEAD>
<BODY>
<A NAME="Top"></A><A HREF="make.html">Contents</A>|<A HREF="makeindex.html">Index</A>|<A HREF="makeParallel_Execution.html">Previous</A>|<A HREF="makeInterrupting_or_Killing_make.html">Next</A>
<BR><A NAME="off_886073"></A><A NAME="a00d5cca"></A><B><FONT FACE="Futura Md BT"><FONT SIZE=+3>Errors
in commands</FONT></FONT></B>
<BR>
<HR SIZE=3 WIDTH="100%"><FONT FACE="Times New Roman"><FONT SIZE=+1>After
each shell command returns, </FONT></FONT><FONT FACE="Courier New"><FONT SIZE=+0>make</FONT></FONT><FONT FACE="Times New Roman"><FONT SIZE=+1>
looks at its exit status. If the command completed successfully, the next
command line is executed in a new shell; after the last command line is
finished, the rule is finished.</FONT></FONT>

<P><FONT FACE="Times New Roman"><FONT SIZE=+1>If there is an error (the
exit status is nonzero), </FONT></FONT><FONT FACE="Courier New"><FONT SIZE=+0>make</FONT></FONT><FONT FACE="Times New Roman"><FONT SIZE=+1>
gives up on the current rule, and perhaps on all rules.</FONT></FONT>

<P><FONT FACE="Times New Roman"><FONT SIZE=+1>Sometimes the failure of
a certain command does not indicate a problem. For example, you may use
the </FONT></FONT><FONT FACE="Courier New"><FONT SIZE=+0>mkdir</FONT></FONT><FONT FACE="Times New Roman"><FONT SIZE=+1>
command to ensure that a directory exists. If the directory already exists,
</FONT></FONT><FONT FACE="Courier New"><FONT SIZE=+0>mkdir</FONT></FONT><FONT FACE="Times New Roman"><FONT SIZE=+1>
will report an error, but you probably want </FONT></FONT><B><FONT FACE="Courier New"><FONT SIZE=+0>make</FONT></FONT></B><FONT FACE="Times New Roman"><FONT SIZE=+1>
to continue regardless.</FONT></FONT>

<P><FONT FACE="Times New Roman"><FONT SIZE=+1>To ignore errors in a command
line, write a ‘</FONT></FONT><B><FONT FACE="Courier New"><FONT SIZE=+0>-</FONT></FONT></B><FONT FACE="Times New Roman"><FONT SIZE=+1>’
at the beginning of the line’s text (after the initial tab). The ‘</FONT></FONT><B><FONT FACE="Courier New"><FONT SIZE=+0>-</FONT></FONT></B><FONT FACE="Times New Roman"><FONT SIZE=+1>’
is discarded before the command is passed to the shell for execution, as
in the following example.</FONT></FONT>
<UL><FONT FACE="Courier New"><FONT SIZE=+0>clean:</FONT></FONT>
<BR><FONT FACE="Courier New"><FONT SIZE=+0>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
-rm -f *.o</FONT></FONT></UL>
<FONT FACE="Times New Roman"><FONT SIZE=+1>This causes </FONT></FONT><FONT FACE="Courier New"><FONT SIZE=+0>rm</FONT></FONT><FONT FACE="Times New Roman"><FONT SIZE=+1>
to continue even if it is unable to remove a file.</FONT></FONT>

<P><FONT FACE="Times New Roman"><FONT SIZE=+1>When you run </FONT></FONT><B><FONT FACE="Courier New"><FONT SIZE=+0>make</FONT></FONT></B><FONT FACE="Times New Roman"><FONT SIZE=+1>
with the ‘</FONT></FONT><FONT FACE="Courier New"><FONT SIZE=+0>-i</FONT></FONT><FONT FACE="Times New Roman"><FONT SIZE=+1>’
or ‘</FONT></FONT><FONT FACE="Courier New"><FONT SIZE=+0>--ignore-errors</FONT></FONT><FONT SIZE=+1><FONT FACE="Times New Roman">’
flag, errors are ignored in all commands of all rules. A rule in the makefile
for the special target, </FONT><TT>.IGNORE</TT><FONT FACE="Times New Roman">,
has the same effect, if there are no dependencies. These ways of ignoring
errors are obsolete because ‘</FONT></FONT><B><FONT FACE="Courier New"><FONT SIZE=+0>-</FONT></FONT></B><FONT FACE="Times New Roman"><FONT SIZE=+1>’
is more flexible.</FONT></FONT>

<P><FONT FACE="Times New Roman"><FONT SIZE=+1>When errors are to be ignored,
because of either a ‘</FONT></FONT><B><FONT FACE="Courier New"><FONT SIZE=+0>-</FONT></FONT></B><FONT FACE="Times New Roman"><FONT SIZE=+1>’
or the ‘</FONT></FONT><FONT FACE="Courier New"><FONT SIZE=+0><B>-</B>i</FONT></FONT><FONT FACE="Times New Roman"><FONT SIZE=+1>’
flag, </FONT></FONT><B><FONT FACE="Courier New"><FONT SIZE=+0>make</FONT></FONT></B><FONT FACE="Times New Roman"><FONT SIZE=+1>
treats an error return just like success, except that it prints out a message
that tells you the status code the command exited with, and says that the
error has been ignored.</FONT></FONT>

<P><FONT FACE="Times New Roman"><FONT SIZE=+1>When an error happens that
</FONT></FONT><B><FONT FACE="Courier New"><FONT SIZE=+0>make</FONT></FONT></B><FONT FACE="Times New Roman"><FONT SIZE=+1>
has not been told to ignore, it implies that the current target cannot
be correctly remade, and neither can any other that depends on it either
directly or indirectly. No further commands will be executed for these
targets, since their preconditions have not been achieved.</FONT></FONT>

<P><FONT FACE="Times New Roman"><FONT SIZE=+1>Normally </FONT></FONT><B><FONT FACE="Courier New"><FONT SIZE=+0>make</FONT></FONT></B><FONT FACE="Times New Roman"><FONT SIZE=+1>
gives up immediately in this circumstance, returning a nonzero status.
However, if the ‘</FONT></FONT><FONT FACE="Courier New"><FONT SIZE=+0>-k</FONT></FONT><FONT FACE="Times New Roman"><FONT SIZE=+1>’
or ‘</FONT></FONT><FONT FACE="Courier New"><FONT SIZE=+0>--keep-going</FONT></FONT><FONT FACE="Times New Roman"><FONT SIZE=+1>’
flag is specified, </FONT></FONT><B><FONT FACE="Courier New"><FONT SIZE=+0>make</FONT></FONT></B><FONT FACE="Times New Roman"><FONT SIZE=+1>
continues to consider the other dependencies of the pending targets, remaking
them if necessary, before it gives up and returns nonzero status. For example,
after an error in compiling one object file, ‘</FONT></FONT><FONT FACE="Courier New"><FONT SIZE=+0>make
-k</FONT></FONT><FONT FACE="Times New Roman"><FONT SIZE=+1>’ will continue
compiling other object files even though it already knows that linking
them will be impossible. See <FONT COLOR="#008000"><A HREF="makeSummary_of_Options.html">Summary
of options</A></FONT>.</FONT></FONT>

<P><FONT FACE="Times New Roman"><FONT SIZE=+1>The usual behavior assumes
that your purpose is to get the specified targets up to date; once </FONT></FONT><B><FONT FACE="Courier New"><FONT SIZE=+0>make</FONT></FONT></B><FONT FACE="Times New Roman"><FONT SIZE=+1>
learns that this is impossible, it might as well report the failure immediately.
The ‘</FONT></FONT><FONT FACE="Courier New"><FONT SIZE=+0>-k</FONT></FONT><FONT FACE="Times New Roman"><FONT SIZE=+1>’
option says that the real purpose is to test as many of the changes made
in the program as possible, perhaps to find several independent problems
so that you can correct them all before the next attempt to compile.</FONT></FONT>

<P><FONT FACE="Times New Roman"><FONT SIZE=+1>This is why Emacs’ </FONT></FONT><FONT FACE="Courier New"><FONT SIZE=+0>compile</FONT></FONT><FONT FACE="Times New Roman"><FONT SIZE=+1>
command passes the ‘</FONT></FONT><FONT FACE="Courier New"><FONT SIZE=+0>-k</FONT></FONT><FONT FACE="Times New Roman"><FONT SIZE=+1>’
flag by default.</FONT></FONT>

<P><FONT FACE="Times New Roman"><FONT SIZE=+1>Usually when a command fails,
if it has changed the target file at all, the file is corrupted and cannot
be used—or at least it is not completely updated. Yet the file’s timestamp
says that it is now up to date, so the next time </FONT></FONT><B><FONT FACE="Courier New"><FONT SIZE=+0>make</FONT></FONT></B><FONT FACE="Times New Roman"><FONT SIZE=+1>
runs, it will not try to update that file. The situation is just the same
as when the command is killed by a signal; see <FONT COLOR="#008000"><A HREF="makeInterrupting_or_Killing_make.html">Interrupting
or killing </A></FONT></FONT></FONT><B><FONT FACE="Courier New"><FONT COLOR="#008000"><FONT SIZE=+0><A HREF="makeInterrupting_or_Killing_make.html">make</A></FONT></FONT></FONT></B><FONT FACE="Times New Roman"><FONT SIZE=+1>.
So generally the right thing to do is to delete the target file if the
command fails after beginning to change the file. </FONT></FONT><B><FONT FACE="Courier New"><FONT SIZE=+0>make</FONT></FONT></B><FONT FACE="Times New Roman"><FONT SIZE=+1>
will do this if </FONT></FONT><FONT FACE="Courier New"><FONT SIZE=+0>.DELETE_ON_ERROR</FONT></FONT><FONT FACE="Times New Roman"><FONT SIZE=+1>
appears as a target. This is almost always what you want </FONT></FONT><FONT FACE="Courier New"><FONT SIZE=+0>make</FONT></FONT><FONT FACE="Times New Roman"><FONT SIZE=+1>
to do, but it is not historical practice; so for compatibility, you must
explicitly request it.</FONT></FONT>
<CENTER>
<HR SIZE=3 WIDTH="100%"></CENTER>

<CENTER><A HREF="#Top">Top</A>|<A HREF="make.html">Contents</A>|<A HREF="makeindex.html">Index</A>|<A HREF="makeParallel_Execution.html">Previous</A>|<A HREF="makeInterrupting_or_Killing_make.html">Next</A></CENTER>

</BODY>
</HTML>
