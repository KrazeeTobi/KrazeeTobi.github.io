<!doctype html public "-//w3c//dtd html 4.0 transitional//en">
<html>
<head>
   <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
   <meta name="GENERATOR" content="Mozilla/4.51 [en] (Win95; I) [Netscape]">
   <title>collect2</title>
</head>
<body>
<a NAME="Top"></a><a href="gcc.html">Contents</a>|<a href="gccindex.html">Index</a>|<a href="gccActually_Building_the_CrossCompi.html">Previous</a>|<a href="gccInstalling_GNU_CC_on_the_Sun.html">Next</a>
<br><a NAME="off_3147278"></a><a NAME="2dd2b1e6"></a><b><font color="#000000"><tt><font point-size="24">collect2</font></tt><font face="Futura Md BT"><font size=+3>
and cross-compiling</font></font><tt><font point-size="24">&nbsp;</font></tt></font></b><tt><font point-size="24"><font color="#000000">&nbsp;</font></font></tt>
<hr SIZE=6 WIDTH="100%">
<br><font face="Times New Roman"><font size=+1>Many target systems do not
have support in the assembler and linker for “constructors”—initialization
functions to be called before the official “start” of </font></font><font face="Courier New"><font size=+0>main</font></font><font face="Times New Roman"><font size=+1>.
On such systems, GNU CC uses a utility called </font></font><font face="Courier New"><font size=+0>collect2</font></font><font face="Times New Roman"><font size=+1>
to arrange to call these functions at start time.</font></font>
<p><font face="Times New Roman"><font size=+1>The program </font></font><font face="Courier New"><font size=+0>collect2</font></font><font face="Times New Roman"><font size=+1>
works by linking the program once and looking through the linker output
file for symbols with particular names indicating they are constructor
functions. If it finds any, it creates a new temporary ‘</font></font><font face="Courier New"><font size=+0>.c</font></font><font face="Times New Roman"><font size=+1>’
file containing a table of them, compiles it, and links the program a second
time including that file.</font></font>
<p><font face="Times New Roman"><font size=+1>The actual calls to the constructors
are carried out by a subroutine called </font></font><font face="Courier New"><font size=+0>__main</font></font><font face="Times New Roman"><font size=+1>,
which is called (automatically) at the beginning of the body of main (provided
</font></font><font face="Courier New"><font size=+0>main</font></font><font face="Times New Roman"><font size=+1>
was compiled with GNU CC).</font></font>
<p><font face="Times New Roman"><font size=+1>Calling </font></font><font face="Courier New"><font size=+0>__main</font></font><font face="Times New Roman"><font size=+1>
is necessary, even when compiling C code, to allow linking C and C++ object
code together. (If you use ‘</font></font><font face="Courier New"><font size=+0>-nostdlib</font></font><font face="Times New Roman"><font size=+1>’,
you get an unresolved reference to </font></font><font face="Courier New"><font size=+0>__main</font></font><font face="Times New Roman"><font size=+1>,
since it’s defined in the standard </font></font><font face="Courier New"><font size=+0>gcc</font></font><font face="Times New Roman"><font size=+1>
library. Include</font></font> <font face="Times New Roman"><font size=+1>‘</font></font><font face="Courier New"><font size=+0>-lgcc</font></font><font face="Times New Roman"><font size=+1>’
at the end of your compiler command line to resolve this reference.)</font></font>
<p><font face="Times New Roman"><font size=+1>The program, </font></font><font face="Courier New"><font size=+0>collect2</font></font><font face="Times New Roman"><font size=+1>,
is installed as ‘</font></font><font face="Courier New"><font size=+0>ld</font></font><font face="Times New Roman"><font size=+1>’
in the directory where the passes of the compiler are installed. When </font></font><font face="Courier New"><font size=+0>collect2</font></font><font face="Times New Roman"><font size=+1>
needs to find the <i>real</i> ‘</font></font><font face="Courier New"><font size=+0>ld</font></font><font face="Times New Roman"><font size=+1>’,
it tries the following filenames.</font></font>
<ul TYPE=SQUARE>
<li>
<font face="Times New Roman"><font size=+1>‘</font></font><font face="Courier New"><font size=+0>real-ld</font></font><font face="Times New Roman"><font size=+1>’
in the directories listed in the compiler’s search directories.</font></font></li>

<li>
<font face="Times New Roman"><font size=+1>‘</font></font><font face="Courier New"><font size=+0>real-ld</font></font><font face="Times New Roman"><font size=+1>’
in the directories listed in the environment variable </font></font><font face="Courier New"><font size=+0>PATH</font></font><font face="Times New Roman"><font size=+1>.</font></font></li>

<li>
<font face="Times New Roman"><font size=+1>The file specified in the </font></font><font face="Courier New"><font size=+0>REAL_LD_FILE_NAME</font></font><font face="Times New Roman"><font size=+1>
configuration macro, if specified.</font></font></li>

<li>
<font face="Times New Roman"><font size=+1>‘</font></font><font face="Courier New"><font size=+0>ld</font></font><font face="Times New Roman"><font size=+1>’
in the compiler’s search directories, except that </font></font><font face="Courier New"><font size=+0>collect2</font></font><font face="Times New Roman"><font size=+1>
will not execute itself recursively.</font></font></li>

<li>
<font face="Times New Roman"><font size=+1>‘</font></font><font face="Courier New"><font size=+0>ld</font></font><font face="Times New Roman"><font size=+1>’
in </font></font><font face="Courier New"><font size=+0>PATH</font></font><font face="Times New Roman"><font size=+1>.</font></font></li>
</ul>
<font face="Times New Roman"><font size=+1>“The compiler’s search directories”
means all the directories where </font></font><font face="Courier New"><font size=+0>gcc</font></font><font face="Times New Roman"><font size=+1>
searches for passes of the compiler. This includes directories that you
specify with ‘</font></font><font face="Courier New"><font size=+0>-B</font></font><font face="Times New Roman"><font size=+1>’.</font></font>
<p><font face="Times New Roman"><font size=+1>Cross-compilers search a
little differently, using the following filenames.</font></font>
<ul TYPE=SQUARE>
<li>
<font face="Times New Roman"><font size=+1>‘</font></font><font face="Courier New"><font size=+0>real-ld</font></font><font face="Times New Roman"><font size=+1>’
in the compiler’s search directories.</font></font></li>

<li>
<font face="Times New Roman"><font size=+1>‘</font></font><font face="Courier New"><font size=+0><i>target</i>-real-ld</font></font><font face="Times New Roman"><font size=+1>’
in </font></font><font face="Courier New"><font size=+0>PATH</font></font><font face="Times New Roman"><font size=+1>.</font></font></li>

<li>
<font face="Times New Roman"><font size=+1>The file specified in the </font></font><font face="Courier New"><font size=+0>REAL_LD_FILE_NAME</font></font><font face="Times New Roman"><font size=+1>
configuration macro, if specified.</font></font></li>

<li>
<font face="Times New Roman"><font size=+1>‘</font></font><font face="Courier New"><font size=+0>ld</font></font><font face="Times New Roman"><font size=+1>’
in the compiler’s search directories.</font></font></li>

<li>
<font face="Times New Roman"><font size=+1>‘</font></font><font face="Courier New"><font size=+0><i>target</i>-ld</font></font><font face="Times New Roman"><font size=+1>’
in </font></font><font face="Courier New"><font size=+0>PATH</font></font><font face="Times New Roman"><font size=+1>.</font></font></li>
</ul>
<font face="Courier New"><font size=+0>collect2</font></font><font face="Times New Roman"><font size=+1>
explicitly avoids running </font></font><font face="Courier New"><font size=+0>ld</font></font><font face="Times New Roman"><font size=+1>
using the filename under which </font></font><font face="Courier New"><font size=+0>collect2</font></font><font face="Times New Roman"><font size=+1>
itself was invoked. In fact, it remembers up a list of such names—in case
one copy of </font></font><font face="Courier New"><font size=+0>collect2</font></font><font face="Times New Roman"><font size=+1>
finds another copy (or version) of </font></font><font face="Courier New"><font size=+0>collect2</font></font><font face="Times New Roman"><font size=+1>
installed as ‘</font></font><font face="Courier New"><font size=+0>ld</font></font><font face="Times New Roman"><font size=+1>’
in a second place in the search path.</font></font>
<p><font face="Courier New"><font size=+0>collect2</font></font><font face="Times New Roman"><font size=+1>
searches for the utilities, </font></font><font face="Courier New"><font size=+0>nm</font></font><font face="Times New Roman"><font size=+1>
and </font></font><font face="Courier New"><font size=+0>strip</font></font><font face="Times New Roman"><font size=+1>,
using the same algorithm as previous installation for ‘</font></font><font face="Courier New"><font size=+0>ld</font></font><font face="Times New Roman"><font size=+1>’.</font></font>
<hr SIZE=3 WIDTH="100%">
<center><a href="#Top">Top</a>|<a href="gcc.html">Contents</a>|<a href="gccindex.html">Index</a>|<a href="gccActually_Building_the_CrossCompi.html">Previous</a>|<a href="gccInstalling_GNU_CC_on_the_Sun.html">Next</a></center>

</body>
</html>
