<HTML>
<HEAD>
   <META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-8859-1">
   <META NAME="GENERATOR" CONTENT="Mozilla/4.04 [en] (Win95; I) [Netscape]">
   <TITLE>Other VMS Issues</TITLE>
</HEAD>
<BODY>
<A NAME="Top"></A><A HREF="gcc.html">Contents</A>|<A HREF="gccindex.html">Index</A>|<A HREF="gccGlobal_Declarations_and_VMS.html">Previous</A>
<BR><A NAME="off_5572052"></A><A NAME="a6fdf9ba"></A><FONT FACE="Futura Md BT"><FONT COLOR="#000000"><B><FONT SIZE=+3>Other
VMS issues&nbsp;</FONT></B>&nbsp;</FONT></FONT>
<HR SIZE=6 WIDTH="100%">
<BR><FONT FACE="Times New Roman"><FONT SIZE=+1>GNU CC automatically arranges
for </FONT></FONT><FONT FACE="Courier New"><FONT SIZE=+0>main</FONT></FONT><FONT FACE="Times New Roman"><FONT SIZE=+1>
to return 1 by default if you fail to specify an explicit return value.
This will be interpreted by VMS as a status code indicating a normal successful
completion. Version 1 of GNU CC did not provide this default. GNU CC on
VMS works only with the GNU assembler, GAS. You need version 1.37 or later
of GAS in order to produce value debugging information for the VMS debugger.
Use the ordinary VMS linker with the object files produced by GAS.</FONT></FONT>

<P><FONT FACE="Times New Roman"><FONT SIZE=+1>Under previous versions of
GNU CC, the generated code would occasionally give strange results when
linked to the sharable ‘</FONT></FONT><FONT FACE="Courier New"><FONT SIZE=+0>VAXCRTL</FONT></FONT><FONT FACE="Times New Roman"><FONT SIZE=+1>’
library. Now this should work.</FONT></FONT>

<P><FONT FACE="Times New Roman"><FONT SIZE=+1>A caveat for use of </FONT></FONT><FONT FACE="Courier New"><FONT SIZE=+0>const</FONT></FONT><FONT FACE="Times New Roman"><FONT SIZE=+1>
global variables: the </FONT></FONT><FONT FACE="Courier New"><FONT SIZE=+0>const</FONT></FONT><FONT FACE="Times New Roman"><FONT SIZE=+1>
modifier must be specified in every external declaration of the variable
in all of the source files that use that variable. Otherwise the linker
will issue warnings about conflicting attributes for the variable. Your
program will still work despite the warnings, but the variable will be
placed in writable storage.</FONT></FONT>

<P><FONT FACE="Times New Roman"><FONT SIZE=+1>Although the VMS linker does
distinguish between upper and lower case letters in global symbols, most
VMS compilers convert all such symbols into upper case and most run-time
library routines also have upper case names. To be able to reliably call
such routines, GNU CC (by means of the assembler GAS) converts global symbols
into upper case like other VMS compilers. However, since the usual practice
in C is to distinguish case, GNU CC (via GAS) tries to preserve usual C
behavior by augmenting each name that is not all lower case. This means
truncating the name to at most 23 characters and then adding more characters
at the end which encode the case pattern of those 23. Names which contain
at least one dollar sign are an exception; they are converted directly
into upper case without augmentation.</FONT></FONT>

<P><FONT FACE="Times New Roman"><FONT SIZE=+1>Name augmentation yields
bad results for programs that use precompiled libraries (such as Xlib)
which were generated by another compiler. You can use the compiler option
‘</FONT></FONT><FONT FACE="Courier New"><FONT SIZE=+0>/NOCASE_HACK</FONT></FONT><FONT FACE="Times New Roman"><FONT SIZE=+1>’
to inhibit augmentation; it makes external C functions and variables case-independent
as is usual on VMS. Alternatively, you could write all references to the
functions and variables in such libraries using lower case; this will work
on VMS, but is not portable to other systems. The compiler option ‘</FONT></FONT><FONT FACE="Courier New"><FONT SIZE=+0>/NAMES</FONT></FONT><FONT FACE="Times New Roman"><FONT SIZE=+1>’
also provides control over global name handling.</FONT></FONT>

<P><FONT FACE="Times New Roman"><FONT SIZE=+1>Function and variable names
are handled somewhat differently with GNU C++. The GNU C++ compiler performs
<I>name mangling</I> on function names, which means that it adds information
to the function name to describe the data types of the arguments that the
function takes. One result of this is that the name of a function can become
very long. Since the VMS linker only recognizes the first 31 characters
in a name, special action is taken to ensure that each function and variable
has a unique name that can be represented in 31 characters.</FONT></FONT>

<P><FONT FACE="Times New Roman"><FONT SIZE=+1>If the name (plus a name
augmentation, if required) is less than 32 characters in length, then no
special action is performed. If the name is longer than 31 characters,
the assembler (GAS) will generate a hash string based upon the function
name, truncate the function name to 23 characters, and append the hash
string to the truncated name. If the ‘</FONT></FONT><FONT FACE="Courier New"><FONT SIZE=+0>/VERBOSE</FONT></FONT><FONT FACE="Times New Roman"><FONT SIZE=+1>’
compiler option is used, the assembler will print both the full and truncated
names of each symbol that is truncated.</FONT></FONT>

<P><FONT FACE="Times New Roman"><FONT SIZE=+1>The ‘</FONT></FONT><FONT FACE="Courier New"><FONT SIZE=+0>/NOCASE_HACK</FONT></FONT><FONT FACE="Times New Roman"><FONT SIZE=+1>’
compiler option should not be used when you are compiling programs that
use libg++. libg++ has several instances of objects (i.e., </FONT></FONT><FONT FACE="Courier New"><FONT SIZE=+0>Filebuf</FONT></FONT><FONT FACE="Times New Roman"><FONT SIZE=+1>
and </FONT></FONT><FONT FACE="Courier New"><FONT SIZE=+0>filebuf</FONT></FONT><FONT FACE="Times New Roman"><FONT SIZE=+1>)
which become indistinguishable in a case-insensitive environment. This
leads to cases where you need to inhibit augmentation selectively (if you
were using libg++ and Xlib in the same program, for example). There is
no special feature for doing this, but you can get the result by defining
a macro for each mixed case symbol for which you wish to inhibit augmentation.
The macro should expand into the lower case equivalent of itself, as in
the following example.</FONT></FONT>
<UL>
<PRE><FONT FACE="Courier New"><FONT SIZE=+1>#define StuDlyCapS studlycaps</FONT></FONT></PRE>
</UL>
<FONT FACE="Times New Roman"><FONT SIZE=+1>These macro definitions can
be placed in a header file to minimize the number of changes to your source
code.</FONT></FONT>&nbsp;
<HR SIZE=3 WIDTH="100%">
<CENTER><A HREF="#Top">Top</A>|<A HREF="gcc.html">Contents</A>|<A HREF="gccindex.html">Index</A>|<A HREF="gccGlobal_Declarations_and_VMS.html">Previous</A></CENTER>

<CENTER>&nbsp;</CENTER>

</BODY>
</HTML>
