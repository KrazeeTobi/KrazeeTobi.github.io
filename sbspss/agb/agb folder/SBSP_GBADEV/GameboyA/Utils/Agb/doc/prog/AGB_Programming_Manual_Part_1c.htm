<html>

	<head>
		<link rel="stylesheet" type="text/css" href="style.css">
		<!--
Editors' comments:
07/07/00  Created by Pam Curtis using w2w 2.0
07/14/00 Edited by PC -->
		<title>AGB Memory</title>
	</head>

	<body bgcolor="white">
		<a name="topofpage"></a>
		<h1><a name="T1"></a>3 AGB Memory</h1>
		<h2><a name="T2"></a>3.1 Overall Memory Map</h2>
		<p>The following is the overall memory map of the AGB system.</p>
		<p><img src="Image95.gif" width="570" height="701"></p>
		<h2><a name="T3"></a>3.2 Memory Configuration</h2>
		<p>In broad terms, the area 00000000h-07FFFFFFh is allocated as AGB internal memory, and 08000000-0EFFFFFFh is allocated as Game Pak memory.</p>
		<h3><a name="T4"></a>3.2.1 AGB Internal Memory</h3>
		<ol>
			<li><b>System ROM</b><br>
			The 16 KBytes from 000000000h is the system ROM. Various types of System Calls can be used.
			<li><b>CPU External Working RAM</b><br>
			The 256 Kbytes from 02000000h is CPU External Working RAM. Its specifications are 2 Wait 16 bit Bus.
			<li><b>CPU Internal Working RAM</b><br>
			The 32 Kbytes from 03000000h is CPU Internal Working RAM. It is used to store programs and data.
			<li><b>I/O and Registers</b><br>
			This area is used for various registers.
			<li><b>Palette RAM</b><br>
			The 1 Kbyte from 05000000h is palette RAM. It is used to assign palette colors.
			<li><b>VRAM</b><br>
			The 96 Kbytes from 06000000h is the VRAM area. This area is for BG and OBJ data.
			<li><b>OAM</b><br>
			The 1 Kbyte from 07000000h is Object Attribute Memory (OAM). It holds the objects to be displayed and their attributes.
		</ol>
		<h3><a name="T11"></a>3.2.2 Game Pak Memory</h3>
		<ol>
			<li><b>Game Pak ROM</b>
			<p>Three 32 MB Game Pak ROM spaces are allocated to the area beginning from 08000000h.</p>
			<p>The access speed of each of these spaces can be set individually. Thus, they are named Wait State 0, Wait State 1, and Wait State 2.</p>
			<p>This specification enables memory of varying access speeds in Game Pak ROM to be accessed optimally.</p>
			<p>The base addresses of the 3 spaces are 08000000h for Wait State 0, 0A000000h for Wait State 1, and 0C000000h for Wait State 2.</p>
			<p>In addition, the upper 1 Mbit of each space is allocated as flash memory. This area is used primarily for saving data.</p>
			<li><b>Game Pak RAM</b>
			<p>The area beginning from 0E000000h is the Game Pak RAM area. Up to 512 Kbits of SRAM or Flash Memory can be stored here. However, it is an 8 bit data bus.</p>
		</ol>
		<h2><a name="T14"></a>3.3 Game Pak Memory Wait Control</h2>
		<p>Although the 32 MB Game Pak memory space is mapped to the area from 08000000h onward, the 32 MB spaces beginning from 0A000000h and 0C000000h are images of the 32 MB space that starts at 08000000h.</p>
		<p>These images enable memory to be used according to the access speed of the Game Pak memory (1-4 wait cycles).</p>
		<p><img src="Image96.gif" width="575" height="389"></p>
		<p>WSCNT [d15] Game Pak Type Flag</p>
		<blockquote>
			The System ROM uses this.</blockquote>
		<p>WSCNT [d14] Prefetch Buffer Flag</p>
		<blockquote>
			When the Prefetch Buffer Flag is enabled and there is some free space, the Prefetch Buffer takes control of the Game Pak Bus during the time when the CPU is not using it, and reads Game Pak ROM data repeatedly. When the CPU tries to read instructions from the Game Pak and if it hits the Prefetch Buffer, the fetch is completed with no wait in respect to the CPU. If there is no hit, the fetch is done from the Game Pak ROM and there is a wait based on the set wait state.
			<p>If the Prefetch Buffer Flag is disabled, the fetch is done from the Game Pak ROM. There is a wait based on the wait state associated with the fetch instruction to the Game Pak ROM in respect to the CPU. In the portion where the Prefetch Circuit does not operate, the consumed current is kept to a minimum.</p>
		</blockquote>
		<p>WSCNT [d12-11] PHI Terminal Output Control</p>
		<blockquote>
			Controls the output from the PHI terminal. This should always be set to 00 (No Output).</blockquote>
		<p>WSCNT [d10-08],[d07-05],[d04-02] Wait State Wait Control</p>
		<blockquote>
			Individual wait cycles for each of the three areas (Wait States 0-2) that occur in Game Pak ROM can be set. The relation between the wait control settings and wait cycles is as follows. Use the appropriate settings for the device you are using.</blockquote>
		<center>
			<p>
			<table width="500" border="1" cellspacing="0" cellpadding="3">
				<tr>
					<td align="center" width="31%" rowspan="3" bgcolor="#cccccc">Wait Control Value</td>
					<td align="center" colspan="7" bgcolor="#cccccc">Wait Cycles</td>
				</tr>
				<tr>
					<td align="center" width="29%" rowspan="2" bgcolor="#cccccc">1<sup>st</sup> Access</td>
					<td align="center" colspan="6" bgcolor="#cccccc">2<sup>nd</sup> Access</td>
				</tr>
				<tr>
					<td align="center" colspan="2" bgcolor="#cccccc">Wait State<br>
						0</td>
					<td align="center" colspan="2" bgcolor="#cccccc">Wait State<br>
						1</td>
					<td align="center" colspan="2" bgcolor="#cccccc">Wait State<br>
						2</td>
				</tr>
				<tr>
					<td width="31%" align="center">000</td>
					<td width="29%" align="center">4</td>
					<td colspan="2" align="center">2</td>
					<td colspan="2" align="center">4</td>
					<td colspan="2" align="center">8</td>
				</tr>
				<tr>
					<td width="31%" align="center">001</td>
					<td width="29%" align="center">3</td>
					<td colspan="2" align="center">2</td>
					<td colspan="2" align="center">4</td>
					<td colspan="2" align="center">8</td>
				</tr>
				<tr>
					<td width="31%" align="center">010</td>
					<td width="29%" align="center">2</td>
					<td colspan="2" align="center">2</td>
					<td colspan="2">
						<center>
							4</center>
					</td>
					<td colspan="2">
						<center>
							8</center>
					</td>
				</tr>
				<tr>
					<td width="31%" align="center">011</td>
					<td width="29%" align="center">8</td>
					<td colspan="2" align="center">2</td>
					<td colspan="2" align="center">4</td>
					<td colspan="2" align="center">8</td>
				</tr>
				<tr>
					<td width="31%" align="center">100</td>
					<td width="29%" align="center">4</td>
					<td colspan="2" align="center">1</td>
					<td colspan="2" align="center">1</td>
					<td colspan="2" align="center">1</td>
				</tr>
				<tr>
					<td width="31%" bgcolor="#cccccc" align="center">101</td>
					<td width="29%" bgcolor="#cccccc" align="center">3</td>
					<td colspan="2" bgcolor="#cccccc" align="center">1</td>
					<td colspan="2" bgcolor="#cccccc" align="center">1</td>
					<td colspan="2" bgcolor="#cccccc" align="center">1</td>
				</tr>
				<tr>
					<td width="31%" align="center">110</td>
					<td width="29%" align="center">2</td>
					<td colspan="2" align="center">1</td>
					<td colspan="2" align="center">1</td>
					<td colspan="2" align="center">1</td>
				</tr>
				<tr>
					<td width="31%" align="center">111</td>
					<td width="29%" align="center">8</td>
					<td colspan="2" align="center">1</td>
					<td colspan="2" align="center">1</td>
					<td colspan="2" align="center">1</td>
				</tr>
			</table>
			</p>
			<p>
			<table width="500" border="0" cellspacing="0" cellpadding="3">
				<tr>
					<td valign="top" bgcolor="#cccccc">After executing the System ROM (when the User Program is started) the Wait Control Value is 000. In the Game Pak Mask ROM used with the actual manufactured product the specifications are 1<sup>st</sup> Access/3 Wait, 2<sup>nd</sup> Access/1 Wait (this needs to be confirmed). In this case, set the Wait Control Value to 101.</td>
				</tr>
			</table>
			</p>
		</center>
		<p>WSCNT [d01-00] Game Pak RAM Wait Control</p>
		<blockquote>
			Wait cycles for the Game Pak RAM can be set. The relation between the wait control settings and wait cycles is as follows. Use the appropriate settings for the device you are using.</blockquote>
		<center>
			<p>
			<table width="327" border="1" cellspacing="0" cellpadding="3">
				<tr>
					<td width="48%" bgcolor="#cccccc" align="center">Wait Control Value</td>
					<td width="52%" bgcolor="#cccccc" align="center">Wait Cycles</td>
				</tr>
				<tr>
					<td width="48%" align="center">00</td>
					<td width="52%" align="center">4</td>
				</tr>
				<tr>
					<td width="48%" align="center">01</td>
					<td width="52%" align="center">3</td>
				</tr>
				<tr>
					<td width="48%" align="center">10</td>
					<td width="52%" align="center">2</td>
				</tr>
				<tr>
					<td width="48%" align="center">11</td>
					<td width="52%" align="center">8</td>
				</tr>
			</table>
			</p>
		</center>
		<h3><a name="T15"></a>3.3.1 Access Timing</h3>
		<p>The following timing charts illustrate Game Pak ROM access with 3 wait cycles on the first access and 1 wait cycle on the second.</p>
		<ol>
			<li><b>Sequential Access</b>
			<p><img src="Image97.gif" width="570" height="207"></p>
			<li><b>Random Access</b>
			<p><img src="Image98.gif" width="571" height="216"></p>
		</ol>
		<h3><a name="T18"></a>3.3.2 Game Pak Bus</h3>
		<p>The Game Pak bus has a total of 32 terminals, which are described in the following table.</p>
		<center>
			<p>
			<table width="536" border="1" cellspacing="0" cellpadding="3">
				<tr>
					<td width="8%" align="center" rowspan="2" bgcolor="white">No.</td>
					<td align="center" colspan="2" bgcolor="white">Game Pak ROM Access</td>
					<td align="center" colspan="2" bgcolor="white">Game Pak RAM Access</td>
				</tr>
				<tr>
					<td width="18%" align="center" bgcolor="white">Terminal</td>
					<td width="27%" align="center" bgcolor="white">Use</td>
					<td width="18%" align="center" bgcolor="white">Terminal</td>
					<td width="29%" align="center" bgcolor="white">Use</td>
				</tr>
				<tr>
					<td width="8%" align="center">1</td>
					<td width="18%" align="center">VDD (3.3V)</td>
					<td width="27%" align="center">&nbsp;</td>
					<td width="18%" align="center">VDD (3.3V)</td>
					<td width="29%" align="center">&nbsp;</td>
				</tr>
				<tr>
					<td width="8%" align="center">2</td>
					<td width="18%" align="center">PHI</td>
					<td width="27%" align="center">&nbsp;</td>
					<td width="18%" align="center">PHI</td>
					<td width="29%" align="center">&nbsp;</td>
				</tr>
				<tr>
					<td width="8%" align="center">3</td>
					<td width="18%" align="center">/WR</td>
					<td width="27%" align="center">Write Flag</td>
					<td width="18%" align="center">/WR</td>
					<td width="29%" align="center">Write Flag</td>
				</tr>
				<tr>
					<td width="8%" align="center">4</td>
					<td width="18%" align="center">/RD</td>
					<td width="27%" align="center">Read Flag</td>
					<td width="18%" align="center">/RD</td>
					<td width="29%" align="center">Read Flag</td>
				</tr>
				<tr>
					<td width="8%" align="center">5</td>
					<td width="18%" align="center">/CS</td>
					<td width="27%" align="center">ROM Chip Selection</td>
					<td width="18%" align="center">/CS</td>
					<td width="29%" align="center">&nbsp;</td>
				</tr>
				<tr>
					<td width="8%" align="center">6</td>
					<td width="18%" align="center">AD0</td>
					<td width="27%" align="center" rowspan="16">Terminals used for both address(lower) and data</td>
					<td width="18%" align="center">A0</td>
					<td width="29%" align="center" rowspan="16">Address</td>
				</tr>
				<tr>
					<td width="8%" align="center">7</td>
					<td width="18%" align="center">AD1</td>
					<td width="18%" align="center">A1</td>
				</tr>
				<tr>
					<td width="8%" align="center">8</td>
					<td width="18%" align="center">AD2</td>
					<td width="18%" align="center">A2</td>
				</tr>
				<tr>
					<td width="8%" align="center">9</td>
					<td width="18%" align="center">AD3</td>
					<td width="18%" align="center">A3</td>
				</tr>
				<tr>
					<td width="8%" align="center">10</td>
					<td width="18%" align="center">AD4</td>
					<td width="18%" align="center">A4</td>
				</tr>
				<tr>
					<td width="8%" align="center">11</td>
					<td width="18%" align="center">AD5</td>
					<td width="18%" align="center">A5</td>
				</tr>
				<tr>
					<td width="8%" align="center">12</td>
					<td width="18%" align="center">AD6</td>
					<td width="18%" align="center">A6</td>
				</tr>
				<tr>
					<td width="8%" align="center">13</td>
					<td width="18%" align="center">AD7</td>
					<td width="18%" align="center">A7</td>
				</tr>
				<tr>
					<td width="8%" align="center">14</td>
					<td width="18%" align="center">AD8</td>
					<td width="18%" align="center">A8</td>
				</tr>
				<tr>
					<td width="8%" align="center">15</td>
					<td width="18%" align="center">AD9</td>
					<td width="18%" align="center">A9</td>
				</tr>
				<tr>
					<td width="8%" align="center">16</td>
					<td width="18%" align="center">AD10</td>
					<td width="18%" align="center">A10</td>
				</tr>
				<tr>
					<td width="8%" align="center">17</td>
					<td width="18%" align="center">AD11</td>
					<td width="18%" align="center">A11</td>
				</tr>
				<tr>
					<td width="8%" align="center">18</td>
					<td width="18%" align="center">AD12</td>
					<td width="18%" align="center">A12</td>
				</tr>
				<tr>
					<td width="8%" align="center">19</td>
					<td width="18%" align="center">AD13</td>
					<td width="18%" align="center">A13</td>
				</tr>
				<tr>
					<td width="8%" align="center">20</td>
					<td width="18%" align="center">AD14</td>
					<td width="18%" align="center">A14</td>
				</tr>
				<tr>
					<td width="8%" align="center">21</td>
					<td width="18%" align="center">AD15</td>
					<td width="18%" align="center">A15</td>
				</tr>
				<tr>
					<td width="8%" align="center">22</td>
					<td width="18%" align="center">A16</td>
					<td width="27%" align="center" rowspan="8">Address (upper)</td>
					<td width="18%" align="center">D0</td>
					<td width="29%" align="center" rowspan="8">Data</td>
				</tr>
				<tr>
					<td width="8%" align="center">23</td>
					<td width="18%" align="center">A17</td>
					<td width="18%" align="center">D1</td>
				</tr>
				<tr>
					<td width="8%" align="center">24</td>
					<td width="18%" align="center">A18</td>
					<td width="18%" align="center">D2</td>
				</tr>
				<tr>
					<td width="8%" align="center">25</td>
					<td width="18%" align="center">A19</td>
					<td width="18%" align="center">D3</td>
				</tr>
				<tr>
					<td width="8%" align="center">26</td>
					<td width="18%" align="center">A20</td>
					<td width="18%" align="center">D4</td>
				</tr>
				<tr>
					<td width="8%" align="center">27</td>
					<td width="18%" align="center">A21</td>
					<td width="18%" align="center">D5</td>
				</tr>
				<tr>
					<td width="8%" align="center">28</td>
					<td width="18%" align="center">A22</td>
					<td width="18%" align="center">D6</td>
				</tr>
				<tr>
					<td width="8%" align="center">29</td>
					<td width="18%" align="center">A23</td>
					<td width="18%" align="center">D7</td>
				</tr>
				<tr>
					<td width="8%" align="center">30</td>
					<td width="18%" align="center">/CS2</td>
					<td width="27%" align="center">&nbsp;</td>
					<td width="18%" align="center">/CS2</td>
					<td width="29%" align="center">RAM Chip Selection</td>
				</tr>
				<tr>
					<td width="8%" align="center">31</td>
					<td width="18%" align="center">/IREQ<br>/DREQ</td>
					<td width="27%" align="center">Terminals used for both IREQ and DREQ</td>
					<td width="18%" align="center">/IREQ<br>/DREQ</td>
					<td width="29%" align="center">Terminals used for both IREQ and DREQ</td>
				</tr>
				<tr>
					<td width="8%" align="center">32</td>
					<td width="18%" align="center">GND</td>
					<td width="27%" align="center">&nbsp;</td>
					<td width="18%" align="center">GND</td>
					<td width="29%" align="center">&nbsp;</td>
				</tr>
			</table>
		</center>
	</body>

</html>
