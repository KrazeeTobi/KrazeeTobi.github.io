<!doctype html public "-//w3c//dtd html 4.0 transitional//en">
<html>
<head>
   <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
   <meta name="GENERATOR" content="Mozilla/4.51 [en] (Win95; I) [Netscape]">
   <title>Installing GNU CC on VMS</title>
</head>
<body>
<a NAME="Top"></a><a href="gcc.html">Contents</a>|<a href="gccindex.html">Index</a>|<a href="gccInstalling_GNU_CC_on_the_Sun.html">Previous</a>|<a href="gccUsing_GNU_CC_on_VMS.html">Next</a>
<br><a NAME="off_3049441"></a><a NAME="2431fed0"></a><font face="Futura Md BT"><font color="#000000"><b><font size=+3>Installing
GNU CC on VMS&nbsp;</font></b>&nbsp;</font></font>
<hr SIZE=6 WIDTH="100%">
<br><font face="Times New Roman"><font size=+1>The VMS version of GNU CC
is distributed in a backup “saveset” containing both source code and precompiled
binaries.</font></font>
<p><font face="Times New Roman"><font size=+1>To install the </font></font><font face="Courier New"><font size=+0>gcc</font></font><font face="Times New Roman"><font size=+1>
command so you can use the compiler easily, in the same manner as you use
the VMS C compiler, you must install the VMS CLD file for GNU CC as follows.</font></font>
<p><font face="Arial"><font size=+1>1.</font></font>
<br><font face="Times New Roman"><font size=+1>Define the VMS logical names
</font></font><font face="Courier New"><font size=+0>GNU_CC</font></font><font face="Times New Roman"><font size=+1>
and </font></font><font face="Courier New"><font size=+0>GNU_CC_INCLUDE</font></font><font face="Times New Roman"><font size=+1>
to point to the directories where the GNU CC executables (‘</font></font><font face="Courier New"><font size=+0>gcc-cpp.exe</font></font><font face="Times New Roman"><font size=+1>’,‘</font></font><font face="Courier New"><font size=+0>gcc-cc1.exe</font></font><font face="Times New Roman"><font size=+1>’,
etc.) and the C include files are kept respectively. This should be done
with the following commands.</font></font>
<ul>
<pre><font face="Courier New"><font size=+1>assign /system /translation=concealed -disk:[gcc.] gnu_cc&nbsp;
assign /system /translation=concealed -disk:[gcc.include.]&nbsp;
&nbsp;&nbsp; gnu_cc_include</font></font></pre>
</ul>
<font face="Times New Roman"><font size=+1>Include the appropriate disk
and directory names. These commands can be placed in your system startup
file so they will be executed whenever the machine is rebooted. You may,
if you choose, do this via the </font></font><font face="Courier New"><font size=+0>GCC_INSTALL.COM</font></font><font face="Times New Roman"><font size=+1>
script in the </font></font><font face="Courier New"><font size=+0>[GCC]</font></font><font face="Times New Roman"><font size=+1>
directory.</font></font>
<p><font face="Arial"><font size=+1>2.</font></font>
<br><font face="Times New Roman"><font size=+1>Install the </font></font><font face="Courier New"><font size=+0>GCC</font></font><font face="Times New Roman"><font size=+1>
command with the following command line input.</font></font>
<ul>
<pre><font face="Courier New"><font size=+1>set command /table=sys$common:[syslib]dcltables \&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -/ output=sys$common:[syslib]dcltables \&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; gnu_cc:[000000]gcc&nbsp;
install replace sys$common:[syslib]dcltables</font></font></pre>
</ul>
<font face="Arial"><font size=+1>3.</font></font>
<br><font face="Times New Roman"><font size=+1>To install the help file,
use the following input.</font></font>
<ul>
<pre><font face="Courier New"><font size=+1>library/help sys$library:helplib.hlb gcc.hlp</font></font></pre>
</ul>
<font face="Times New Roman"><font size=+1>Now, invoke the compiler with
a command like ‘</font></font><font face="Courier New"><font size=+0>gcc
/verbose file.c</font></font><font face="Times New Roman"><font size=+1>’,
which is equivalent to the command ‘</font></font><font face="Courier New"><font size=+0>gcc
-v -c file.c</font></font><font face="Times New Roman"><font size=+1>’
in Unix.</font></font>
<p><font face="Times New Roman"><font size=+1>If you wish to use GNU C++
you must first install GNU CC, and then perform the following steps.</font></font>
<p><font face="Arial"><font size=+1>1.</font></font>
<br><font face="Times New Roman"><font size=+1>Define the VMS logical name
</font></font><font face="Courier New"><font size=+0>GNU_GXX_INCLUDE</font></font><font face="Times New Roman"><font size=+1>
to point to the directory where the preprocessor will search for the C++
header files. This can be done with the following command.</font></font>
<ul>
<pre><font face="Courier New"><font size=+1>assign /system /translation=concealed - \&nbsp;
&nbsp; disk:[ gcc.gxx_include.] gnu_gxx_include</font></font></pre>
</ul>
<font face="Times New Roman"><font size=+1>Include the appropriate disk
and directory name. If you are going to be using libg++, this is where
the libg++ install procedure will install the libg++ header files.</font></font>
<p><font face="Arial"><font size=+1>2.</font></font>
<br><font face="Times New Roman"><font size=+1>Obtain the file ‘</font></font><font face="Courier New"><font size=+0>gcc-cc1plus.exe</font></font><font face="Times New Roman"><font size=+1>’,
and place this in the same directory that ‘</font></font><font face="Courier New"><font size=+0>gcc-cc1.exe</font></font><font face="Times New Roman"><font size=+1>’
is kept. The GNU C++ compiler can be invoked with a command like ‘</font></font><font face="Courier New"><font size=+0>gcc
/plus /verbose file.cc</font></font><font face="Times New Roman"><font size=+1>’,
which is equivalent to the command ‘</font></font><font face="Courier New"><font size=+0>g++
-v -c file.cc</font></font><font face="Times New Roman"><font size=+1>’
in Unix.</font></font>
<p><font face="Times New Roman"><font size=+1>We try to put corresponding
binaries and sources on the VMS distribution tape. But sometimes the binaries
will be from an older version than the sources, because we don’t always
have time to update them. (Use the ‘</font></font><font face="Courier New"><font size=+0>/version</font></font><font face="Times New Roman"><font size=+1>’
option to determine the version number of the binaries and compare it with
the source file ‘</font></font><font face="Courier New"><font size=+0>version.c</font></font><font face="Times New Roman"><font size=+1>’
to tell whether this is so.) In this case, you should use the binaries
you get to recompile the sources.</font></font>
<p><font face="Times New Roman"><font size=+1>If you must recompile, use
the following steps.</font></font>
<p><font face="Arial"><font size=+1>1.</font></font>
<br><font face="Times New Roman"><font size=+1>Execute the command procedure,
‘</font></font><font face="Courier New"><font size=+0>vmsconfig.com</font></font><font face="Times New Roman"><font size=+1>’to
set up the files, ‘</font></font><font face="Courier New"><font size=+0>tm.h</font></font><font face="Times New Roman"><font size=+1>’,
‘</font></font><font face="Courier New"><font size=+0>config.h</font></font><font face="Times New Roman"><font size=+1>’,
‘</font></font><font face="Courier New"><font size=+0>aux-output.c</font></font><font face="Times New Roman"><font size=+1>’,
and ‘</font></font><font face="Courier New"><font size=+0>md</font></font><font face="Times New Roman"><font size=+1>.‘,
and to create files, ‘</font></font><font face="Courier New"><font size=+0>tconfig</font></font><font face="Times New Roman"><font size=+1>.</font></font><font face="Courier New"><font size=+0>h</font></font><font face="Times New Roman"><font size=+1>’
and ‘</font></font><font face="Courier New"><font size=+0>hconfig</font></font><font face="Times New Roman"><font size=+1>.</font></font><font face="Courier New"><font size=+0>h</font></font><font face="Times New Roman"><font size=+1>’.
This procedure also creates several linker option files used by ‘</font></font><font face="Courier New"><font size=+0>make-cc1.com</font></font><font face="Times New Roman"><font size=+1>’
and a data file used by</font></font> <font face="Times New Roman"><font size=+1>‘</font></font><font face="Courier New"><font size=+0>make-l2.com</font></font><font face="Times New Roman"><font size=+1>’.</font></font>
<ul>
<pre><font face="Courier New"><font size=+1>@vmsconfig.com</font></font></pre>
</ul>
<font face="Arial"><font size=+1>2.</font></font>
<br><font face="Times New Roman"><font size=+1>Setup the logical names
and command tables as defined in Step 1. In addition, define the VMS logical
name </font></font><font face="Courier New"><font size=+0>GNU_BISON</font></font><font face="Times New Roman"><font size=+1>
to point to the directories where the </font></font><font face="Courier New"><font size=+0>Bison</font></font><font face="Times New Roman"><font size=+1>
executable is kept. This should be done with the following command.</font></font>
<ul>
<pre><font face="Courier New"><font size=+1>assign /system /translation=concealed - \&nbsp;
&nbsp; disk:[ bison.] gnu_bison</font></font></pre>
</ul>
<font face="Times New Roman"><font size=+1>You may, if you choose, use
the </font></font><font face="Courier New"><font size=+0>INSTALL_BISON.COM</font></font><font face="Times New Roman"><font size=+1>
script in the </font></font><font face="Courier New"><font size=+0>[BISON]</font></font><font face="Times New Roman"><font size=+1>
directory.</font></font>
<p><font face="Arial"><font size=+1>3.</font></font>
<br><font face="Times New Roman"><font size=+1>Install the </font></font><font face="Courier New"><font size=+0>BISON</font></font><font face="Times New Roman"><font size=+1>
command with the following command.</font></font>
<ul>
<pre><font face="Courier New"><font size=+1>set command /table=sys$common:[syslib]dcltables - \&nbsp;
&nbsp; /output=sys$common:[syslib]dcltables - \&nbsp;
&nbsp; gnu_ bison:[000000]bison&nbsp;
install replace sys$common:[syslib]dcltables</font></font></pre>
</ul>
<font face="Arial"><font size=+1>4.</font></font>
<br><font face="Times New Roman"><font size=+1>Type ‘</font></font><font face="Courier New"><font size=+0>@make-gcc</font></font><font face="Times New Roman"><font size=+1>’
to recompile everything (alternatively, submit the file ‘</font></font><font face="Courier New"><font size=+0>make-gcc.com</font></font><font face="Times New Roman"><font size=+1>’
to a batch queue).</font></font>
<p><font face="Times New Roman"><font size=+1>If you wish to build the
GNU C++ compiler as well as the GNU CC compiler, you must first edit </font></font><font face="Courier New"><font size=+0>make-gcc.com</font></font><font face="Times New Roman"><font size=+1>
and follow the instructions that appear in the comments.</font></font>
<p><font face="Arial"><font size=+1>5.</font></font>
<br><font face="Times New Roman"><font size=+1>In order to use GCC, you
need a library of functions which GCC compiled code will call to perform
certain tasks, and these functions are defined in the file ‘</font></font><font face="Courier New"><font size=+0>libgcc2.c</font></font><font face="Times New Roman"><font size=+1>’.</font></font>
<p><font face="Times New Roman"><font size=+1>To compile this you should
use the command procedure, ‘</font></font><font face="Courier New"><font size=+0>make-l2.com</font></font><font face="Times New Roman"><font size=+1>’,
which will generate the library ‘</font></font><font face="Courier New"><font size=+0>libgcc2.olb</font></font><font face="Times New Roman"><font size=+1>’.</font></font>
<p><font face="Times New Roman"><font size=+1>Build ‘</font></font><font face="Courier New"><font size=+0>libgcc2.olb</font></font><font face="Times New Roman"><font size=+1>’
using the compiler built from the same distribution that ‘</font></font><font face="Courier New"><font size=+0>libgcc2.c</font></font><font face="Times New Roman"><font size=+1>’
came from, and </font></font><font face="Courier New"><font size=+0>make-gcc.com</font></font><font face="Times New Roman"><font size=+1>
will automatically do all of this for you.</font></font>
<p><font face="Times New Roman"><font size=+1>To install the library, use
the following commands.</font></font>
<ul>
<pre><font face="Courier New"><font size=+1>library gnu_cc:[000000]gcclib/delete=(new,eprintf)&nbsp;
library gnu_cc:[000000]gcclib/delete=L_*&nbsp;
library libgcc2/extract=*/output=libgcc2.obj&nbsp;
library gnu_cc:[000000]gcclib libgcc2.obj</font></font></pre>
</ul>
<font face="Times New Roman"><font size=+1>The first command simply removes
old modules that will be replaced with modules from ‘</font></font><font face="Courier New"><font size=+0>libgcc2</font></font><font face="Times New Roman"><font size=+1>’
under different module names. The modules </font></font><font face="Courier New"><font size=+0>new</font></font><font face="Times New Roman"><font size=+1>
and </font></font><font face="Courier New"><font size=+0>eprintf</font></font><font face="Times New Roman"><font size=+1>
may not actually be present in your </font></font><font face="Courier New"><font size=+0>gcclib.olb</font></font><font face="Times New Roman"><font size=+1>—if
the VMS librarian complains about those modules not being present, simply
ignore the message and continue on with the next command. The second command
removes the modules that came from the previous version of the library
‘</font></font><font face="Courier New"><font size=+0>libgcc2.c</font></font><font face="Times New Roman"><font size=+1>’.</font></font>
<p><font face="Times New Roman"><font size=+1>Whenever you update the compiler
on your system, you should also update the library with the previous procedure.</font></font>
<p><font face="Arial"><font size=+1>6.</font></font>
<br><font face="Times New Roman"><font size=+1>You may wish to build GCC
in such a way that no files are written to the directory where the source
files reside. An example would be the when the source files are on a read-only
disk. In these cases, execute the following DCL commands (substituting
your actual path names) where the directory ‘</font></font><font face="Courier New"><font size=+0>dua1:[gcc.source_dir]</font></font><font face="Times New Roman"><font size=+1>’
contains the source code, and the directory ‘</font></font><font face="Courier New"><font size=+0>dua0:[gcc.build_dir]</font></font><font face="Times New Roman"><font size=+1>’
is meant to contain all of the generated object files and executables.</font></font>
<ul>
<pre><font face="Courier New"><font size=+1>assign dua0:[gcc.build_dir.]/translation=concealed, - \&nbsp;
<b>&nbsp;&nbsp;&nbsp;</b>&nbsp;&nbsp;&nbsp; dua1:[ gcc.source_dir.]/translation=concealed&nbsp; \&nbsp;
<b>&nbsp;&nbsp;&nbsp;</b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; gcc_build&nbsp;
set default gcc_build:[000000]</font></font></pre>
</ul>
<font face="Times New Roman"><font size=+1>Once you have done this, you
can proceed building GCC as previously described. (Keep in mind that ‘</font></font><font face="Courier New"><font size=+0>gcc_build</font></font><font face="Times New Roman"><font size=+1>’
is a rooted logical name, and thus the device names in each element of
the search list must be an actual physical device name rather than another
rooted logical name).</font></font>
<p><font face="Arial"><font size=+1>7.</font></font>
<br><font face="Times New Roman"><font size=+1><i>If you are building GNU
CC with a previous version of GNU CC, you also should check to see that
you have the newest version of the assembler</i>. In particular, GNU CC
version 2 treats global constant variables slightly differently from GNU
CC version 1, and GAS version 1.38.1 does not have the patches required
to work with GCC version 2. If you use GAS 1.38.1, then extern const variables
will not have the read-only bit set, and the linker will generate warning
messages about mismatched psect attributes for these variables. These warning
messages are merely a nuisance, and can safely be ignored.</font></font>
<p><font face="Times New Roman"><font size=+1>If you are compiling with
a version of GNU CC older than 1.33, specify ‘</font></font><font size=+0><font face="Courier New">/DEFINE=(</font><font face="Times New Roman">“</font><font face="Courier New">inline=</font><font face="Times New Roman">”</font><font face="Courier New">)</font></font><font face="Times New Roman"><font size=+1>’
as an option in all the compilations. This requires editing all the </font></font><font face="Courier New"><font size=+0>gcc</font></font><font face="Times New Roman"><font size=+1>
commands in ‘</font></font><font face="Courier New"><font size=+0>make-cc1.com</font></font><font face="Times New Roman"><font size=+1>’.
(The older versions had problems supporting </font></font><font face="Courier New"><font size=+0>inline</font></font><font face="Times New Roman"><font size=+1>.)
Once you have a working 1.33 or newer GNU CC, you can change this file
back.</font></font>
<p><font face="Arial"><font size=+1>8.</font></font>
<br><font face="Times New Roman"><font size=+1>If you want to build GNU
CC with the VAX C compiler, you will need to make minor changes in ‘</font></font><font face="Courier New"><font size=+0>make-cccp.com</font></font><font face="Times New Roman"><font size=+1>’
and ‘</font></font><font face="Courier New"><font size=+0>make-cc1.com</font></font><font face="Times New Roman"><font size=+1>’
to choose alternate definitions of </font></font><font face="Courier New"><font size=+0>CC</font></font><font face="Times New Roman"><font size=+1>,
</font></font><font face="Courier New"><font size=+0>CFLAGS</font></font><font face="Times New Roman"><font size=+1>,
and </font></font><font face="Courier New"><font size=+0>LIBS</font></font><font face="Times New Roman"><font size=+1>.
See comments in those files. However, you must also have a working version
of the GNU assembler (GNU </font></font><font face="Courier New"><font size=+0>as</font></font><font face="Times New Roman"><font size=+1>,
also known as GAS) as it is used as the back-end for GNU CC to produce
binary object modules and is not included in the GNU CC sources. GAS is
also needed to compile ‘</font></font><font face="Courier New"><font size=+0>libgcc2</font></font><font face="Times New Roman"><font size=+1>’
in order to build ‘</font></font><font face="Courier New"><font size=+0>gcclib</font></font><font face="Times New Roman"><font size=+1>’
(see Step 5); ‘</font></font><font face="Courier New"><font size=+0>make-l2.com</font></font><font face="Times New Roman"><font size=+1>’
expects to be able to find it operational in ‘</font></font><font face="Courier New"><font size=+0>gnu_cc:[000000]gnu-as.exe</font></font><font face="Times New Roman"><font size=+1>’.</font></font>
<p><font face="Times New Roman"><font size=+1>To use GNU CC on VMS, you
need the VMS driver programs ‘</font></font><font face="Courier New"><font size=+0>gcc.exe</font></font><font face="Times New Roman"><font size=+1>’,
‘</font></font><font face="Courier New"><font size=+0>gcc.com</font></font><font face="Times New Roman"><font size=+1>’,
and ‘</font></font><font face="Courier New"><font size=+0>gcc.cld</font></font><font face="Times New Roman"><font size=+1>’.
They are distributed with the VMS binaries (‘</font></font><font face="Courier New"><font size=+0>gcc-vms</font></font><font face="Times New Roman"><font size=+1>’)
rather than the GNU CC sources. GAS is also included in ‘</font></font><font face="Courier New"><font size=+0>gcc-vms</font></font><font face="Times New Roman"><font size=+1>’,
as is </font></font><font face="Courier New"><font size=+0>Bison</font></font><font face="Times New Roman"><font size=+1>.</font></font>
<p><font face="Times New Roman"><font size=+1>Once you have successfully
built GNU CC with VAX C, you should use the resulting compiler to rebuild
itself.</font></font>
<p><font face="Times New Roman"><font size=+1>Before doing this, be sure
to restore the </font></font><font face="Courier New"><font size=+0>CC</font></font><font face="Times New Roman"><font size=+1>,
</font></font><font face="Courier New"><font size=+0>CFLAGS</font></font><font face="Times New Roman"><font size=+1>,
and </font></font><font face="Courier New"><font size=+0>LIBS</font></font><font face="Times New Roman"><font size=+1>
definitions in ‘</font></font><font face="Courier New"><font size=+0>make-cccp.com</font></font><font face="Times New Roman"><font size=+1>’
and ‘</font></font><font face="Courier New"><font size=+0>make-cc1.com</font></font><font face="Times New Roman"><font size=+1>’.
The second generation compiler will be able to take advantage of many optimizations
that must be suppressed when building with other compilers.</font></font>
<p><font face="Times New Roman"><font size=+1>Under previous versions of
GNU CC, the generated code would occasionally give strange results when
linked with the sharable ‘</font></font><font face="Courier New"><font size=+0>VAXCRTL</font></font><font face="Times New Roman"><font size=+1>’
library. Now this should work.</font></font>
<p><font face="Times New Roman"><font size=+1>Even with this version, however,
GNU CC itself should not be linked with the sharable ‘</font></font><font face="Courier New"><font size=+0>VAXCRTL</font></font><font face="Times New Roman"><font size=+1>’.
The version of </font></font><font face="Courier New"><font size=+0>qsort</font></font><font face="Times New Roman"><font size=+1>
in ‘</font></font><font face="Courier New"><font size=+0>VAXCRTL</font></font><font face="Times New Roman"><font size=+1>’
has a bug (known to be present in VMS versions V4.6 through V5.5) which
causes the compiler to fail.</font></font>
<p><font face="Times New Roman"><font size=+1>The executables are generated
by ‘</font></font><font face="Courier New"><font size=+0>make-cc1.com</font></font><font face="Times New Roman"><font size=+1>’
and ‘</font></font><font face="Courier New"><font size=+0>make-cccp.com</font></font><font face="Times New Roman"><font size=+1>’
use the object library version of ‘</font></font><font face="Courier New"><font size=+0>VAXCRTL</font></font><font face="Times New Roman"><font size=+1>’
in order to make use of the </font></font><font face="Courier New"><font size=+0>qsort</font></font><font face="Times New Roman"><font size=+1>
routine in ‘</font></font><font face="Courier New"><font size=+0>gcclib.olb</font></font><font face="Times New Roman"><font size=+1>’.</font></font>
<p><font face="Times New Roman"><font size=+1>If you wish to link the compiler
executables with the shareable image version of&nbsp; ‘</font></font><font face="Courier New"><font size=+0>VAXCRTL</font></font><font face="Times New Roman"><font size=+1>’,
you should edit the file ‘</font></font><font face="Courier New"><font size=+0>tm.h</font></font><font face="Times New Roman"><font size=+1>’
(created by ‘</font></font><font face="Courier New"><font size=+0>vmsconfig.com</font></font><font face="Times New Roman"><font size=+1>’)
to define the macro </font></font><font face="Courier New"><font size=+0>QSORT_WORKAROUND</font></font><font face="Times New Roman"><font size=+1>.</font></font>
<p><font face="Courier New"><font size=+0>QSORT_WORKAROUND</font></font><font face="Times New Roman"><font size=+1>
is always defined when GNU CC is compiled with VAX C, to avoid a problem
in case ‘</font></font><font face="Courier New"><font size=+0>gcclib.olb</font></font><font face="Times New Roman"><font size=+1>’
is not yet available.</font></font>
<hr SIZE=3 WIDTH="100%">
<center><a href="#Top">Top</a>|<a href="gcc.html">Contents</a>|<a href="gccindex.html">Index</a>|<a href="gccInstalling_GNU_CC_on_the_Sun.html">Previous</a>|<a href="gccUsing_GNU_CC_on_VMS.html">Next</a></center>

</body>
</html>
