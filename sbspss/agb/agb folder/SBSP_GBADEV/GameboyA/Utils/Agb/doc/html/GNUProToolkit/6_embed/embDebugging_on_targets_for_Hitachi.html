<HTML>
<HEAD>
   <META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-8859-1">
   <META NAME="GENERATOR" CONTENT="Mozilla/4.04 [en] (Win95; I) [Netscape]">
   <TITLE>Debugging on targets for Hitachi h 8/300</TITLE>
</HEAD>
<BODY>
<A NAME="Top"></A><A HREF="emb.html">Contents</A>|<A HREF="embindex.html">Index</A>|<A HREF="embCalling_conventions_for_00000024.html">Previous</A>|<A HREF="embLoading_on_specific_targ00000026.html">Next</A>
<BR>&nbsp;<A NAME="off_330526"></A><A NAME="0f9cb65d"></A><A NAME="off_330526"></A><A NAME="0f9cb65d"></A><A NAME="off_330526"></A><A NAME="0f9cb65d"></A><A NAME="off_330526"></A><A NAME="0f9cb65d"></A><A NAME="off_330526"></A><A NAME="0f9cb65d"></A><A NAME="off_330526"></A><A NAME="0f9cb65d"></A><FONT FACE="Futura Md BT"><FONT COLOR="#000000"><FONT SIZE=+3><B>Debugging
on targets for Hitachi H8/300, H8S and H8/300H&nbsp;</B>&nbsp;
<HR SIZE=3 WIDTH="100%"></FONT></FONT></FONT><FONT FACE="Times New Roman"><FONT SIZE=+1>GDB
needs to know the following specifications to talk to a Hitachi target.</FONT></FONT>
<UL TYPE=SQUARE>
<LI>
<FONT FACE="Times New Roman"><FONT SIZE=+1>Specifications for one of the
following interfaces.</FONT></FONT></LI>

<UL TYPE=SQUARE><FONT FACE="Courier New"><FONT SIZE=+0></FONT></FONT>

<P><FONT FACE="Courier New"><FONT SIZE=+0>target remote</FONT></FONT>
<UL TYPE=SQUARE><FONT SIZE=+1><FONT FACE="Times New Roman,Times">GDB’s</FONT><FONT FACE="Times New Roman">
generic debugging protocol, for using with the Hitachi low-cost evaluation
board (LCEVB) running CMON.</FONT></FONT></UL>
<FONT FACE="Courier New"><FONT SIZE=+0>target hms</FONT></FONT>
<UL TYPE=SQUARE><FONT FACE="Times New Roman"><FONT SIZE=+1>Interface to
H8/300 </FONT></FONT><FONT FACE="Courier New"><FONT SIZE=+0>eval</FONT></FONT><FONT FACE="Times New Roman"><FONT SIZE=+1>
boards running the HMS monitor.</FONT></FONT></UL>
<FONT FACE="Courier New"><FONT SIZE=+0>target e7000</FONT></FONT>
<UL TYPE=SQUARE><FONT FACE="Times New Roman"><FONT SIZE=+1>E7000 in-circuit
emulator for the Hitachi H8/300.</FONT></FONT></UL>
<FONT FACE="Courier New"><FONT SIZE=+0>target sim</FONT></FONT>
<UL TYPE=SQUARE><FONT FACE="Times New Roman"><FONT SIZE=+1>Simulator, which
allows you to run </FONT></FONT><B><FONT FACE="Courier New"><FONT SIZE=+0>gdb</FONT></FONT></B><FONT FACE="Times New Roman"><FONT SIZE=+1>
remotely without an external device.</FONT></FONT></UL>
</UL>
<FONT FACE="Times New Roman"><FONT SIZE=+1></FONT></FONT>

<P><FONT FACE="Times New Roman"><FONT SIZE=+1>Specifications for what serial
device connects your host to your Hitachi board (the first serial device
available on your host is the default).</FONT></FONT>
<BR>&nbsp;
<LI>
<FONT FACE="Times New Roman"><FONT SIZE=+1>Specifications for what speed
to use over the serial device (if you are using a Unix host).</FONT></FONT></LI>

<BR><FONT FACE="Times New Roman"><FONT SIZE=+1>Use one of the following
</FONT></FONT><B><FONT FACE="Courier New"><FONT SIZE=+0>gdb</FONT></FONT></B><FONT FACE="Times New Roman"><FONT SIZE=+1>
commands to specify the connection to your target board.</FONT></FONT>
<BR>&nbsp;
<UL TYPE=SQUARE><FONT FACE="Courier New"><FONT SIZE=+0>target <I>interface
port</I></FONT></FONT>
<UL TYPE=SQUARE><FONT FACE="Times New Roman"><FONT SIZE=+1>To run a program
on the board, start up gdb with the name of your program as the argument.
To connect to the board, use the command </FONT></FONT><FONT FACE="Courier New"><FONT SIZE=+0>target
interface port</FONT></FONT><FONT FACE="Times New Roman"><FONT SIZE=+1>,
where </FONT></FONT><I><FONT FACE="Courier New"><FONT SIZE=+0>interface</FONT></FONT></I><FONT FACE="Times New Roman"><FONT SIZE=+1>
is an interface from the previous list and </FONT></FONT><I><FONT FACE="Courier New"><FONT SIZE=+0>port</FONT></FONT></I><FONT FACE="Times New Roman"><FONT SIZE=+1>
is the name of the serial port connected to the board. If the program has
not already been downloaded to the board, you may use the </FONT></FONT><FONT FACE="Courier New"><FONT SIZE=+0>load</FONT></FONT><FONT FACE="Times New Roman"><FONT SIZE=+1>
command to download it. You can then use all the usual gdb commands.</FONT></FONT></UL>

<UL TYPE=SQUARE><FONT FACE="Times New Roman"><FONT SIZE=+1>For example,
the following example’s sequence connects to the target board through a
serial port, and loads and runs a program called </FONT></FONT><I><FONT FACE="Courier New"><FONT SIZE=+0>prog</FONT></FONT></I><FONT FACE="Times New Roman"><FONT SIZE=+1>
through the debugger.</FONT></FONT>
<UL TYPE=SQUARE>
<PRE><FONT FACE="Courier New"><FONT SIZE=+1><B>host$ </B>h8300-hms-gdb <I>prog</I>&nbsp;
<B>GDB is free software and...&nbsp;
(gdb) </B>target remote /dev/ttyb&nbsp;
<B>...&nbsp;
(gdb) </B>load&nbsp;
<B>...&nbsp;
(gdb) </B>run</FONT></FONT></PRE>
</UL>
</UL>
<FONT FACE="Courier New"><FONT SIZE=+0></FONT></FONT>

<P><FONT FACE="Courier New"><FONT SIZE=+0>target <I>interface hostname</I>:
<I>portnumber</I></FONT></FONT>
<UL TYPE=SQUARE><FONT FACE="Times New Roman"><FONT SIZE=+1>You can specify
a TCP/IP connection instead of a serial port, using the syntax </FONT></FONT><I><FONT FACE="Courier New"><FONT SIZE=+0>hostname</FONT></FONT></I><FONT FACE="Times New Roman"><FONT SIZE=+1>:
</FONT></FONT><I><FONT FACE="Courier New"><FONT SIZE=+0>portnumber</FONT></FONT></I><FONT FACE="Times New Roman"><FONT SIZE=+1>(assuming
your board is connected so that this makes sense; for instance, to a serial
line managed by a terminal concentrator).</FONT></FONT>
<BR><FONT COLOR="#000000"><FONT FACE="Times New Roman"><FONT SIZE=+1>GDB
also supports </FONT></FONT><FONT FACE="Courier New"><FONT SIZE=+0>set
remotedebug <I>n.</I></FONT></FONT><FONT FACE="Times New Roman"><FONT SIZE=+1>
You can see some debugging information about communications with the board
by setting the variable,</FONT></FONT><FONT FACE="Courier New"><FONT SIZE=+0>
remotedebug</FONT></FONT><FONT FACE="Times New Roman"><FONT SIZE=+1>.</FONT></FONT></FONT></UL>
</UL>
</UL>
<FONT SIZE=+1>In comparison to the H8/300, the H8S has the following improvements.</FONT>
<UL>
<UL>
<UL>
<LI>
<FONT SIZE=+1>Eight 16-bit expanded registers, and one 8-bit control register.</FONT></LI>

<LI>
<FONT SIZE=+1>Normal mode supports the 64K-byte address space.</FONT></LI>

<LI>
<FONT SIZE=+1>Advanced mode supports a maximum 16M-byte address space.</FONT></LI>

<LI>
<FONT SIZE=+1>Addressing modes of bit-manipulation instructions improved.</FONT></LI>

<LI>
<FONT SIZE=+1>Signed multiply and divide instructions.</FONT></LI>

<LI>
<FONT SIZE=+1>Two-bit shift instructions.</FONT></LI>

<LI>
<FONT SIZE=+1>Instructions for saving and restoring multiple registers.</FONT></LI>

<LI>
<FONT SIZE=+1>A test and set instruction.</FONT></LI>

<LI>
<FONT SIZE=+1>Basic instructions executing doublespeed.</FONT></LI>

<LI>
<FONT SIZE=+1>The H8S uses a two-channel on-chip PC break controller (PBC)
for debugging programs with high-performance self-monitoring, without using
an in-circuit emulator.</FONT></LI>

<LI>
<FONT SIZE=+1>The ROM is connected to the CPU by a 16-bit data bus, enabling
both byte data and word data to be accessed in one state. This makes possible
rapid instruction high-speed processing.</FONT></LI>

<LI>
<FONT SIZE=+1>The H8S has eight 32-bit general registers, all functionally
alike for both address registers and data registers. When a general register
is used as a data register, it can be accessed as a 32-bit, 16-bit, or
8-bit register.</FONT></LI>

<BR><FONT SIZE=+1>When the general registers are used as 32-bit registers
or address registers, they use the letters, <FONT FACE="Courier New,Courier">ER</FONT>
(<FONT FACE="Courier New,Courier">ER0</FONT> to <FONT FACE="Courier New,Courier">ER7</FONT>).</FONT>
<BR><FONT SIZE=+1>The <FONT FACE="Courier New,Courier">ER</FONT> registers
divide into 16-bit general registers designated by the letters, <FONT FACE="Courier New,Courier">E</FONT>
(<FONT FACE="Courier New,Courier">E0</FONT> to <FONT FACE="Courier New,Courier">E7</FONT>)
and <FONT FACE="Courier New,Courier">R</FONT> (<FONT FACE="Courier New,Courier">R0</FONT>
to <FONT FACE="Courier New,Courier">R7</FONT>).</FONT>
<BR><FONT SIZE=+1>These registers are functionally equivalent, providing
a maximum 16 6-bit registers.</FONT>
<BR><FONT SIZE=+1>The <FONT FACE="Courier New,Courier">E</FONT> registers
(<FONT FACE="Courier New,Courier">E0</FONT> to <FONT FACE="Courier New,Courier">E7</FONT>)
are also referred to as extended registers.</FONT>
<BR><FONT SIZE=+1>The <FONT FACE="Courier New,Courier">R</FONT> registers
divide into 8-bit general registers, using the letters, <FONT FACE="Courier New,Courier">RH</FONT>
(<FONT FACE="Courier New,Courier">R0H</FONT> to <FONT FACE="Courier New,Courier">R7H</FONT>)
and <FONT FACE="Courier New,Courier">RL</FONT> (<FONT FACE="Courier New,Courier">R0L</FONT>
to <FONT FACE="Courier New,Courier">R7L</FONT>). These registers are functionally
equivalent, providing a maximum 16 8-bit registers.</FONT>
<BR><FONT SIZE=+1>The control registers are the 24-bit program counter
(<FONT FACE="Courier New,Courier">PC</FONT>), 8-bit extended control register
(<FONT FACE="Courier New,Courier">EXR</FONT>), and 8-bit condition-code
register (<FONT FACE="Courier New,Courier">CCR</FONT>).</FONT>
<BR><FONT SIZE=+1>The H8S supports eight addressing modes. See <A HREF="#Addressing_modes">Addressing
modes</A>.&nbsp;</FONT> <FONT SIZE=+1>The upper 8 bits of the effective
address are ignored, giving a 16-bit address.</FONT></UL>
</UL>
</UL>
&nbsp;
<CENTER><TABLE BORDER >
<TR VALIGN=TOP BGCOLOR="#CCCCCC">
<TD><A NAME="Addressing_modes"></A><B><I><FONT SIZE=+2>#&nbsp;</FONT></I></B></TD>

<TD><B><I><FONT SIZE=+1>Addressing mode&nbsp;</FONT></I></B></TD>

<TD><B><I><FONT SIZE=+1>Symbol</FONT></I></B></TD>
</TR>

<TR>
<TD><B>1</B></TD>

<TD><FONT SIZE=+1>Register direct&nbsp;</FONT></TD>

<TD><FONT FACE="Courier New,Courier"><FONT SIZE=+1>Rn</FONT></FONT></TD>
</TR>

<TR>
<TD><B><FONT SIZE=+1>2</FONT></B></TD>

<TD><FONT SIZE=+1>Register indirect</FONT></TD>

<TD><FONT FACE="Courier New,Courier"><FONT SIZE=+1>@ERn&nbsp;</FONT></FONT></TD>
</TR>

<TR VALIGN=TOP>
<TD><B><FONT SIZE=+1>3</FONT></B></TD>

<TD><FONT SIZE=+1>Register indirect with displacement&nbsp;</FONT></TD>

<TD><FONT SIZE=+1><FONT FACE="Courier New,Courier">@(d:16,ERn)&nbsp;</FONT>&nbsp;</FONT>&nbsp;
<BR><FONT FACE="Courier New,Courier"><FONT SIZE=+1>@(d:32,ERn)&nbsp;</FONT></FONT></TD>
</TR>

<TR VALIGN=TOP>
<TD><B><FONT SIZE=+1>4</FONT></B></TD>

<TD><FONT SIZE=+1>Register indirect with post-increment&nbsp;</FONT>&nbsp;
<BR><FONT SIZE=+1>Register indirect with pre-decrement&nbsp;</FONT></TD>

<TD><FONT SIZE=+1><FONT FACE="Courier New,Courier">@ERn+&nbsp;</FONT>&nbsp;</FONT>&nbsp;
<BR><FONT FACE="Courier New,Courier"><FONT SIZE=+1>@&macr;ERn</FONT></FONT></TD>
</TR>

<TR VALIGN=TOP>
<TD><B><FONT SIZE=+1>5</FONT></B></TD>

<TD><FONT SIZE=+1>Absolute address&nbsp;</FONT></TD>

<TD><FONT SIZE=+1><FONT FACE="Courier New,Courier">@aa:8</FONT>&nbsp;</FONT>&nbsp;
<BR><FONT SIZE=+1><FONT FACE="Courier New,Courier">@aa:16&nbsp;</FONT>&nbsp;</FONT>&nbsp;
<BR><FONT SIZE=+1><FONT FACE="Courier New,Courier">@aa:24&nbsp;</FONT>&nbsp;</FONT>&nbsp;
<BR><FONT FACE="Courier New,Courier"><FONT SIZE=+1>@aa:32&nbsp;</FONT></FONT></TD>
</TR>

<TR VALIGN=TOP>
<TD><B><FONT SIZE=+1>6</FONT></B></TD>

<TD><FONT SIZE=+1>Immediate</FONT></TD>

<TD><FONT SIZE=+1><FONT FACE="Courier New,Courier">#xx:8</FONT>&nbsp;</FONT>&nbsp;
<BR><FONT SIZE=+1><FONT FACE="Courier New,Courier">#xx:16</FONT>&nbsp;</FONT>&nbsp;
<BR><FONT FACE="Courier New,Courier"><FONT SIZE=+1>#xx:32</FONT></FONT></TD>
</TR>

<TR VALIGN=TOP>
<TD><B><FONT SIZE=+1>7</FONT></B></TD>

<TD><FONT SIZE=+1>Program-counter relative</FONT></TD>

<TD><FONT SIZE=+1><FONT FACE="Courier New,Courier">@(d:8,PC)</FONT>&nbsp;</FONT>&nbsp;
<BR><FONT FACE="Courier New,Courier"><FONT SIZE=+1>@(d:16,PC)&nbsp;</FONT></FONT></TD>
</TR>

<TR>
<TD><B><FONT SIZE=+1>8</FONT></B></TD>

<TD><FONT SIZE=+1>Memory indirect&nbsp;</FONT></TD>

<TD><FONT FACE="Courier New,Courier"><FONT SIZE=+1>@@aa:8&nbsp;</FONT></FONT></TD>
</TR>
</TABLE></CENTER>
<FONT SIZE=+1>&nbsp;</FONT>
<UL>
<UL>
<UL>
<LI>
<FONT SIZE=+1>H8S initiates exception handling by a reset, a trap instruction,
or an interrupt. Simultaneously generated exceptions are handled in order
of priority. Exceptions originate from various sources. Trap instruction
exception handling is always accepted in the program execution state. Trap
instructions and interrupts are handled as in the following sequence.</FONT></LI>

<UL><FONT FACE="Arial,Helvetica"><FONT SIZE=+1></FONT></FONT>

<P><FONT FACE="Arial,Helvetica"><FONT SIZE=+1>1.</FONT></FONT>
<BR><FONT SIZE=+1>The program counter (<FONT FACE="Courier New,Courier">PC</FONT>),
condition code register (<FONT FACE="Courier New,Courier">CCR</FONT>),
and extend register (<FONT FACE="Courier New,Courier">EXR</FONT>) are pushed
onto the stack.</FONT>
<BR><FONT FACE="Arial,Helvetica"><FONT SIZE=+1>2.</FONT></FONT>
<BR><FONT SIZE=+1>The interrupt mask bits are updated. The <FONT FACE="Courier New,Courier">T</FONT>
bit is cleared to 0.</FONT>
<BR><FONT FACE="Arial,Helvetica"><FONT SIZE=+1>3.</FONT></FONT>
<BR><FONT SIZE=+1>A vector address corresponding to the exception source
is generated, and program execution starts from that address.</FONT></UL>
<FONT SIZE=+1></FONT>

<P><FONT SIZE=+1>For a reset exception, use <B>Step 2</B> and <B>Step 3</B>.</FONT></UL>
</UL>
</UL>

<CENTER>
<HR SIZE=3 WIDTH="100%"></CENTER>

<CENTER><A HREF="#Top">Top</A>|<A HREF="emb.html">Contents</A>|<A HREF="embindex.html">Index</A>|<A HREF="embCalling_conventions_for_00000024.html">Previous</A>|<A HREF="embLoading_on_specific_targ00000026.html">Next</A></CENTER>

<UL>
<UL>
<UL>&nbsp;</UL>
</UL>
</UL>

</BODY>
</HTML>
