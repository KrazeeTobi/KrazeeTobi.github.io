<HTML>
<HEAD>
   <META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-8859-1">
   <META NAME="GENERATOR" CONTENT="Mozilla/4.04 [en] (Win95; I) [Netscape]">
   <TITLE>The EBMON protocol for AMD29K</TITLE>
</HEAD>
<BODY>
<A NAME="Top"></A><A HREF="gdb.html">Contents</A>|<A HREF="gdbindex.html">Index</A>|<A HREF="gdbThe_UDI_protocol_for_AMD29K.html">Previous</A>|<A HREF="gdbGDB_with_a_Tandem_ST2000.html">Next</A>
<BR><A NAME="off_2656985"></A><A NAME="eba69d83"></A><B><FONT FACE="Futura Md BT"><FONT COLOR="#000000"><FONT SIZE=+3>The
EBMON protocol for AMD29K</FONT></FONT></FONT></B>
<BR>
<HR SIZE=3 WIDTH="100%"><FONT FACE="Times New Roman"><FONT SIZE=+1>AMD
distributes a 29K development board meant to fit in a PC, together with
a DOS-hosted monitor program called </FONT></FONT><FONT FACE="Courier New"><FONT SIZE=+0>EBMON</FONT></FONT><FONT FACE="Times New Roman"><FONT SIZE=+1>.
“EB29K” is a shorthand term for this development system. The following
documentation discusses the “EB29K” development.</FONT></FONT>
<UL>
<UL>
<UL>
<LI>
<FONT FACE="Times New Roman"><FONT SIZE=+1><A HREF="#Communications_setup">Communications
setup</A></FONT></FONT></LI>

<LI>
<FONT FACE="Times New Roman"><FONT SIZE=+1><A HREF="#EB29K_crossdebug">EB29K
cross-debugging</A></FONT></FONT></LI>

<LI>
<FONT FACE="Times New Roman"><FONT SIZE=+1><A HREF="#Remote_log">Remote
log</A></FONT></FONT></LI>
</UL>
</UL>
</UL>
<FONT FACE="Times New Roman"><FONT SIZE=+1>To use GDB from a Unix system
to run programs on the EB29K board, you must first connect a serial cable
between the PC (which hosts the EB29K board) and a serial port on the Unix
system.</FONT></FONT>

<P><FONT FACE="Times New Roman"><FONT SIZE=+1>In the following discussions,
we assume you’ve hooked the cable between the PC’s ‘</FONT></FONT><FONT FACE="Courier New"><FONT SIZE=+0>COM1</FONT></FONT><FONT FACE="Times New Roman"><FONT SIZE=+1>’
port and ‘</FONT></FONT><FONT FACE="Courier New"><FONT SIZE=+0>/dev/ttya</FONT></FONT><FONT FACE="Times New Roman"><FONT SIZE=+1>’
on the Unix system.</FONT></FONT>

<P><A NAME="Communications_setup"></A><B><I><FONT FACE="Times New Roman"><FONT SIZE=+2>Communications
setup</FONT></FONT></I></B>

<P><FONT FACE="Times New Roman"><FONT SIZE=+1>The next step is to set up
the PC’s port, by using something like the following in DOS on the PC:</FONT></FONT>
<UL><FONT FACE="Courier New"><FONT SIZE=+0><B>C:\></B> MODE com1:9600,n,8,1,none</FONT></FONT></UL>
<FONT FACE="Times New Roman"><FONT SIZE=+1>This example—run on an MS DOS
4.0 system—sets the PC port to 9600 bps, no parity, eight data bits, one
stop bit, and no “retry” action; you must match the communications parameters
when establishing the Unix end of the connection as well.</FONT></FONT>

<P><FONT FACE="Times New Roman"><FONT SIZE=+1>To give control of the PC
to the Unix side of the serial line, at the </FONT></FONT><B><FONT FACE="Courier New"><FONT SIZE=+0>C:\></FONT></FONT></B><FONT FACE="Times New Roman"><FONT SIZE=+1>
prompt, type: </FONT></FONT><FONT FACE="Courier New"><FONT SIZE=+0>CTTY
com1</FONT></FONT><FONT FACE="Times New Roman"><FONT SIZE=+1>.</FONT></FONT>

<P><FONT FACE="Times New Roman"><FONT SIZE=+1>(Later, if you wish to return
control to the DOS console, you can use the command </FONT></FONT><FONT FACE="Courier New"><FONT SIZE=+0>CTTY
con</FONT></FONT><FONT FACE="Times New Roman"><FONT SIZE=+1>—but you must
send it over the device that had control, in the example, over the ‘</FONT></FONT><FONT FACE="Courier New"><FONT SIZE=+0>COM1</FONT></FONT><FONT FACE="Times New Roman"><FONT SIZE=+1>’
serial line). From the Unix host, use a communications program such as
</FONT></FONT><FONT FACE="Courier New"><FONT SIZE=+0>tip</FONT></FONT><FONT FACE="Times New Roman"><FONT SIZE=+1>
or </FONT></FONT><FONT FACE="Courier New"><FONT SIZE=+0>cu</FONT></FONT><FONT FACE="Times New Roman"><FONT SIZE=+1>
to communicate with the PC; for example, </FONT></FONT><FONT FACE="Courier New"><FONT SIZE=+0>cu
-s 9600 -l /dev/ttya</FONT></FONT><FONT FACE="Times New Roman"><FONT SIZE=+1>.</FONT></FONT>

<P><FONT FACE="Times New Roman"><FONT SIZE=+1>The </FONT></FONT><FONT FACE="Courier New"><FONT SIZE=+0>cu</FONT></FONT><FONT FACE="Times New Roman"><FONT SIZE=+1>
options shown specify, respectively, the linespeed and the serial port
to use. If you use </FONT></FONT><FONT FACE="Courier New"><FONT SIZE=+0>tip</FONT></FONT><FONT FACE="Times New Roman"><FONT SIZE=+1>
instead, your command line may look something like: </FONT></FONT><FONT FACE="Courier New"><FONT SIZE=+0>tip
-9600 /dev/ttya</FONT></FONT><FONT FACE="Times New Roman"><FONT SIZE=+1>.</FONT></FONT>

<P><FONT FACE="Times New Roman"><FONT SIZE=+1>Your system may require a
different name where we show </FONT></FONT><FONT FACE="Courier New"><FONT SIZE=+0>/dev/ttya</FONT></FONT><FONT FACE="Times New Roman"><FONT SIZE=+1>
as the argument to </FONT></FONT><FONT FACE="Courier New"><FONT SIZE=+0>tip</FONT></FONT><FONT FACE="Times New Roman"><FONT SIZE=+1>.
The communications parameters, including which port to use, are associated
with the </FONT></FONT><FONT FACE="Courier New"><FONT SIZE=+0>tip</FONT></FONT><FONT FACE="Times New Roman"><FONT SIZE=+1>
argument in the “remote” descriptions file—normally the system table, </FONT></FONT><FONT FACE="Courier New"><FONT SIZE=+0>/etc/remote</FONT></FONT><FONT FACE="Times New Roman"><FONT SIZE=+1>.</FONT></FONT>

<P><FONT FACE="Times New Roman"><FONT SIZE=+1>Using the </FONT></FONT><FONT FACE="Courier New"><FONT SIZE=+0>tip</FONT></FONT><FONT FACE="Times New Roman"><FONT SIZE=+1>
or </FONT></FONT><FONT FACE="Courier New"><FONT SIZE=+0>cu</FONT></FONT><FONT FACE="Times New Roman"><FONT SIZE=+1>
connection, change the DOS working directory to the directory containing
a copy of your 29K program, then start the PC program, </FONT></FONT><FONT FACE="Courier New"><FONT SIZE=+0>EBMON</FONT></FONT><FONT FACE="Times New Roman"><FONT SIZE=+1>
(an EB29K control program supplied with your board by AMD).</FONT></FONT>

<P><FONT FACE="Times New Roman"><FONT SIZE=+1>You should see an initial
display from </FONT></FONT><FONT FACE="Courier New"><FONT SIZE=+0>EBMON</FONT></FONT><FONT FACE="Times New Roman"><FONT SIZE=+1>
similar to the one that follows, ending with the </FONT></FONT><FONT FACE="Courier New"><FONT SIZE=+0>EBMON</FONT></FONT><FONT FACE="Times New Roman"><FONT SIZE=+1>
prompt, ‘</FONT></FONT><FONT FACE="Courier New"><FONT SIZE=+0>#</FONT></FONT><FONT FACE="Times New Roman"><FONT SIZE=+1>’—</FONT></FONT>
<BR>&nbsp;
<UL><B><FONT FACE="Courier New"><FONT SIZE=+0>C:\> G:</FONT></FONT></B>

<P><B><FONT FACE="Courier New"><FONT SIZE=+0>G:\> CD \usr\joe\work29k</FONT></FONT></B>
<BR><B><FONT FACE="Courier New"><FONT SIZE=+0>G:\USR\JOE\WORK29K> EBMON
Am29000 PC Coprocessor Board Monitor, version 3.0-18 Copyright 1990 Advanced
Micro Devices, Inc. Written by Gibbons and Associates, Inc.</FONT></FONT></B>

<P><B><FONT SIZE=+0><FONT FACE="Courier New">Enter </FONT><FONT FACE="Times New Roman">’</FONT><FONT FACE="Courier New">?</FONT><FONT FACE="Times New Roman">’</FONT><FONT FACE="Courier New">
or </FONT><FONT FACE="Times New Roman">’</FONT><FONT FACE="Courier New">H</FONT><FONT FACE="Times New Roman">’</FONT><FONT FACE="Courier New">
for help</FONT></FONT></B>

<P><B><FONT FACE="Courier New"><FONT SIZE=+0>PC Coprocessor Type&nbsp;&nbsp;&nbsp;
= EB29K</FONT></FONT></B>
<BR><B><FONT FACE="Courier New"><FONT SIZE=+0>I/O Base&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
= 0x208</FONT></FONT></B>
<BR><B><FONT FACE="Courier New"><FONT SIZE=+0>Memory Base&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
= 0xd0000</FONT></FONT></B>
<BR><B><FONT FACE="Courier New"><FONT SIZE=+0>Data Memory Size&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
= 2048KB</FONT></FONT></B>
<BR><B><FONT FACE="Courier New"><FONT SIZE=+0>Available I-RAM Range&nbsp;&nbsp;&nbsp;
= 0x8000 to 0x1fffff</FONT></FONT></B>
<BR><B><FONT FACE="Courier New"><FONT SIZE=+0>Available D-RAM Range&nbsp;&nbsp;&nbsp;
= 0x80002000 to 0x801fffff</FONT></FONT></B>

<P><B><FONT FACE="Courier New"><FONT SIZE=+0>PageSize&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
= 0x400</FONT></FONT></B>
<BR><B><FONT FACE="Courier New"><FONT SIZE=+0>Register Stack Size&nbsp;&nbsp;&nbsp;
= 0x800</FONT></FONT></B>
<BR><B><FONT FACE="Courier New"><FONT SIZE=+0>Memory Stack Size&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
= 0x1800</FONT></FONT></B>

<P><B><FONT FACE="Courier New"><FONT SIZE=+0>CPU PRL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
= 0x3</FONT></FONT></B>
<BR><B><FONT FACE="Courier New"><FONT SIZE=+0>Am29027 Available&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
= No</FONT></FONT></B>
<BR><B><FONT FACE="Courier New"><FONT SIZE=+0>Byte Write Available&nbsp;&nbsp;&nbsp;
= Yes</FONT></FONT></B>

<P><B><FONT FACE="Courier New"><FONT SIZE=+0># ˜.</FONT></FONT></B></UL>


<P><FONT FACE="Times New Roman"><FONT SIZE=+1>Then exit the </FONT></FONT><FONT FACE="Courier New"><FONT SIZE=+0>cu</FONT></FONT><FONT FACE="Times New Roman"><FONT SIZE=+1>
or </FONT></FONT><FONT FACE="Courier New"><FONT SIZE=+0>tip</FONT></FONT><FONT SIZE=+1><FONT FACE="Times New Roman">
program (in the example by using </FONT><TT>˜.</TT><FONT FACE="Times New Roman">
at the </FONT></FONT><FONT FACE="Courier New"><FONT SIZE=+0>EBMON</FONT></FONT><FONT FACE="Times New Roman"><FONT SIZE=+1>
prompt, </FONT></FONT><B><FONT FACE="Courier New"><FONT SIZE=+0>#</FONT></FONT></B><FONT FACE="Times New Roman"><FONT SIZE=+1>).
</FONT></FONT><FONT FACE="Courier New"><FONT SIZE=+0>EBMON</FONT></FONT><FONT FACE="Times New Roman"><FONT SIZE=+1>
keeps running, ready for GDB to take over.</FONT></FONT>

<P><FONT FACE="Times New Roman"><FONT SIZE=+1>For this example, we’ve assumed
what is probably the most convenient way to make sure the same 29K program
is on both the PC and the Unix system: a PC/NFS connection that establishes
“drive </FONT></FONT><B><FONT FACE="Courier New"><FONT SIZE=+0>G:</FONT></FONT></B><FONT FACE="Times New Roman"><FONT SIZE=+1>”on
the PC as a file system on the Unix host. If you do not have PC/NFS or
something similar connecting the two systems, you must arrange some other
way—perhaps floppy-disk transfer—of getting the 29K program from the Unix
system to the PC; GDB does not download it over the serial line.</FONT></FONT>

<P><A NAME="EB29K_crossdebug"></A><B><I><FONT FACE="Times New Roman"><FONT SIZE=+2>EB29K
cross-debugging</FONT></FONT></I></B>

<P><FONT FACE="Times New Roman"><FONT SIZE=+1>Finally, </FONT></FONT><FONT FACE="Courier New"><FONT SIZE=+0>cd</FONT></FONT><FONT FACE="Times New Roman"><FONT SIZE=+1>
to the directory containing an image of your 29K program on the Unix system,
and start GDB—specifying as argument the name of your 29K program, as in
the following example.</FONT></FONT>
<BR>&nbsp;
<UL><B><FONT FACE="Courier New"><FONT SIZE=+0>cd /usr/joe/work29k</FONT></FONT></B>
<BR><B><FONT FACE="Courier New"><FONT SIZE=+0>gdb myfoo</FONT></FONT></B></UL>


<P><FONT FACE="Times New Roman"><FONT SIZE=+1>Now, use the </FONT></FONT><FONT FACE="Courier New"><FONT SIZE=+0>target</FONT></FONT><FONT FACE="Times New Roman"><FONT SIZE=+1>
command, </FONT></FONT><FONT FACE="Courier New"><FONT SIZE=+0>target amd-eb
/dev/ttya 9600 MYFOO</FONT></FONT>

<P><FONT FACE="Times New Roman"><FONT SIZE=+1>In this example, we’ve assumed
your program is in a file called ‘</FONT></FONT><FONT FACE="Courier New"><FONT SIZE=+0>myfoo</FONT></FONT><FONT FACE="Times New Roman"><FONT SIZE=+1>’.</FONT></FONT>
<UL><FONT FACE="Times New Roman"><FONT SIZE=+1><I>Note</I>:</FONT></FONT>
<BR><FONT FACE="Times New Roman"><FONT SIZE=+1>The filename given as the
last argument to </FONT></FONT><FONT FACE="Courier New"><FONT SIZE=+0>target</FONT></FONT><FONT FACE="Times New Roman"><FONT SIZE=+1>
</FONT></FONT><FONT FACE="Courier New"><FONT SIZE=+0>amd-eb</FONT></FONT><FONT FACE="Times New Roman"><FONT SIZE=+1>
should be the name of the program as it appears to DOS. In our example
this is simply </FONT></FONT><FONT FACE="Courier New"><FONT SIZE=+0>MYFOO</FONT></FONT><FONT FACE="Times New Roman"><FONT SIZE=+1>,
but in general it can include a DOS path, and, depending on your transfer
mechanism, may not resemble the name on the Unix side. At this point, you
can set any breakpoints you wish; when you are ready to see your program
run on the 29K board, use the GDB command, </FONT></FONT><FONT FACE="Courier New"><FONT SIZE=+0>run</FONT></FONT><FONT FACE="Times New Roman"><FONT SIZE=+1>.</FONT></FONT></UL>
<FONT FACE="Times New Roman"><FONT SIZE=+1>To stop debugging the remote
program, use the GDB </FONT></FONT><FONT FACE="Courier New"><FONT SIZE=+0>detach</FONT></FONT><FONT FACE="Times New Roman"><FONT SIZE=+1>
command.</FONT></FONT>

<P><FONT FACE="Times New Roman"><FONT SIZE=+1>To return control of the
PC to its console, use </FONT></FONT><FONT FACE="Courier New"><FONT SIZE=+0>tip</FONT></FONT><FONT FACE="Times New Roman"><FONT SIZE=+1>
or </FONT></FONT><FONT FACE="Courier New"><FONT SIZE=+0>cu</FONT></FONT><FONT FACE="Times New Roman"><FONT SIZE=+1>
once again, after your GDB session has concluded, to attach to </FONT></FONT><FONT FACE="Courier New"><FONT SIZE=+0>EBMON</FONT></FONT><FONT FACE="Times New Roman"><FONT SIZE=+1>.
You can then type the command </FONT></FONT><FONT FACE="Courier New"><FONT SIZE=+0>q</FONT></FONT><FONT FACE="Times New Roman"><FONT SIZE=+1>
to shut down </FONT></FONT><FONT FACE="Courier New"><FONT SIZE=+0>EBMON</FONT></FONT><FONT FACE="Times New Roman"><FONT SIZE=+1>,
returning control to the DOS command-line interpreter. Type </FONT></FONT><FONT FACE="Courier New"><FONT SIZE=+0>CTTY
con</FONT></FONT><FONT FACE="Times New Roman"><FONT SIZE=+1> to return
command input to the main DOS console, and type </FONT></FONT><FONT FACE="Courier New"><FONT SIZE=+0>˜.</FONT></FONT><FONT FACE="Times New Roman"><FONT SIZE=+1>
to leave </FONT></FONT><FONT FACE="Courier New"><FONT SIZE=+0>tip</FONT></FONT><FONT FACE="Times New Roman"><FONT SIZE=+1>
or </FONT></FONT><FONT FACE="Courier New"><FONT SIZE=+0>cu</FONT></FONT><FONT FACE="Times New Roman"><FONT SIZE=+1>.</FONT></FONT>

<P><A NAME="Remote_log"></A><B><I><FONT FACE="Times New Roman"><FONT SIZE=+2>Remote
log</FONT></FONT></I></B>

<P><FONT FACE="Times New Roman"><FONT SIZE=+1>The </FONT></FONT><FONT FACE="Courier New"><FONT SIZE=+0>target
amd-eb</FONT></FONT><FONT FACE="Times New Roman"><FONT SIZE=+1> command
creates a file, ‘</FONT></FONT><FONT FACE="Courier New"><FONT SIZE=+0>eb.log</FONT></FONT><FONT FACE="Times New Roman"><FONT SIZE=+1>’,
in the current working directory, to help debug problems with the connection.
‘</FONT></FONT><FONT FACE="Courier New"><FONT SIZE=+0>eb.log</FONT></FONT><FONT FACE="Times New Roman"><FONT SIZE=+1>’
records all the output from </FONT></FONT><FONT FACE="Courier New"><FONT SIZE=+0>EBMON</FONT></FONT><FONT FACE="Times New Roman"><FONT SIZE=+1>,
including echoes of the commands sent to it. Running ‘</FONT></FONT><FONT FACE="Courier New"><FONT SIZE=+0>tail
-f</FONT></FONT><FONT FACE="Times New Roman"><FONT SIZE=+1>’ on this file
in another window often helps to understand trouble with </FONT></FONT><FONT FACE="Courier New"><FONT SIZE=+0>EBMON</FONT></FONT><FONT FACE="Times New Roman"><FONT SIZE=+1>,
or unexpected events on the PC side of the connection.</FONT></FONT>
<BR>
<HR SIZE=3 WIDTH="100%">
<CENTER><A HREF="#Top">Top</A>|<A HREF="gdb.html">Contents</A>|<A HREF="gdbindex.html">Index</A>|<A HREF="gdbThe_UDI_protocol_for_AMD29K.html">Previous</A>|<A HREF="gdbGDB_with_a_Tandem_ST2000.html">Next</A></CENTER>

</BODY>
</HTML>
