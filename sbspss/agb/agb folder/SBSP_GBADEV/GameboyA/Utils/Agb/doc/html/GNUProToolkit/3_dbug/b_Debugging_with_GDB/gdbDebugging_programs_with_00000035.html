<HTML>
<HEAD>
   <META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-8859-1">
   <META NAME="GENERATOR" CONTENT="Mozilla/4.04 [en] (Win95; I) [Netscape]">
   <TITLE>Debugging programs with multiple threads</TITLE>
</HEAD>
<BODY>
<A NAME="Top"></A><A HREF="gdb.html">Contents</A>|<A HREF="gdbindex.html">Index</A>|<A HREF="gdbAdditional_process_information.html">Previous</A>|<A HREF="gdbDebugging_programs_with_00000036.html">Next</A>
<BR><A NAME="off_658077"></A><A NAME="776c2210"></A><B><FONT FACE="Futura Md BT"><FONT COLOR="#000000"><FONT SIZE=+3>Debugging
programs with multiple threads&nbsp;</FONT></FONT></FONT></B>
<HR SIZE=3 WIDTH="100%">

<P><FONT FACE="Times New Roman"><FONT SIZE=+1>In some operating systems,
a single program may have more than one <I>thread</I> of execution. The
precise semantics of threads differ from one operating system to another,
but in general the threads of a single program are akin to multiple processes—except
that they share one address space (that is, they can all examine and modify
the same variables). On the other hand, each thread has its own registers
and execution stack, and perhaps private memory. GDB provides the following
facilities for debugging multi-thread programs:</FONT></FONT>
<BR>&nbsp;
<UL>
<UL>
<UL>
<LI>
<FONT FACE="Times New Roman"><FONT SIZE=+1>automatic notification of new
threads</FONT></FONT></LI>

<LI>
<FONT FACE="Times New Roman"><FONT SIZE=+1>‘</FONT></FONT><FONT FACE="Courier New"><FONT SIZE=+0>thread
<I>threadno</I></FONT></FONT><FONT FACE="Times New Roman"><FONT SIZE=+1>’,
a command to switch among threads</FONT></FONT></LI>

<LI>
<FONT FACE="Times New Roman"><FONT SIZE=+1>‘</FONT></FONT><FONT FACE="Courier New"><FONT SIZE=+0>info
threads</FONT></FONT><FONT FACE="Times New Roman"><FONT SIZE=+1>’, a command
to inquire about existing threads</FONT></FONT></LI>

<LI>
<FONT FACE="Times New Roman"><FONT SIZE=+1>‘</FONT></FONT><FONT FACE="Courier New"><FONT SIZE=+0>thread
apply</FONT></FONT><FONT FACE="Times New Roman"><FONT SIZE=+1> </FONT></FONT><FONT FACE="Courier New"><FONT SIZE=+0>[<I>threadno</I>][<I>all</I>]
<I>args</I></FONT></FONT><FONT FACE="Times New Roman"><FONT SIZE=+1>’,
a command to apply a command to a list of threads</FONT></FONT></LI>

<LI>
<FONT FACE="Times New Roman"><FONT SIZE=+1>thread-specific breakpoints</FONT></FONT></LI>
</UL>
</UL>
</UL>


<P><FONT FACE="Times New Roman"><FONT SIZE=+1><B><I>Warning</I></B>:</FONT></FONT>
<BR><FONT FACE="Times New Roman"><FONT SIZE=+1>These facilities are not
yet available on every GDB configuration where the operating system supports
threads. If your GDB does not support threads, these commands have no effect.
For instance, a system without thread support shows no output from ‘</FONT></FONT><FONT FACE="Courier New"><FONT SIZE=+0>info
threads</FONT></FONT><FONT FACE="Times New Roman"><FONT SIZE=+1>’ and always
rejects the </FONT></FONT><FONT FACE="Courier New"><FONT SIZE=+0>thread</FONT></FONT><FONT FACE="Times New Roman"><FONT SIZE=+1>
command, like the following example shows.</FONT></FONT>
<BR>&nbsp;
<UL><B><FONT FACE="Courier New"><FONT SIZE=+0>(gdb) info threads</FONT></FONT></B>
<BR><B><FONT FACE="Courier New"><FONT SIZE=+0>(gdb) thread 1</FONT></FONT></B>
<BR><B><FONT FACE="Courier New"><FONT SIZE=+0>Thread ID 1 not known. Use
the "info threads" command to see the IDs of currently known threads.</FONT></FONT></B></UL>


<P><FONT FACE="Times New Roman"><FONT SIZE=+1>The GDB thread debugging
facility allows you to observe all threads while your program runs—but
whenever GDB takes control, one thread in particular is always the focus
of debugging. This thread is called the <I>current thread</I>. Debugging
commands show program information from the perspective of the current thread.</FONT></FONT>

<P><FONT FACE="Times New Roman"><FONT SIZE=+1>Whenever GDB detects a new
thread in your program, it displays the target system’s identification
for the thread with a message in the form ‘</FONT></FONT><FONT FACE="Courier New"><FONT SIZE=+0>[New<I>
systag</I>]</FONT></FONT><FONT FACE="Times New Roman"><FONT SIZE=+1>’.</FONT></FONT><I><FONT FACE="Courier New"><FONT SIZE=+0>
systag</FONT></FONT></I><FONT FACE="Times New Roman"><FONT SIZE=+1> is
a thread identifier whose form varies depending on the particular system.
For example, on LynxOS, you might see </FONT></FONT><FONT FACE="Courier New"><FONT SIZE=+0>[New
process 35 thread 27] </FONT></FONT><FONT FACE="Times New Roman"><FONT SIZE=+1>when
GDB notices a new thread. In contrast, on an SGI system, the </FONT></FONT><I><FONT FACE="Courier New"><FONT SIZE=+0>systag</FONT></FONT></I><FONT FACE="Times New Roman"><FONT SIZE=+1>
is simply something like ‘</FONT></FONT><FONT FACE="Courier New"><FONT SIZE=+0>process
368</FONT></FONT><FONT FACE="Times New Roman"><FONT SIZE=+1>’, with no
further qualifier.</FONT></FONT>

<P><FONT FACE="Times New Roman"><FONT SIZE=+1>For debugging purposes, GDB
associates its own thread number—always a single integer—with each thread
in your program.</FONT></FONT>
<BR>&nbsp;
<UL><FONT FACE="Courier New"><FONT SIZE=+0>info threads</FONT></FONT><FONT FACE="Times New Roman"><FONT SIZE=+1></FONT></FONT>
<UL><FONT FACE="Times New Roman"><FONT SIZE=+1>Display a summary of all
threads currently in your program. GDB displays for each thread (in the
following order):</FONT></FONT>
<BR>&nbsp;
<UL><FONT SIZE=+1><FONT FACE="Arial">a. </FONT><FONT FACE="Times New Roman">The
thread number assigned by GDB.</FONT></FONT>

<P><FONT SIZE=+1><FONT FACE="Arial">b. </FONT><FONT FACE="Times New Roman">The
target system’s thread identifier (</FONT></FONT><I><FONT FACE="Courier New"><FONT SIZE=+0>systag</FONT></FONT></I><FONT FACE="Times New Roman"><FONT SIZE=+1>).</FONT></FONT>

<P><FONT SIZE=+1><FONT FACE="Arial">c. </FONT><FONT FACE="Times New Roman">The
current stack frame summary for that thread.</FONT></FONT></UL>


<P><FONT FACE="Times New Roman"><FONT SIZE=+1>An asterisk ‘</FONT></FONT><FONT FACE="Courier New"><FONT SIZE=+0>*</FONT></FONT><FONT FACE="Times New Roman"><FONT SIZE=+1>’
to the left of the GDB thread number indicates the current thread. Use
the following example for clarity.</FONT></FONT>
<BR>&nbsp;
<UL><B><FONT FACE="Courier New"><FONT SIZE=+0>(gdb) info threads</FONT></FONT></B>
<BR><B><FONT FACE="Courier New"><FONT SIZE=+0>&nbsp;&nbsp;&nbsp; 3 process
35 thread 27 0x34e5 in sigpause ()</FONT></FONT></B>
<BR><B><FONT FACE="Courier New"><FONT SIZE=+0>&nbsp;&nbsp;&nbsp; 2 process
35 thread 23 0x34e5 in sigpause ()</FONT></FONT></B>
<BR><B><FONT FACE="Courier New"><FONT SIZE=+0>*&nbsp;&nbsp;&nbsp; 1 process
35 thread 13 main (argc=1, argv=0x7ffffff8)</FONT></FONT></B>
<BR><B><FONT FACE="Courier New"><FONT SIZE=+0>&nbsp;&nbsp;&nbsp;&nbsp;
at threadtest.c:68</FONT></FONT></B></UL>
</UL>


<P><FONT FACE="Courier New"><FONT SIZE=+0>thread <I>threadno</I></FONT></FONT><FONT FACE="Times New Roman"><FONT SIZE=+1></FONT></FONT>
<UL><FONT FACE="Times New Roman"><FONT SIZE=+1>Make thread number </FONT></FONT><I><FONT FACE="Courier New"><FONT SIZE=+0>threadno</FONT></FONT></I><FONT FACE="Times New Roman"><FONT SIZE=+1>
the current thread. The command argument, </FONT></FONT><I><FONT FACE="Courier New"><FONT SIZE=+0>threadno</FONT></FONT></I><FONT FACE="Times New Roman"><FONT SIZE=+1>,
is the internal GDB thread number, as shown in the first field of the ‘</FONT></FONT><FONT FACE="Courier New"><FONT SIZE=+0>info
threads</FONT></FONT><FONT FACE="Times New Roman"><FONT SIZE=+1>’ display.
GDB responds by displaying the system identifier of the thread you selected,
and its current stack frame summary:</FONT></FONT>

<P><B><FONT FACE="Courier New"><FONT SIZE=+0>(gdb) thread 2</FONT></FONT></B>
<BR><B><FONT FACE="Courier New"><FONT SIZE=+0>[Switching to process 35
thread 23]</FONT></FONT></B>
<BR><B><FONT FACE="Courier New"><FONT SIZE=+0>0x34e5 in sigpause ()</FONT></FONT></B></UL>
&nbsp;
<UL><FONT FACE="Times New Roman"><FONT SIZE=+1>As with the ‘</FONT></FONT><FONT FACE="Courier New"><FONT SIZE=+0>[New
...]</FONT></FONT><FONT FACE="Times New Roman"><FONT SIZE=+1>’ message,
the form of the text after ‘</FONT></FONT><FONT FACE="Courier New"><FONT SIZE=+0>Switching
to</FONT></FONT><FONT FACE="Times New Roman"><FONT SIZE=+1>’ depends on
your system’s conventions for identifying threads.</FONT></FONT></UL>


<P><FONT FACE="Courier New"><FONT SIZE=+0>thread apply [<I>threadno</I>][<I>all</I>]
<I>args</I></FONT></FONT>
<UL><FONT FACE="Times New Roman"><FONT SIZE=+1>The thread apply command
allows you to apply a command to one or more threads. Specify the numbers
of the threads that you want affected with the command argument </FONT></FONT><I><FONT FACE="Courier New"><FONT SIZE=+0>threadno</FONT></FONT></I><FONT FACE="Times New Roman"><FONT SIZE=+1>.
</FONT></FONT><I><FONT FACE="Courier New"><FONT SIZE=+0>threadno </FONT></FONT></I><FONT FACE="Times New Roman"><FONT SIZE=+1>is
the internal GDB thread number, as shown in the first field of the ‘</FONT></FONT><FONT FACE="Courier New"><FONT SIZE=+0>info
threads</FONT></FONT><FONT FACE="Times New Roman"><FONT SIZE=+1>’ display.
To apply a command to all threads, use </FONT></FONT><FONT FACE="Courier New"><FONT SIZE=+0>thread
apply all args</FONT></FONT><FONT FACE="Times New Roman"><FONT SIZE=+1>.</FONT></FONT>
<BR><FONT FACE="Times New Roman"><FONT SIZE=+1>Whenever GDB stops your
program, due to a breakpoint or a signal, it automatically selects the
thread where that breakpoint or signal happened. GDB alerts you to the
context switch with a message of the form ‘</FONT></FONT><FONT FACE="Courier New"><FONT SIZE=+0>[Switching
to <I>systag</I>]</FONT></FONT><FONT FACE="Times New Roman"><FONT SIZE=+1>’
to identify the thread.</FONT></FONT>
<BR><FONT FACE="Times New Roman"><FONT SIZE=+1>See <FONT COLOR="#008000"><A HREF="gdbStopping_and_starting_multithrea.html">Stopping
and starting multi-thread programs</A></FONT> for more information about
how GDB behaves when you stop and start programs with multiple threads.</FONT></FONT>
<BR><FONT FACE="Times New Roman"><FONT SIZE=+1>See <FONT COLOR="#008000"><A HREF="gdbSetting_watchpoints.html">Setting
watchpoints</A></FONT> for information about watchpoints in programs with
multiple threads.</FONT></FONT></UL>
</UL>

<HR SIZE=3 WIDTH="100%">
<CENTER><A HREF="#Top">Top</A>|<A HREF="gdb.html">Contents</A>|<A HREF="gdbindex.html">Index</A>|<A HREF="gdbAdditional_process_information.html">Previous</A>|<A HREF="gdbDebugging_programs_with_00000036.html">Next</A></CENTER>

</BODY>
</HTML>
