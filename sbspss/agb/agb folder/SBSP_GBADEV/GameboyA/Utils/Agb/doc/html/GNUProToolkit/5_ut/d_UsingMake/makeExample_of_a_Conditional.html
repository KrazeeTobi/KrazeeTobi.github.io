<HTML>
<HEAD>
   <META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-8859-1">
   <META NAME="GENERATOR" CONTENT="Mozilla/4.04 [en] (Win95; I) [Netscape]">
   <TITLE>Example of a Conditional</TITLE>
</HEAD>
<BODY>
<A NAME="Top"></A><A HREF="make.html">Contents</A>|<A HREF="makeindex.html">Index</A>|<A HREF="makeConditional_Parts_of_Makefiles.html">Previous</A>|<A HREF="makeSyntax_of_Conditionals.html">Next</A>
<BR><A NAME="off_1378715"></A><A NAME="e42210bb"></A><B><FONT FACE="Futura Md BT"><FONT SIZE=+3>Example
of a conditional</FONT></FONT></B>
<BR>
<HR SIZE=3 WIDTH="100%"><FONT FACE="Times New Roman"><FONT SIZE=+1>The
following example of a conditional tells </FONT></FONT><B><FONT FACE="Courier New"><FONT SIZE=+0>make</FONT></FONT></B><FONT FACE="Times New Roman"><FONT SIZE=+1>
to use one set of libraries if the </FONT></FONT><FONT FACE="Courier New"><FONT SIZE=+0>CC</FONT></FONT><FONT FACE="Times New Roman"><FONT SIZE=+1>
variable is ‘</FONT></FONT><FONT FACE="Courier New"><FONT SIZE=+0>gcc</FONT></FONT><FONT FACE="Times New Roman"><FONT SIZE=+1>’,
and a different set of libraries otherwise. It works by controlling which
of two command lines will be used as the command for a rule. The result
is that ‘</FONT></FONT><FONT FACE="Courier New"><FONT SIZE=+0>CC=gcc</FONT></FONT><FONT FACE="Times New Roman"><FONT SIZE=+1>’
as an argument to </FONT></FONT><B><FONT FACE="Courier New"><FONT SIZE=+0>make</FONT></FONT></B><FONT FACE="Times New Roman"><FONT SIZE=+1>
changes not only which compiler is used but also which libraries are linked.</FONT></FONT>
<BR>&nbsp;
<UL><FONT FACE="Courier New"><FONT SIZE=+0>libs_for_gcc = -lgnu</FONT></FONT>
<BR><FONT FACE="Courier New"><FONT SIZE=+0>normal_libs =</FONT></FONT>

<P><FONT FACE="Courier New"><FONT SIZE=+0>foo: $(objects)</FONT></FONT>
<BR><FONT FACE="Courier New"><FONT SIZE=+0>ifeq ($(CC),gcc)</FONT></FONT>
<BR><FONT FACE="Courier New"><FONT SIZE=+0>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
$(CC) -o foo $(objects) $(libs_for_gcc)</FONT></FONT>
<BR><FONT FACE="Courier New"><FONT SIZE=+0>else</FONT></FONT>
<BR><FONT FACE="Courier New"><FONT SIZE=+0>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
$(CC) -o foo $(objects) $(normal_libs)</FONT></FONT>
<BR><FONT FACE="Courier New"><FONT SIZE=+0>endif</FONT></FONT></UL>


<P><FONT FACE="Times New Roman"><FONT SIZE=+1>This conditional uses three
directives: one </FONT></FONT><FONT FACE="Courier New"><FONT SIZE=+0>ifeq</FONT></FONT><FONT FACE="Times New Roman"><FONT SIZE=+1>,
one </FONT></FONT><FONT FACE="Courier New"><FONT SIZE=+0>else</FONT></FONT><FONT FACE="Times New Roman"><FONT SIZE=+1>
and one </FONT></FONT><FONT FACE="Courier New"><FONT SIZE=+0>endif</FONT></FONT><FONT FACE="Times New Roman"><FONT SIZE=+1>.</FONT></FONT>

<P><FONT FACE="Times New Roman"><FONT SIZE=+1>The </FONT></FONT><FONT FACE="Courier New"><FONT SIZE=+0>ifeq</FONT></FONT><FONT FACE="Times New Roman"><FONT SIZE=+1>
directive begins the conditional, specifying the condition. It contains
two arguments, separated by a comma and surrounded by parentheses. Variable
substitution is performed on both arguments and then they are compared.
The lines of the makefile following the </FONT></FONT><FONT FACE="Courier New"><FONT SIZE=+0>ifeq</FONT></FONT><FONT FACE="Times New Roman"><FONT SIZE=+1>
are obeyed if the two arguments match; otherwise they are ignored.</FONT></FONT>

<P><FONT FACE="Times New Roman"><FONT SIZE=+1>The </FONT></FONT><FONT FACE="Courier New"><FONT SIZE=+0>else</FONT></FONT><FONT FACE="Times New Roman"><FONT SIZE=+1>
directive causes the following lines to be obeyed if the previous conditional
failed. In the example above, this means that the second alternative linking
command is used whenever the first alternative is not used. It is optional
to have an </FONT></FONT><FONT FACE="Courier New"><FONT SIZE=+0>else</FONT></FONT><FONT FACE="Times New Roman"><FONT SIZE=+1>
in a conditional.</FONT></FONT>

<P><FONT FACE="Times New Roman"><FONT SIZE=+1>The </FONT></FONT><FONT FACE="Courier New"><FONT SIZE=+0>endif</FONT></FONT><FONT FACE="Times New Roman"><FONT SIZE=+1>
directive ends the conditional. Every conditional must end with an </FONT></FONT><FONT FACE="Courier New"><FONT SIZE=+0>endif</FONT></FONT><FONT FACE="Times New Roman"><FONT SIZE=+1>.
Unconditional makefile text follows.</FONT></FONT>

<P><FONT FACE="Times New Roman"><FONT SIZE=+1>As the following example
illustrates, conditionals work at the textual level; the lines of the conditional
are treated as part of the makefile, or ignored, according to the condition.
This is why the larger syntactic units of the makefile, such as rules,
may cross the beginning or the end of the conditional.</FONT></FONT>

<P><FONT FACE="Times New Roman"><FONT SIZE=+1>When the variable, </FONT></FONT><FONT FACE="Courier New"><FONT SIZE=+0>CC</FONT></FONT><FONT FACE="Times New Roman"><FONT SIZE=+1>,
has the value ‘</FONT></FONT><FONT FACE="Courier New"><FONT SIZE=+0>gcc</FONT></FONT><FONT FACE="Times New Roman"><FONT SIZE=+1>’,
the previous example has this effect.</FONT></FONT>
<BR>&nbsp;
<UL><FONT FACE="Courier New"><FONT SIZE=+0>foo: $(objects)</FONT></FONT>
<BR><FONT FACE="Courier New"><FONT SIZE=+0>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
$(CC) -o foo $(objects) $(libs_for_gcc)</FONT></FONT></UL>


<P><FONT FACE="Times New Roman"><FONT SIZE=+1>When the variable, CC, has
any other value, it takes the following effect.</FONT></FONT>
<BR>&nbsp;
<UL><FONT FACE="Courier New"><FONT SIZE=+0>foo: $(objects)</FONT></FONT>
<BR><FONT FACE="Courier New"><FONT SIZE=+0>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
$(CC) -o foo $(objects) $(normal_libs)</FONT></FONT></UL>


<P><FONT FACE="Times New Roman"><FONT SIZE=+1>Equivalent results can be
obtained in another way by conditionalizing a variable assignment and then
using the variable unconditionally as in the following example.</FONT></FONT>
<BR>&nbsp;
<UL><FONT FACE="Courier New"><FONT SIZE=+0>libs_for_gcc = -lgnu</FONT></FONT>
<BR><FONT FACE="Courier New"><FONT SIZE=+0>normal_libs =</FONT></FONT>

<P><FONT FACE="Courier New"><FONT SIZE=+0>ifeq ($(CC),gcc)</FONT></FONT>
<BR><FONT FACE="Courier New"><FONT SIZE=+0>&nbsp; libs=$(libs_for_gcc)</FONT></FONT>
<BR><FONT FACE="Courier New"><FONT SIZE=+0>else</FONT></FONT>
<BR><FONT FACE="Courier New"><FONT SIZE=+0>&nbsp; libs=$(normal_libs)</FONT></FONT>
<BR><FONT FACE="Courier New"><FONT SIZE=+0>endif</FONT></FONT>

<P><FONT FACE="Courier New"><FONT SIZE=+0>foo: $(objects)</FONT></FONT>
<BR><FONT FACE="Courier New"><FONT SIZE=+0>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
$(CC) -o foo $(objects) $(libs)</FONT></FONT></UL>

<CENTER>
<HR SIZE=3 WIDTH="100%"></CENTER>

<CENTER><A HREF="#Top">Top</A>|<A HREF="make.html">Contents</A>|<A HREF="makeindex.html">Index</A>|<A HREF="makeConditional_Parts_of_Makefiles.html">Previous</A>|<A HREF="makeSyntax_of_Conditionals.html">Next</A></CENTER>

</BODY>
</HTML>
