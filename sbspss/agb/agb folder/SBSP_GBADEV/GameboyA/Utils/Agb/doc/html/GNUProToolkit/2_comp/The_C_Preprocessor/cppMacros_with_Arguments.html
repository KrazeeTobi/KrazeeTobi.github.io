<HTML>
<HEAD>
   <META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-8859-1">
   <META NAME="GENERATOR" CONTENT="Mozilla/4.04 [en] (Win95; I) [Netscape]">
   <TITLE>Macros with Arguments</TITLE>
</HEAD>
<BODY>
<A NAME="Top"></A><A HREF="cpp.html">Contents</A>|<A HREF="cppindex.html">Index</A>|<A HREF="cppSimple_Macros.html">Previous</A>|<A HREF="cppPredefined_Macros.html">Next</A>
<BR>&nbsp;<A NAME="off_231896"></A><A NAME="8db0859d"></A><A NAME="off_231896"></A><A NAME="8db0859d"></A><A NAME="off_231896"></A><A NAME="8db0859d"></A><A NAME="off_231896"></A><A NAME="8db0859d"></A><A NAME="off_231896"></A><A NAME="8db0859d"></A><A NAME="off_231896"></A><A NAME="8db0859d"></A><A NAME="off_231896"></A><A NAME="8db0859d"></A><A NAME="off_231896"></A><A NAME="8db0859d"></A><A NAME="off_231896"></A><A NAME="8db0859d"></A><A NAME="off_231896"></A><A NAME="8db0859d"></A><A NAME="off_231896"></A><A NAME="8db0859d"></A><A NAME="off_231896"></A><A NAME="8db0859d"></A><A NAME="off_231896"></A><A NAME="8db0859d"></A><A NAME="off_231896"></A><A NAME="8db0859d"></A><A NAME="off_231896"></A><A NAME="8db0859d"></A><FONT FACE="Futura Md BT"><FONT COLOR="#000000"><B><FONT SIZE=+3>Macros
with arguments&nbsp;</FONT></B>&nbsp;</FONT></FONT>
<HR SIZE=6 WIDTH="100%">
<BR><FONT FACE="Times New Roman"><FONT COLOR="#000000"><FONT SIZE=+1>A
simple macro always stands for exactly the same text, each time it is used.
Macros can be more flexible when they accept <I>arguments</I>. Arguments
are fragments of code that you supply each time the macro is used. These
fragments are included in the expansion of the macro according to the directions
in the macro definition. A macro that accepts arguments is called a <I>function-like
macro</I> because the syntax for using it looks like a function call.</FONT></FONT></FONT>

<P><FONT COLOR="#000000"><FONT FACE="Times New Roman"><FONT SIZE=+1>To
define a macro that uses arguments, you write a </FONT></FONT><FONT FACE="Courier New"><FONT SIZE=+0>#define</FONT></FONT><FONT FACE="Times New Roman"><FONT SIZE=+1>
directive with a list of <I>argument names</I> in parentheses after the
name of the macro. The argument names may be any valid C identifiers, separated
by commas and optionally whitespace. The open-parenthesis must follow the
macro name immediately, with no space in between. For example, here is
a macro that computes the minimum of two numeric values, as it is defined
in many C programs:</FONT></FONT></FONT>
<UL>
<PRE><FONT FACE="Courier New"><FONT SIZE=+1>#define min(X, Y) ((X) &lt; (Y) ? (X) : (Y))</FONT></FONT></PRE>
</UL>
<FONT FACE="Times New Roman"><FONT SIZE=+1><FONT COLOR="#000000">This is
not the best way to define a <I>minimum</I> macro in GNU C; see </FONT><FONT COLOR="#008000"><A HREF="cppDuplication_of_Side_Effects.html">Duplication
of side effects</A></FONT><FONT COLOR="#000000"> for more information.
To use a macro that expects arguments, you write the name of the macro
followed by a list of <I>actual arguments</I> in parentheses, separated
by commas. The number of actual arguments you give must match the number
of arguments the macro expects. Examples of use of the macro </FONT></FONT></FONT><FONT COLOR="#000000"><FONT FACE="Courier New"><FONT SIZE=+0>min</FONT></FONT><FONT FACE="Times New Roman"><FONT SIZE=+1>
include </FONT></FONT><FONT FACE="Courier New"><FONT SIZE=+0>min (1, 2)</FONT></FONT><FONT FACE="Times New Roman"><FONT SIZE=+1>
and </FONT></FONT><FONT FACE="Courier New"><FONT SIZE=+0>min (x + 28, *p)</FONT></FONT><FONT FACE="Times New Roman"><FONT SIZE=+1>.</FONT></FONT></FONT>

<P><FONT COLOR="#000000"><FONT FACE="Times New Roman"><FONT SIZE=+1>The
expansion text of the macro depends on the arguments you use. Each of the
argument names of the macro is replaced, throughout the macro definition,
with the corresponding actual argument. Using the same macro, </FONT></FONT><FONT FACE="Courier New"><FONT SIZE=+0>min</FONT></FONT><FONT FACE="Times New Roman"><FONT SIZE=+1>
(as defined in the previous input example), </FONT></FONT><FONT FACE="Courier New"><FONT SIZE=+0>min
(1, 2)</FONT></FONT><FONT FACE="Times New Roman"><FONT SIZE=+1> expands
into the following output.</FONT></FONT></FONT>
<UL>
<PRE><FONT FACE="Courier New"><FONT SIZE=+1>((1) &lt; (2) ? (1) : (2))</FONT></FONT></PRE>
</UL>
<FONT COLOR="#000000"><FONT FACE="Courier New"><FONT SIZE=+0>1</FONT></FONT><FONT FACE="Times New Roman"><FONT SIZE=+1>
has been substituted for </FONT></FONT><FONT FACE="Courier New"><FONT SIZE=+0>X</FONT></FONT><FONT FACE="Times New Roman"><FONT SIZE=+1>
and </FONT></FONT><FONT FACE="Courier New"><FONT SIZE=+0>2</FONT></FONT><FONT FACE="Times New Roman"><FONT SIZE=+1>
for </FONT></FONT><FONT FACE="Courier New"><FONT SIZE=+0>Y</FONT></FONT><FONT FACE="Times New Roman"><FONT SIZE=+1>.
Likewise, </FONT></FONT><FONT FACE="Courier New"><FONT SIZE=+0>min (x +
28, *p)</FONT></FONT><FONT FACE="Times New Roman"><FONT SIZE=+1> expands
into the following output.</FONT></FONT></FONT>
<UL>
<PRE><FONT FACE="Courier New"><FONT SIZE=+1>((x + 28) &lt; (*p) ? (x + 28) : (*p))</FONT></FONT></PRE>
</UL>
<FONT FACE="Times New Roman"><FONT COLOR="#000000"><FONT SIZE=+1>Parentheses
in the actual arguments must balance; a comma within parentheses does not
end an argument. However, there is no requirement for brackets or braces
to balance, and they do not prevent a comma from separating arguments.
Use the following input as an example.</FONT></FONT></FONT>
<UL>
<PRE><FONT FACE="Courier New"><FONT SIZE=+1>macro (array[x = y,x +1])</FONT></FONT></PRE>
</UL>
<FONT COLOR="#000000"><FONT FACE="Times New Roman"><FONT SIZE=+1>This passes
two arguments to </FONT></FONT><FONT FACE="Courier New"><FONT SIZE=+0>macro</FONT></FONT><FONT FACE="Times New Roman"><FONT SIZE=+1>:
</FONT></FONT><FONT SIZE=+0><FONT FACE="Courier New">array[x = y</FONT><FONT FACE="Times New Roman">’</FONT><FONT FACE="Courier New">
and </FONT><FONT FACE="Times New Roman">‘</FONT><FONT FACE="Courier New">x
+1]</FONT></FONT><FONT FACE="Times New Roman"><FONT SIZE=+1>. If you want
to supply </FONT></FONT><FONT FACE="Courier New"><FONT SIZE=+0>array[x
= y, x + 1]</FONT></FONT><FONT FACE="Times New Roman"><FONT SIZE=+1> as
an argument, you must write it as </FONT></FONT><FONT FACE="Courier New"><FONT SIZE=+0>array[(x
= y, x + 1)]</FONT></FONT><FONT FACE="Times New Roman"><FONT SIZE=+1>,
which is equivalent C code.</FONT></FONT></FONT>

<P><FONT COLOR="#000000"><FONT FACE="Times New Roman"><FONT SIZE=+1>After
the actual arguments are substituted into the macro body, the entire result
is appended to the front of the remaining input, and the check for macro
calls continues. Therefore, the actual arguments can contain calls to other
macros, either with or without arguments, or even to the same macro. The
macro body can also contain calls to other macros. For example, </FONT></FONT><FONT FACE="Courier New"><FONT SIZE=+0>min
(min (a, b), c)</FONT></FONT><FONT FACE="Times New Roman"><FONT SIZE=+1>
expands into the following output.</FONT></FONT></FONT>
<UL>
<PRE><FONT FACE="Courier New"><FONT SIZE=+1>((((a) &lt; (b) ? (a) : (b))) &lt; (c)&nbsp;
? (((a) &lt; (b) ? (a) : (b)))&nbsp;
: (c))</FONT></FONT></PRE>
</UL>
<FONT COLOR="#000000"><FONT FACE="Times New Roman"><FONT SIZE=+1>If a macro
</FONT></FONT><FONT FACE="Courier New"><FONT SIZE=+0>foo</FONT></FONT><FONT FACE="Times New Roman"><FONT SIZE=+1>
takes one argument, and you want to supply an empty argument, you must
write at least some whitespace between the parentheses, like this: </FONT></FONT><FONT FACE="Courier New"><FONT SIZE=+0>foo</FONT></FONT><FONT FACE="Times New Roman"><FONT SIZE=+1>
</FONT></FONT><FONT FACE="Courier New"><FONT SIZE=+0>(</FONT></FONT><FONT FACE="Times New Roman"><FONT SIZE=+1>
</FONT></FONT><FONT FACE="Courier New"><FONT SIZE=+0>)</FONT></FONT><FONT FACE="Times New Roman"><FONT SIZE=+1>.
Just </FONT></FONT><FONT FACE="Courier New"><FONT SIZE=+0>foo</FONT></FONT><FONT FACE="Times New Roman"><FONT SIZE=+1>
</FONT></FONT><FONT FACE="Courier New"><FONT SIZE=+0>()</FONT></FONT><FONT FACE="Times New Roman"><FONT SIZE=+1>
is providing no arguments, which is an error if </FONT></FONT><FONT FACE="Courier New"><FONT SIZE=+0>foo</FONT></FONT><FONT FACE="Times New Roman"><FONT SIZE=+1>
expects an argument. But </FONT></FONT><FONT FACE="Courier New"><FONT SIZE=+0>foo0</FONT></FONT><FONT FACE="Times New Roman"><FONT SIZE=+1>
</FONT></FONT><FONT FACE="Courier New"><FONT SIZE=+0>()</FONT></FONT><FONT FACE="Times New Roman"><FONT SIZE=+1>
is the correct way to call a macro defined to take zero arguments, like
the following example for input.</FONT></FONT></FONT>
<UL>
<PRE><FONT FACE="Courier New"><FONT SIZE=+1>#define foo0() : : :</FONT></FONT></PRE>
</UL>
<FONT FACE="Times New Roman"><FONT COLOR="#000000"><FONT SIZE=+1>If you
use the macro name followed by something other than an open-parenthesis
(after ignoring any spaces, tabs and comments that follow), it is not a
call to the macro, and the preprocessor does not change what you have written.
Therefore, it is possible for the same name to be a variable or function
in your program as well as a macro, and you can choose in each instance
whether to refer to the macro (if an actual argument list follows) or the
variable or function (if an argument list does not follow).</FONT></FONT></FONT>

<P><FONT COLOR="#000000"><FONT FACE="Times New Roman"><FONT SIZE=+1>Such
dual use of one name could be confusing and should be avoided except when
the two meanings are effectively synonymous: that is, when the name is
both a macro and a function and the two have similar effects. You can think
of the name simply as a function; use of the name for purposes other than
calling it (such as, to take the address) will refer to the function, while
calls will expand the macro and generate better but equivalent code. For
example, you can use a function named </FONT></FONT><FONT FACE="Courier New"><FONT SIZE=+0>min</FONT></FONT><FONT FACE="Times New Roman"><FONT SIZE=+1>
in the same source file that defines the macro. If you write </FONT></FONT><FONT FACE="Courier New"><FONT SIZE=+0>&amp;min</FONT></FONT><FONT FACE="Times New Roman"><FONT SIZE=+1>
with no argument list, you refer to the function. If you write </FONT></FONT><FONT FACE="Courier New"><FONT SIZE=+0>min
(x, bb)</FONT></FONT><FONT FACE="Times New Roman"><FONT SIZE=+1>, with
an argument list, the macro is expanded. If you write </FONT></FONT><FONT FACE="Courier New"><FONT SIZE=+0>(min)
(a, bb)</FONT></FONT><FONT FACE="Times New Roman"><FONT SIZE=+1>, where
the name </FONT></FONT><FONT FACE="Courier New"><FONT SIZE=+0>min</FONT></FONT><FONT FACE="Times New Roman"><FONT SIZE=+1>
is not followed by an open-parenthesis, the macro is not expanded, so you
wind up with a call to the function </FONT></FONT><FONT FACE="Courier New"><FONT SIZE=+0>min</FONT></FONT><FONT FACE="Times New Roman"><FONT SIZE=+1>.</FONT></FONT></FONT>

<P><FONT FACE="Times New Roman"><FONT COLOR="#000000"><FONT SIZE=+1>You
may not define the same name as both a simple macro and a macro with arguments.</FONT></FONT></FONT>

<P><FONT FACE="Times New Roman"><FONT COLOR="#000000"><FONT SIZE=+1>In
the definition of a macro with arguments, the list of argument names must
follow the macro name immediately with no space in between your input.
If there is a space after the macro name, the macro is defined as taking
no arguments, and all the rest of the line is taken to be the <I>expansion</I>.
The reason for this is that it is often useful to define a macro that takes
no arguments and whose definition begins with an identifier in parentheses.
This rule about spaces would use input like either one of the two following
examples.</FONT></FONT></FONT>
<UL>
<PRE><FONT FACE="Courier New"><FONT SIZE=+1>#define FOO(x) - 1 / (x)</FONT></FONT></PRE>
</UL>
<FONT COLOR="#000000"><FONT FACE="Times New Roman"><FONT SIZE=+1>The previous
example defines </FONT></FONT><FONT FACE="Courier New"><FONT SIZE=+0>FOO</FONT></FONT><FONT FACE="Times New Roman"><FONT SIZE=+1>
to take an argument and expand into minus the reciprocal of that argument.</FONT></FONT></FONT>

<P><FONT COLOR="#000000"><FONT FACE="Times New Roman"><FONT SIZE=+1>The
following example defines </FONT></FONT><FONT FACE="Courier New"><FONT SIZE=+0>BAR</FONT></FONT><FONT FACE="Times New Roman"><FONT SIZE=+1>
to take no argument and always expand into </FONT></FONT><FONT FACE="Courier New"><FONT SIZE=+0>(x)
-1 / (x)</FONT></FONT><FONT FACE="Times New Roman"><FONT SIZE=+1>).</FONT></FONT></FONT>
<UL>
<PRE><FONT FACE="Courier New"><FONT SIZE=+1>#define BAR (x) - 1 / (x)</FONT></FONT></PRE>

<DT>
<FONT FACE="Times New Roman"><FONT SIZE=+1><I>Note</I>:</FONT></FONT></DT>

<BR><FONT FACE="Times New Roman"><FONT SIZE=+1>The uses of a macro with
arguments can have spaces before the left parenthesis; it’s the <I>definition</I>
where it matters whether there is a space.</FONT></FONT></UL>

<HR SIZE=3 WIDTH="100%">
<CENTER><A HREF="#Top">Top</A>|<A HREF="cpp.html">Contents</A>|<A HREF="cppindex.html">Index</A>|<A HREF="cppSimple_Macros.html">Previous</A>|<A HREF="cppPredefined_Macros.html">Next</A></CENTER>

</BODY>
</HTML>
