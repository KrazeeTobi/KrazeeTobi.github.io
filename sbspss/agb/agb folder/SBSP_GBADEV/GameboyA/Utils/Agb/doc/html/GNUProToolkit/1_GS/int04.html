<!doctype html public "-//w3c//dtd html 4.0 transitional//en">
<html>
<head>
   <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
   <meta name="GENERATOR" content="Mozilla/4.51 [en] (Win95; I) [Netscape]">
   <title> Using GNU tools on embedded systems</title>
</head>
<body bgcolor="#FFFFFF">

<div CLASS="ChapterTitle"><a NAME="Top"></a><a href="gsTOC.html">Contents</a>|<a href="int03.html">Previous</a>|<a href="int05.html">Next</a></div>

<div CLASS="ChapterTitle"><a NAME="pgfId=1003010"></a><a NAME="10316"></a><font face="Futura Md BT"><font color="#000000"><font size=+3>Using
GNU tools&nbsp;</font></font></font>
<hr SIZE=6 WIDTH="100%"></div>

<div CLASS="BodyAfterHead"><a NAME="pgfId=1008774"></a><font size=+1>The
following seven GNUPro Toolkit tools can be run on native <b><i>and</i></b>
embedded<a NAME="marker=1008773"></a> targets.</font>
<ul TYPE=SQUARE>
<li>
<a NAME="pgfId=1008780"></a><font size=+1><tt>gcc<a NAME="marker=1008775"></a></tt>,
the GNUPro Toolkit compiler&nbsp;<a NAME="marker=1008776"></a>(see <a href="#gcc,_the_GNU_compiler"><tt>gcc</tt>,
the GNU compiler</a>)</font></li>

<li>
<a NAME="pgfId=1008784"></a><font size=+1><tt>cpp</tt>, the GNU C preprocessor
(see <a href="#cpp,_the_GNU_compiler"><tt>cpp</tt>, the GNU preprocessor</a>)</font></li>

<li>
<a NAME="pgfId=1008790"></a><font size=+1><tt>gas<a NAME="marker=1008785"></a></tt>,
the GNUPro Toolkit assembler&nbsp;<a NAME="marker=1008786"></a>(see <a href="#gas,_the_GNU_assembler"><tt>gas</tt>,
the GNU assembler</a>)</font></li>

<li>
<a NAME="pgfId=1008796"></a><font size=+1><tt>ld<a NAME="marker=1008791"></a></tt>,
the GNUPro Toolkit linker&nbsp;<a NAME="marker=1008792"></a>(see <a href="#ld,_the_GNU_linker"><tt>ld</tt>,
the GNU linker</a>)</font></li>

<li>
<a NAME="pgfId=1008801"></a><font size=+1><tt>binutils<a NAME="marker=1008797"></a></tt>,
the GNUPro Toolkit directory of utilities&nbsp;<a NAME="marker=1008798"></a>(see
<a href="#binutils,_the_GNU_binary_utilities"><tt>binutils</tt>,
the GNU binary utilities</a>)</font></li>

<li>
<a NAME="pgfId=1008808"></a><font size=+1><tt>gdb<a NAME="marker=1008803"></a></tt>,
the GNUPro Toolkit debugger&nbsp;<a NAME="marker=1008804"></a>(see <a href="#gdb,_the_debugging_tool"><tt>gdb</tt>,
the debugging tool</a>)</font></li>

<li>
<font size=+1>Cygnus Insight</font><sup><font size=-2>TM</font></sup><font size=+1>
(see <a href="#Insight">Cygnus Insight, a visual debugger</a>)</font></li>

<li>
<font size=+1>Cygwin</font><sup><font size=-2>TM</font></sup><font size=+1>,
the Win32 porting layer for UNIX applications (see
<a href="#Cygwin">Cygwin:
a Win32 porting layer for UNIX applications</a>)</font></li>

<li>
<a NAME="pgfId=1008813"></a><font size=+1><tt>libgloss<a NAME="marker=1008809"></a></tt>,
the support library<a NAME="marker=1008810"></a> for embedded targets and
<tt>newlib<a NAME="marker=1008811"></a></tt>,
the C library<a NAME="marker=1008812"></a> developed by Cygnus (see <a href="#libgloss,_newlib_and_libstd++,_the GNU_libraries" CLASS="XRef"><tt>newlib</tt>
and <tt>libstdc++</tt>, the GNU libraries</a>)</font></li>

<li>
<font size=+1><tt>snavigator</tt>, or <a href="int04.html#SN1">Source-Navigator</a>,
a source code comprehension tool</font></li>
</ul>
</div>

<div CLASS="Body"><a NAME="pgfId=1008817"></a><font size=+1>See the following
documentation for more discussion on using the GNU tools. See also <a href="int04.html">Using
the tools on native and embedded systems</a> and <b><i><a href="../6_embed/emb.html">GNUPro
Tools for Embedded Systems</a></i></b>.</font>
<ul TYPE=SQUARE>
<li>
<a NAME="pgfId=1008821"></a><font size=+1><a href="#Invoking_the_GNU_tools" CLASS="XRef">Invoking
the GNU tools</a></font></li>

<li>
<font size=+1><a href="#xdev_env">Cross-development environment</a></font></li>

<li>
<a NAME="pgfId=1008825"></a><font size=+1><a href="#crt0,_the_main_startup_file" CLASS="XRef"><tt>crt0</tt>,
the main startup file</a></font></li>

<li>
<a NAME="pgfId=1008829"></a><font size=+1><a href="#The_linker_script" CLASS="XRef">The
linker script</a></font></li>

<li>
<a NAME="pgfId=1008833"></a><font size=+1><a href="#I/O_support_code" CLASS="XRef">I/O
support code</a></font></li>

<li>
<a NAME="pgfId=1008837"></a><font size=+1><a href="#Memory_support" CLASS="XRef">Memory
support</a></font></li>

<li>
<a NAME="pgfId=1008841"></a><font size=+1><a href="#Miscellaneous_support_routines" CLASS="XRef">Miscellaneous
support routines</a></font></li>

<li>
<font size=+1><a href="int04.html#SN" CLASS="XRef">Source-Navigator demonstration</a></font></li>

<li>
<font size=+1><a href="int05.html">Cygnus glossary</a></font></li>

<li>
<font size=+1><a href="int06.html">Working with Cygnus Insight</a></font></li>

<li>
<font size=+1><a href="GPL.html">Rebuilding from source</a></font></li>
</ul>
</div>

<h3 CLASS="Heading1">
<a NAME="pgfId=1008844"></a><a NAME="_Toc390660103"></a><a NAME="_Toc399635428"></a></h3>

<div CLASS="Heading1"><a NAME="Invoking_the_GNU_tools"></a><b><i><font face="Times New Roman,Times"><font size=+2>Invoking
the GNU tools</font></font></i></b></div>

<div CLASS="Body">
<ul TYPE=SQUARE><a NAME="pgfId=1008845"></a><font size=+1><tt>gcc</tt>
invokes all the required GNU passes for you with the following utilities.</font>
<ul TYPE=SQUARE>
<li>
<a NAME="pgfId=1008847"></a><tt><font size=+1>cpp</font></tt></li>

<br><a NAME="marker=1008846"></a><font size=+1>The preprocessor which processes
all the header files and macros that your target requires.</font>
<li>
<a NAME="pgfId=1009318"></a><tt><font size=+1>gcc</font></tt></li>

<br><a NAME="marker=1008848"></a><font size=+1>The compiler which produces
assembly language code from the processed C files. For more information,
see <i><a href="../2_comp/Using_GNU_CC/gcc.html">Using GNU CC</a></i> in
<b><i>GNUPro
Compiler Tools</i></b>.</font>
<li>
<a NAME="pgfId=1008849"></a><tt><font size=+1>gas</font></tt></li>

<br><a NAME="marker=1008850"></a><font size=+1>The assembler which produces
binary code from the assembly language code and puts it in an object file.</font>
<li>
<a NAME="pgfId=1008853"></a><tt><font size=+1>ld</font></tt></li>

<br><a NAME="marker=1008852"></a><font size=+1>The linker which binds the
code to addresses, links the startup file and libraries to the object file,
and produces the executable binary image.</font></ul>
</ul>
</div>

<div CLASS="Body">
<ul>
<h3 CLASS="Heading2">
<a NAME="pgfId=1008860"></a><a NAME="_Toc385737436"></a><a NAME="_Toc390660104"></a><a NAME="_Toc399635429"></a></h3>

<div CLASS="Heading2"><a NAME="gcc,_the_GNU_compiler"></a><b><font size=+2><tt>gcc</tt><i><font face="Times New Roman,Times">,
the GNU compiler</font></i></font></b></div>

<p><br><font size=+1>When you compile C or C++ programs with GNU C, the
compiler quietly inserts a call at the beginning of main to a <tt>gcc</tt>
support subroutine called <tt>__main</tt>. Normally this is invisible—you
may run into it if you want to avoid linking to the standard libraries,
by specifying the <tt>-nostdlib </tt>compiler option. Include <tt>-lgcc</tt>
at the end of your compiler command line to resolve this reference. This
links with the <tt>libgcc.a </tt>compiler support library. Putting it at
the end of your command line ensures that you have a chance to link first
with any of your own special libraries.</font>
<p><font size=+1><tt>__main</tt> is the initialization routine for C++
constructors. Because GNU&nbsp; C is designed to interoperate with&nbsp;
GNU&nbsp; C++, even C programs must have this call: otherwise C++ object
files linked with a C main might fail.&nbsp; For&nbsp; more information
on gcc, see <i><a href="../2_comp/Using_GNU_CC/gcc.html">Using GNU CC</a></i>
in <b><i>GNUPro Compiler Tools</i></b>.</font></ul>
</div>

<div CLASS="Body">
<ul>
<div CLASS="Body"><a NAME="pgfId=1008855"></a><font size=+1>There are several
machine-independent compiler switches<a NAME="marker=1008854"></a>, among
which are, notably,
<tt>-fno-exceptions</tt> (for C++), <tt>-fritti</tt>
(for C++) and <tt>-T</tt> (for linking).</font></div>

<div CLASS="Body"><a NAME="pgfId=1008856"></a><font size=+1>You have four
implicit file extensions: <tt>.c</tt> , <tt>.C</tt> , <tt>.s</tt> , and
<tt>.S</tt>.
For more information, see <i><a href="../2_comp/Using_GNU_CC/gcc.html">Using
GNU CC</a></i> in <b><i>GNUPro Compiler Tools</i></b>.</font>
<ul>&nbsp;</ul>
</div>
</ul>
</div>

<h4 CLASS="Heading2">
<a NAME="pgfId=1008868"></a><a NAME="_Toc385737437"></a><a NAME="_Toc390660105"></a><a NAME="_Toc399635430"></a></h4>

<div CLASS="Heading2"><a NAME="cpp,_the_GNU_compiler"></a><font size=+2><tt>cpp</tt><b><i><font face="Times New Roman,Times">,
the GNU preprocessor</font></i></b></font></div>

<div CLASS="Body"><a NAME="pgfId=1008875"></a><font size=+1><tt>cpp</tt>
merges in the <tt>#include</tt> files<a NAME="marker=1008874"></a>, expands
all macros definitions, and processes the <tt>#ifdef</tt> sections. To
see the output of <tt>cpp</tt>, invoke <tt>gcc</tt> with the <tt>-E</tt>
option<a NAME="marker=1008876"></a>, and the preprocessed file will be
printed on <tt>stdout<a NAME="marker=1008877"></a></tt>.</font></div>

<div CLASS="Body"><a NAME="pgfId=1008878"></a><font size=+1>There are two
convenient options to assemble handwritten files that require C-style preprocessing<a NAME="marker=1008879"></a>.
Both options depend on using the compiler driver program, <tt>gcc</tt>,
instead of calling the assembler directly.</font>
<ul TYPE=SQUARE>
<ul TYPE=SQUARE>
<li>
<font size=+1>&nbsp;</font>&nbsp;<a NAME="pgfId=1008880"></a><font size=+1>Name
the source file using the extension <tt>.S</tt> (capitalized) rather than
<tt>.s</tt>.
<tt>gcc</tt>
recognizes files with this extension as assembly language requiring C-style
preprocessing.</font></li>

<li>
<a NAME="pgfId=1008881"></a><font size=+1>Specify the "source language"
explicitly for this situation, using the <tt>gcc</tt> option, <tt>-xassembler-with-cpp</tt>
.</font></li>
</ul>
</ul>
</div>

<div CLASS="Body"><a NAME="pgfId=1009336"></a><font size=+1>For more information
on <tt>cpp</tt>, see <i><a href="../2_comp/The_C_Preprocessor/cpp.html">The
C Preprocessor</a></i> in <b><i>GNUPro Compiler Tools</i></b>.</font></div>

<h4 CLASS="Heading2">
<a NAME="pgfId=1008882"></a><a NAME="_Toc385737438"></a><a NAME="_Toc390660106"></a><a NAME="_Toc399635431"></a></h4>

<div CLASS="Heading2"><a NAME="gas,_the_GNU_assembler"></a><font size=+2><tt>gas</tt><b><i><font face="Times New Roman,Times">,
the GNU assembler</font></i></b></font></div>

<div CLASS="Body">
<ul><a NAME="pgfId=1008888"></a><font size=+1><tt>gas</tt> can be useful
as either a compiler pass or a source-level assembler<a NAME="marker=1008887"></a>.&nbsp;<a NAME="pgfId=1008891"></a><tt>gas</tt>
emits a relocatable object file<a NAME="marker=1008890"></a> from the assembly
language source code. The object file contains the binary code and the
debug symbols.&nbsp;<a NAME="pgfId=1009341"></a>For more information on
<tt>gas</tt>,
see <a href="../5_ut/a_Using_AS/as.html"><i>Using </i><tt>as</tt></a> in
<b><i>GNUPro
Utilities</i></b>.</font></ul>
</div>

<h4 CLASS="Heading2">
<a NAME="pgfId=1008892"></a><a NAME="_Toc385737439"></a><a NAME="_Toc390660107"></a><a NAME="_Toc399635432"></a></h4>

<div CLASS="Heading2"><a NAME="ld,_the_GNU_linker"></a><font size=+2><tt>ld</tt><b><i><font face="Times New Roman,Times">,
the GNU linker</font></i></b></font></div>

<div CLASS="Body"><a NAME="pgfId=1008898"></a><font size=+1><tt>ld<a NAME="marker=1008897"></a></tt>resolves
the code addresses and debug symbols, links the startup code and additional
libraries to the binary code, and produces an executable binary<a NAME="marker=1008899"></a>
image.&nbsp;<a NAME="pgfId=1009346"></a>For more information on <tt>ld</tt>,
see <a href="../5_ut/b_Usingld/ld.html"><i>Using</i> <tt>ld</tt></a> in
<b><i>GNUPro
Utilities</i></b>.</font></div>

<ul>&nbsp;</ul>

<h4 CLASS="Heading2">
<a NAME="pgfId=1008905"></a><a NAME="_Toc385737441"></a><a NAME="_Toc390660108"></a><a NAME="_Toc399635433"></a></h4>

<h3 CLASS="Heading2">
<a NAME="binutils,_the_GNU_binary_utilities"></a><font size=+2><tt>binutils</tt><b><i><font face="Times New Roman,Times">,
the GNU binary utilities</font></i></b></font></h3>

<div CLASS="Body"><a NAME="pgfId=1008912"></a><font size=+1>The following
are the binary utilities<a NAME="marker=1008911"></a>, although they are
not included on all hosts: <tt>ar</tt>, <tt>nm</tt>, <tt>objcopy</tt>,
<tt>objdump</tt>,
<tt>ranlib</tt>,
<tt>size</tt>,
<tt>strings</tt>,
and
<tt>strip</tt>.</font></div>

<div CLASS="Body"><a NAME="pgfId=1009356"></a><font size=+1>For more information
on the GNU binary utilities, see <a href="../5_ut/c_Usingbinutils/bin.html#Top"><i>Using
</i><tt>binutils</tt></a>
in <b><i>GNUPro Utilities</i></b>.</font>
<p><a NAME="pgfId=1008913"></a><font size=+1>The most important of these
utilities are <tt><a href="#objcopy">objcopy<a NAME="marker=1008914"></a></a></tt>
and
<tt><a href="#objdump">objdump<a NAME="marker=1008915"></a></a></tt>.</font></div>

<ul TYPE=SQUARE>
<li CLASS="BodyHang1">
&nbsp;<a NAME="pgfId=1008917"></a><a NAME="objcopy"></a><b><tt><font size=+1>objcopy</font></tt></b></li>
</ul>

<ul><font size=+1>A few ROM monitors<a NAME="marker=1008918"></a>, such
as <tt>a.out<a NAME="marker=1008919"></a></tt>, load executable binary
images, and, consequently, most load an S-record. An S-record is a printable
ASCII representation of an executable binary image.</font></ul>

<ul>
<div CLASS="BodyListFollow"><a NAME="pgfId=1008920"></a><font size=+1>S-records
are suitable both for building ROM images for standalone boards and for
downloading images to embedded systems. Use the following example's input
for this process.</font></div>

<ul>
<div CLASS="CodeExample"><a NAME="pgfId=1008921"></a><tt><font size=+1>objcopy
-O srec <i>infile</i> <i>outfile</i></font></tt></div>
</ul>

<div CLASS="BodyListFollow"><a NAME="pgfId=1008922"></a><font size=+1><i><tt>infile</tt></i>
in the previous example's input is the executable binary filename, and
<i><tt>outfile</tt></i>
is the filename for the S-record.</font></div>

<div CLASS="BodyListFollow"><a NAME="pgfId=1008924"></a><font size=+1>Most
PROM burners<a NAME="marker=1008923"></a> also read S-records or some similar
format. Use the following example's input to get a list of supported object
file types for your architecture.</font></div>

<ul>
<div CLASS="CodeExample"><a NAME="pgfId=1008925"></a><tt><font size=+1>objdump
-i</font></tt></div>
</ul>

<div CLASS="BodyListFollow"><a NAME="pgfId=1009361"></a><font size=+1>For
more information on S-records<a NAME="marker=1008926"></a>, see the discussions
for <tt>FORMAT <i>output-format&nbsp;<a NAME="marker=1008928"></a></i></tt>in
the documentation for <a href="../5_ut/b_Usingld/ldMRI_Compatible_Script_Files.html">MRI
compatible script files</a> and the discussion for <a href="../5_ut/b_Usingld/ldBFD.html">BFD</a>
in <a href="../5_ut/b_Usingld/ld.html"><i>Using</i> <tt>ld</tt></a> in&nbsp;
<b><i>GNUPro Utilities</i></b>. For more discussion of making an executable
binary image<a NAME="marker=1008929"></a>, see <tt><a href="../5_ut/c_Usingbinutils/binobjcopy.html">objcopy</a></tt>
in <a href="../5_ut/c_Usingbinutils/bin.html"><i>Using </i><tt>binutils</tt></a>
in <b><i>GNUPro Utilities</i></b>.</font></div>
</ul>

<ul TYPE=SQUARE>
<li CLASS="BodyHang1">
&nbsp;<a NAME="pgfId=1008927"></a><a NAME="objdump"></a><tt><font size=+1>objdump</font></tt></li>
</ul>

<ul><font size=+1><tt>objdump</tt> displays information about one or more
object files. The options control what particular information to display.
This information is mostly useful to programmers who are working on the
compilation tools, as opposed to programmers who just want their program
to compile and work.</font></ul>

<ul>
<div CLASS="BodyListFollow"><a NAME="pgfId=1008931"></a><font size=+1>When
specifying archives, <tt>objdump</tt> shows information on each of the
member object files. <tt>objfile...</tt> designates the object files to
be examined.</font></div>

<div CLASS="Body"><a NAME="pgfId=1008934"></a><font size=+1>A few of the
more useful options for commands are: <tt>-d<a NAME="marker=1008932"></a></tt>,
<tt>-disassemble<a NAME="marker=1008933"></a></tt>and
<tt>--prefix-addresses<a NAME="marker=1008935"></a></tt>.</font></div>

<div CLASS="BodyHang1"><a NAME="pgfId=1008936"></a><tt><font size=+1>-d</font></tt></div>

<div CLASS="BodyHang1List"><a NAME="pgfId=1008937"></a><tt><font size=+1>--disassemble</font></tt></div>

<ul><font size=+1>Displays the assembler mnemonics for the machine instructions
from <i><tt>objfile</tt></i>. This option only disassembles those sections
that are expected to contain instructions.</font></ul>

<div CLASS="BodyHang1"><a NAME="pgfId=1008938"></a><tt><font size=+1>--prefix-addresses</font></tt></div>

<ul><font size=+1>For disassembling, prints the complete address on each
line, starting each output line with the address it's disassembling. This
is the older disassembly format. Otherwise, you only get raw opcodes.</font></ul>
</ul>

<h4 CLASS="Heading2">
<a NAME="pgfId=1008942"></a><a NAME="_Toc385737442"></a><a NAME="_Toc390660109"></a><a NAME="_Toc399635434"></a></h4>

<h3 CLASS="Heading2">
<a NAME="gdb,_the_debugging_tool"></a><font size=+2><tt>gdb</tt><b><i><font face="Times New Roman,Times">,
the debugging tool</font></i></b></font></h3>

<div CLASS="Body"><a NAME="pgfId=1008944"></a><font size=+1>To run <tt>gdb<a NAME="marker=1008943"></a></tt>on
an embedded target, use <a href="#Insight">Cygnus Insight</a>, or use a
<tt>gdb</tt>
backend with the <tt>gdb</tt> standard remote protocol or a similar protocol,
the following two types of <tt>gdb</tt> backend being the most common.</font>
<ul TYPE=SQUARE>&nbsp;
<ul TYPE=SQUARE>
<li>
<a NAME="pgfId=1008946"></a><b><font size=+1><i>A </i><tt>gdb</tt><i> stub</i></font></b><a NAME="marker=1008945"></a></li>

<br><font size=+1>This is an exception handler for breakpoints<a NAME="marker=1008947"></a><a NAME="marker=1008948"></a>,
and it must be linked to your application. <tt>gdb</tt> stubs use the <tt>gdb</tt>
standard remote protocol.</font>
<li>
<a NAME="pgfId=1008949"></a><b><font size=+1><i>An existing ROM monitor
used as a </i><tt>gdb</tt><i> backend</i></font></b></li>

<br><font size=+1>The most common approach means using the following processes.</font>
<ul TYPE=SQUARE>
<li>
<a NAME="pgfId=1008950"></a><font size=+1>With a similar protocol to the
<tt>gdb</tt>
standard remote protocol.</font></li>

<li>
<a NAME="pgfId=1008952"></a><font size=+1>With an interface that uses the
ROM monitor<a NAME="marker=1008951"></a> directly. With such an interface,
<tt>gdb</tt>
only formats and parses commands.</font></li>
</ul>
</ul>
</ul>
</div>

<div CLASS="Body"><a NAME="pgfId=1009366"></a><font size=+1>For more information
on debugging tools, see <i><a href="../3_dbug/b_Debugging_with_GDB/gdb.html">Debugging
with GDB</a></i> in <b><i>GNUPro Debugging Tools</i></b> and <a href="int06.html">Working
with Cygnus Insight, the visual debugger</a>.</font></div>

<div CLASS="Heading2"><a NAME="pgfId=1008953"></a><a NAME="_Toc385737443"></a><a NAME="_Toc390660110"></a><a NAME="_Toc399635435"></a><a NAME="Useful_debugging_routines"></a><a NAME="pgfId=1008959"></a><font size=+1>The
following routines are always useful for debugging<a NAME="marker=1008958"></a>
a project in progress.</font></div>

<div CLASS="Body">
<ul TYPE=SQUARE>
<ul TYPE=SQUARE>
<li>
<a NAME="pgfId=1008961"></a><tt><font size=+1>print()</font></tt></li>

<br><a NAME="marker=1008960"></a><font size=+1>Runs standalone in <tt>libgloss<a NAME="marker=1008962"></a></tt>with
no <tt>newlib<a NAME="marker=1008963"></a></tt>support. Many times
<tt>print()</tt>
works when there are problems that make <tt>printf()</tt> cause an exception.</font>
<li>
<a NAME="pgfId=1008965"></a><tt><font size=+1>outbyte()</font></tt></li>

<br><a NAME="marker=1008964"></a><font size=+1>Used for low-level debugging<a NAME="marker=1008966"></a>.</font>
<li>
<a NAME="pgfId=1008968"></a><tt><font size=+1>putnum()</font></tt></li>

<br><a NAME="marker=1008967"></a><font size=+1>Prints out values in hex<a NAME="marker=1008969"></a>
so they are easier to read.</font></ul>
</ul>
</div>

<h3 CLASS="Heading2">
<a NAME="Insight"></a><i><font size=+2>Cygnus Insight, a visual debugger</font></i></h3>

<div CLASS="Heading2"><font size=+1>GNUPro Toolkit provides the technology
and tools for effective, efficient debugging sessions with the standard
command-line based debugger, gdb. Also available is Cygnus Insight, a visual
debugger with a graphical user interface supporting a range of host systems
and target microprocessors, allowing development with complete access to
the program state, including source and assembly level, variables, registers
and memory.</font></div>

<div CLASS="Heading2"><font size=+1>Insight adds a series of intuitive
views into the debug process, and provides the developer with a wide range
of system information.</font></div>

<div CLASS="Heading2"><font size=+1>For more information on developing
with Insight, see <a href="int06.html">Working with Cygnus Insight, the
visual debugger</a>.</font></div>

<h3 CLASS="Heading2">
<a NAME="SN1"></a><i><font size=+2>Source-Navigator, a source code comprehension
tool</font></i></h3>

<div CLASS="Heading2"><font size=+1>Source Navigator is a source code comprehension
tool with which developers can extract information from existing code in
C, C++, Java, Tcl, <tt>[incr tcl]</tt> (the C++ extension for Tcl), FORTRAN,
Cobol, and assembly programs, using this information to build project databases.
The database represents internal program structures and relationships between
program components. Source Navigator then uses this database to query symbols
and relationships between components and graphically display them. Initialize
the Source-Navigator tool from a commandline interface by invoking the
following command:</font></div>

<blockquote>
<pre CLASS="Heading2"><font size=+1>snavigator</font></pre>
</blockquote>

<div CLASS="Heading2"><font size=+1>For a demonstration of using Source-Navigator,
see <a href="#SN">Source-Navigator demonstration</a>. For more information
on Source Navigator, see the main “<b><i>User’s Reference Guide</i></b>”
and “<b><i>Programmer’s Reference Guide</i></b>” documentation, accessible
by clicking on the </font><font face="Arial,Helvetica">Help</font><font size=+1>
menu’s </font><font face="Arial,Helvetica">Contents</font><font size=+1>
menu item while working with Source-Navigator.</font></div>

<h4 CLASS="Heading2">
<a NAME="pgfId=1008973"></a><a NAME="_Toc385737444"></a><a NAME="_Toc390660111"></a><a NAME="_Toc399635436"></a></h4>

<h3 CLASS="Heading2">
<a NAME="libgloss,_newlib_and_libstd++,_the GNU_libraries"></a><font size=+2><tt>newlib</tt><b><i><font face="Times New Roman,Times">
and </font></i></b><tt>libstdc++</tt><b><i><font face="Times New Roman,Times">,
the GNU libraries</font></i></b></font></h3>

<div CLASS="Body"><a NAME="pgfId=1009379"></a><font size=+1>GNUPro Toolkit
has the following libraries<a NAME="marker=1008974"></a>: <tt>newlib<a NAME="marker=1008976"></a></tt>and
<tt>libstdc++</tt>.</font></div>

<ul TYPE=SQUARE>
<ul TYPE=SQUARE>
<ul TYPE=SQUARE>
<li CLASS="BodyHang1">
<font size=+1>&nbsp;<a NAME="pgfId=1008998"></a><tt>newlib</tt></font></li>

<br><font size=+1>The Cygnus libraries, including the C library<a NAME="marker=1008999"></a>,
<tt>libc<a NAME="marker=1009000"></a></tt>,
and the C math library<a NAME="marker=1009001"></a>, <tt>libm<a NAME="marker=1009002"></a></tt>.</font></ul>
</ul>
</ul>

<ul>
<ul>
<ul>
<li>
<font size=+1>&nbsp;<a NAME="pgfId=1009003"></a><tt>libstdc++</tt></font></li>

<br><font size=+1>The C++ library.</font></ul>
</ul>
</ul>

<div CLASS="Heading1"><a NAME="Cygwin"></a><b><i><font size=+2>Cygwin</font></i><sup><font size=-2>TM</font></sup><i><font size=+2>:
a Win32 porting layer for UNIX applications</font></i></b></div>

<div CLASS="Heading1"><font size=+1>Cygwin</font><sup><font size=-2>TM</font></sup><font size=+1>,
a full-featured Win32 porting layer for UNIX applications, is compatible
with all Win32 hosts (currently, these are Microsoft’s Windows NT/95/98
systems). See <b><i><a href="../6_embed/emb.html">GNUPro Tools for Embedded
Systems</a></i></b> to locate the following documentation, which discusses
porting the GNU development tools to the Win32 host while exploring the
development and architecture of the Cygwin library.</font></div>

<ul TYPE=SQUARE>
<div CLASS="Heading1">
<blockquote>
<li>
<font size=+1><a href="../6_embed/embCygwin.html#Setting_up">Setting up
Cygwin</a></font></li>

<li>
<font size=+1><a href="../6_embed/embCygwin.html#Porting_tools_to_Win32">Porting
UNIX tools to Win32</a></font></li>

<li>
<font size=+1><a href="../6_embed/embCygwin.html#Initial_goals_Cygwin">Initial
goals of Cygwin</a></font></li>

<li>
<font color="#FF6666"><font size=+1><a href="../6_embed/embCygwin.html#Compatibility">Compatibility
issues with Cygwin</a></font></font></li>

<li>
<font color="#000000"><font size=+1><a href="../6_embed/embCygwin.html#Using_GCC">Using
GCC with Cygwin</a></font></font></li>

<li>
<font color="#FF6666"><font size=+1><a href="../6_embed/embCygwin.html#Debugging">Debugging
Cygwin programs</a></font></font></li>

<li>
<font color="#FF6666"><font size=+1><a href="../6_embed/embCygwin.html#Building_Using_dlls">Building
and using DLLs with Cygwin</a></font></font></li>

<li>
<font color="#FF6666"><font size=+1><a href="../6_embed/embCygwin.html#Defining_resources">Defining
Windows resources for Cygwin</a></font></font></li>

<li>
<font size=+1><a href="../6_embed/embCygwin.html#Utils">Cygwin utilities</a></font></li>

<li>
<font size=+1><a href="../6_embed/embCygwin.html#Functions">Cygwin functions</a></font></li>
</blockquote>
</div>
</ul>

<div CLASS="Heading1"><font size=+1>Cygwin was invented in 1995 by Cygnus
as part of the answer to the question of how to port the GNU development
tools to a Win32 host. The Win32-hosted GNUPro compiler tools that use
the Cygwin library are available for a variety of embedded processors as
well as a native version for writing Win32 applications.</font></div>

<h1 CLASS="Heading1">
<a NAME="xdev_env"></a><br>
<i><font size=+2>Cross-development environment</font></i></h1>

<div CLASS="Heading1"><font size=+1>Using GNUPro Toolkit in one of the
cross-development configurations usually requires some attention to setting
up the target environment.</font></div>

<div CLASS="Heading1"><font size=+1>A cross-development configuration can
develop software for a different target machine than the development tools
themselves (which run on the host)—for example, a SPARCstation can generate
and debug code for a Motorola Power PC-based board. This process is known
as <i>embedded</i> development.</font></div>

<div CLASS="Heading1"><font size=+1>For GNUPro tools to work with a target
environment (except for real-time operating systems, which provide full
operating system support), set up the tools with the help of the following
documentation.</font></div>

<ul TYPE=SQUARE>
<li CLASS="Heading1">
<font size=+1>To set up the C run-time environment, see <a href="#crt0,_the_main_startup_file"><tt>crto</tt>,
the main startup file</a> and <a href="#crt0">The C run-time environment
(<tt>crt0</tt>)</a>.</font></li>

<li CLASS="Heading1">
<font size=+1>To create stubs, or minimal versions of operating system
subroutines for the C subroutine library, see <a href="../4_libs/a_GNUPro_C_Library/libcSystem_Calls.html">System
calls</a> in <i>GNUPro C Library</i> in <b><i>GNUPro Libraries</i></b>.</font></li>

<li CLASS="Heading1">
<font size=+1>To understand the connection to the debugger, see <a href="../3_dbug/b_Debugging_with_GDB/gdbSpecifying_a_Debugging_Target.html">Specifying
a debugging target</a> in <i>Debugging with GDB</i> in <b><i>GNUPro Debugging
Tools</i></b>.</font></li>
</ul>

<h3 CLASS="Heading1">
<a NAME="crt0"></a><br>
<font size=+2><i>The C run-time environment (</i><tt>crt0</tt><i>)</i></font></h3>

<div CLASS="Heading1"><font size=+1>To link and run C or C++ programs,&nbsp;
you need to define a small module (usually written in assembler as ‘<tt>crt0.s</tt>’)
to ensure that the hardware initializes for C conventions before calling
main.</font></div>

<div CLASS="Heading1"><font size=+1>There are some examples available in
the sources of GNUPro Toolkit for ‘<tt>crt0.s</tt>’ code (along with examples
of system calls with sub-routines).</font></div>

<div CLASS="Heading1"><font size=+1>Look in the following path.</font></div>

<blockquote>
<pre CLASS="Heading1"><font size=+1><i>installdir</i>/gnupro-99r1/src/newlib/libc/sys</font></pre>
</blockquote>

<div CLASS="Heading1"><font size=+1><i><tt>installdir</tt></i> refers to
your installation directory, by default ‘<tt>/usr/cygnus</tt>’.</font></div>

<div CLASS="Heading1"><font size=+1>For example, look in ‘<tt>.../sys/h8300hms</tt>’
for Hitachi H8/300 bare boards, or in ‘<tt>.../sys/sparclite</tt>’ for
the Fujitsu SPARClite board.</font></div>

<div CLASS="Heading1"><font size=+1>More examples are in the following
directory.</font></div>

<br>&nbsp;
<blockquote>
<pre CLASS="Heading1"><font size=+1><i>installdir</i>/gnupro-99r1/src/newlib/stub</font></pre>
</blockquote>

<div CLASS="Heading1"><font size=+1>To write your own <tt>crt0.s</tt> module,
you need the following information about your target.</font></div>

<ul TYPE=SQUARE>
<li CLASS="Heading1">
<font size=+1>A memory map, showing the size of available memory and memory
location</font></li>

<li CLASS="Heading1">
<font size=+1>The way the stack grows</font></li>

<li CLASS="Heading1">
<font size=+1>The output format in use</font></li>
</ul>

<div CLASS="Heading1"><font size=+1>At a minimum, your <tt>crt0.s</tt>
modulemust do the following processes.</font></div>

<ul TYPE=SQUARE>
<li CLASS="Heading1">
<font size=+1>Define the symbol, <tt>start</tt> (<tt>_start</tt> in assembler
code). Execution begins at this symbol.</font></li>

<li>
<font size=+1>Set up the stack pointer, <tt>sp</tt>. It is largely up to
you to choose where to store your stack within the constraints of your
target’s memory map. Perhaps the simplest choice is to choose a fixed-size
area somewhere in the uninitialized data section (often called ‘<tt>bss</tt>’).
Remember that whether you choose the low address or the high address in
this area depends on the direction your stack grows.</font></li>

<li>
<font size=+1>Initialize all memory in the uninitialized-data (‘<tt>bss</tt>’)
section to zero.</font></li>

<br><font size=+1>The easiest way to do this is with the help of a linker
script (see <a href="../5_ut/b_Usingld/ldLinker_scripts.html">Linker scripts</a>
in <a href="../5_ut/b_Usingld/ld.html"><i>Using</i> <tt>ld</tt></a> in
<b><i>GNUPro Utilities</i></b>). Use a linker script to define symbols
such as ‘<tt>bss_start</tt>’ and ‘<tt>bss_end</tt>’ to record the boundaries
of this section; then you can use a ‘<tt>for</tt>’ loop to initialize all
memory between them in the ‘<tt>crt0.s</tt>’ module.</font>
<li>
<font size=+1>Call main. Nothing else will!</font></li>
</ul>
<font size=+1>A more complete ‘<tt>crt0.s</tt>’ module might also do the
following processes.</font>
<ul TYPE=SQUARE>
<li>
<font size=+1>Define an ‘_</font><font size=-2> </font><font size=+1><tt>_exit</tt>’
subroutine. This is the C name; in your assembler code.&nbsp; Use the label,
_</font><font size=-2> </font><font size=+1><tt>_exit</tt>, with two leading
underbars. Its precise behavior depends on the details of your system,
and on your choice. Possibilities include trapping back to the boot monitor,
if there is one; or to the loader, if there is no monitor; or even back
to the symbol, <tt>start</tt>.</font></li>

<li>
<font size=+1>If your target has no monitor to mediate communications with
the debugger, you must set up the hardware exception handler in the ‘<tt>crt0.s</tt>’
module. See <a href="../3_dbug/b_Debugging_with_GDB/gdbThe_GDB_remote_serial_protocol.html">The
GDB remote serial protocol</a> in <i><a href="../3_dbug/b_Debugging_with_GDB/gdb.html">Debugging
with GDB</a></i> in <b><i>GNUPro Debugging Tools</i></b> for details on
how to use the gdb generic remote-target facilities for this purpose.</font></li>

<li>
<font size=+1>Perform other hardware-dependent initialization; for example,
initializing an mmu or an auxiliary floating-point chip.</font></li>

<li>
<font size=+1>Define low-level input and output subroutines. For example,
the ‘<tt>crt0.s</tt>’ module is a convenient place to define the minimal
assembly-level routines; see <a href="../4_libs/a_GNUPro_C_Library/libcSystem_Calls.html">System
calls</a> in <i><a href="../4_libs/a_GNUPro_C_Library/libc.html">GNUPro
C Library</a></i> in <b><i>GNUPro Libraries</i></b>.</font></li>
</ul>

<h3 CLASS="Heading1">
<a NAME="pgfId=1009008"></a><a NAME="_Toc385737445"></a><a NAME="_Ref386939541"></a><a NAME="_Toc390660112"></a><a NAME="_Toc399635437"></a></h3>

<h3 CLASS="Heading1">
<a NAME="crt0,_the_main_startup_file"></a><font size=+2><tt>crt0</tt><b><i><font face="Times New Roman,Times">,
the main startup file</font></i></b></font></h3>

<div CLASS="Body"><a NAME="pgfId=1009010"></a><font size=+1>The <tt>crt0</tt>
(C RunTime 0) file<a NAME="marker=1009009"></a> contains the initial startup
code.</font></div>

<div CLASS="Body"><a NAME="pgfId=1009011"></a><font size=+1>Cygnus provides
a <tt>crt0</tt> file, although you may want to write your own <tt>crt0</tt>
file for each target.</font>
<p><font size=+1>The <tt>crt0</tt> file is usually written in assembler
as <tt>crt0.S</tt>, and its object gets linked in first and bootstraps
the rest of your application.</font>
<p><font size=+1>The <tt>crt0</tt> file defines a special symbol like <tt>_start<a NAME="marker=1009012"></a></tt>,
which is both the default base address for the application and the first
symbol in the executable binary image.</font>
<p><a NAME="pgfId=1009013"></a><font size=+1>If you plan to use any routines
from the standard C library, you’ll also need to implement the functions
on which <tt>libgloss</tt> depends. The <tt>crt0</tt> file accomplishes
the following results.</font>
<br>&nbsp;
<ul>
<ul>
<ul>
<li>
<font size=+1><a href="#crt0_initializes"><tt>crt0</tt> initializes everything</a></font></li>

<li>
<font size=+1><a href="#crt0_zeroes_the_bss_section"><tt>crt0</tt> zeroes
the <tt>.bss</tt> section</a></font></li>

<li>
<font size=+1><a href="#crt0_calls_main()"><tt>crt0</tt> calls <tt>main()</tt></a></font></li>

<li>
<font size=+1><a href="#crt0_calls_(exit)"><tt>crt0</tt> calls <tt>(exit)</tt></a></font></li>
</ul>
</ul>
</ul>
<font size=+1>See also <a href="#I/O_support_code" CLASS="XRef">I/O support
code</a>.</font></div>

<ul TYPE=SQUARE>
<div CLASS="Body">&nbsp;
<ul>
<ul>
<li>
<font size=+1>&nbsp;<a NAME="pgfId=1009017"></a><a NAME="crt0_initializes"></a><tt>crt0
</tt><b>initializes
everything in your program that needs it.</b></font></li>
</ul>
</ul>
</div>

<ul TYPE=SQUARE>&nbsp;
<ul TYPE=SQUARE><font size=+1>This initialization section varies. If you
are developing an application that gets downloaded to a ROM monitor, there
is usually no need for special initialization because the ROM monitor handles
it for you. If you plan to burn your code in a ROM, the <tt>crt0</tt> file
typically does all of the hardware initialization required to run an application.
This can include things like initializing serial ports and running a memory
check; however, results vary depending on your hardware.</font></ul>
</ul>
</ul>

<div CLASS="BodyListFollow">
<ul>
<ul>
<ul><a NAME="pgfId=1009018"></a><font size=+1>The following is a typical
basic initialization of <tt>crt0.S</tt>.</font></ul>
</ul>
</ul>
</div>

<ul>
<ul>
<div CLASS="NumberedSideHead">
<ul><font size=+1><b>1.&nbsp;<a NAME="pgfId=1009020"></a></b>Set up concatenation
macros<a NAME="marker=1009019"></a>.</font></ul>
</div>
</ul>
</ul>

<div CLASS="CodeExample2">
<ul>
<ul>
<ul>
<ul>
<pre><a NAME="pgfId=1009021"></a><font size=+1>#define CONCAT1(a, b) CONCAT2(a, b)</font></pre>
</ul>
</ul>
</ul>
</ul>
</div>

<ul>
<ul>
<ul>
<ul>
<pre><font size=+1>#define CONCAT2(a, b) a ## b</font></pre>
</ul>
</ul>

<div CLASS="BodyListFollow3">
<ul><a NAME="pgfId=1009022"></a><font size=+1>Later, you'll use these macros.</font></ul>
</div>

<div CLASS="NumberedSideHeadNext">
<ul><font size=+1><b>2.&nbsp;<a NAME="pgfId=1009024"></a></b>Set up label
macros<a NAME="marker=1009023"></a>, using the following example's input.</font></ul>
</div>
</ul>
</ul>

<div CLASS="CodeExample2">
<ul>
<ul>
<ul>
<ul>
<pre><a NAME="pgfId=1009025"></a><tt><font size=+1>#ifndef __USER_LABEL_PREFIX__</font></tt></pre>
</ul>
</ul>
</ul>
</ul>
</div>

<ul>
<ul>
<ul>
<ul>
<pre><tt><font size=+1>#define __USER_LABEL_PREFIX__ _</font></tt></pre>

<pre><tt><font size=+1>#endif</font></tt></pre>

<pre CLASS="CodeExample2"><a NAME="pgfId=1009026"></a><tt><font size=+1>#define SYM(x) CONCAT1 (__USER_LABEL_PREFIX__, x)</font></tt></pre>
</ul>
</ul>
</ul>

<ul>
<div CLASS="BodyListFollow3">
<ul><a NAME="pgfId=1009027"></a><font size=+1>These macros make the code
portable between <tt>coff</tt> and <tt>a.out</tt>. <tt>coff</tt> always
has an <tt>__ </tt>(underline) prepended to the front of its global symbol
names<a NAME="marker=1009028"></a>. <tt>a.out</tt> has none.</font></ul>
</div>

<div CLASS="NumberedSideHeadNext">
<ul><font size=+1><b>3.&nbsp;<a NAME="pgfId=1009031"></a></b>Set up register
names<a NAME="marker=1009029"></a> (with the right prefix<a NAME="marker=1009030"></a>),
using the following example's input.</font></ul>
</div>
</ul>
</ul>

<div CLASS="CodeExample2">
<ul>
<ul>
<ul>
<ul>
<pre><a NAME="pgfId=1009032"></a><font size=+1>#ifndef __REGISTER_PREFIX__</font></pre>
</ul>
</ul>
</ul>
</ul>
</div>

<ul>
<ul>
<ul>
<ul>
<pre><font size=+1>#define __REGISTER_PREFIX__</font></pre>

<pre><font size=+1>#endif</font></pre>

<pre CLASS="CodeExample2"><a NAME="pgfId=1009033"></a><font size=+1>/* Use the right prefix for registers. */</font></pre>

<pre><font size=+1>#define REG(x) CONCAT1 (__REGISTER_PREFIX__, x)</font></pre>

<pre CLASS="CodeExample2"><a NAME="pgfId=1009034"></a><tt><font size=+1>#define d0 REG (d0)</font></tt></pre>

<pre><tt><font size=+1>#define d1 REG (d1)</font></tt></pre>

<pre><tt><font size=+1>#define d2 REG (d2)</font></tt></pre>

<pre><tt><font size=+1>#define d3 REG (d3)</font></tt></pre>

<pre><tt><font size=+1>#define d4 REG (d4)</font></tt></pre>

<pre><tt><font size=+1>#define d5 REG (d5)</font></tt></pre>

<pre><tt><font size=+1>#define d6 REG (d6)</font></tt></pre>

<pre><tt><font size=+1>#define d7 REG (d7)</font></tt></pre>

<pre><tt><font size=+1>#define a0 REG (a0)</font></tt></pre>

<pre><tt><font size=+1>#define a1 REG (a1)</font></tt></pre>

<pre><tt><font size=+1>#define a2 REG (a2)</font></tt></pre>

<pre><tt><font size=+1>#define a3 REG (a3)</font></tt></pre>

<pre><tt><font size=+1>#define a4 REG (a4)</font></tt></pre>

<pre><tt><font size=+1>#define a5 REG (a5)</font></tt></pre>

<pre><tt><font size=+1>#define a6 REG (a6)</font></tt></pre>

<pre><tt><font size=+1>#define fp REG (fp)</font></tt></pre>

<pre><tt><font size=+1>#define sp REG (sp)</font></tt></pre>
</ul>
</ul>

<div CLASS="BodyListFollow3">
<ul><a NAME="pgfId=1009035"></a><font size=+1>Register names are for portability
between assemblers. Some register names have a <tt>%</tt> or <tt>$</tt>
prepended to them.</font></ul>
</div>

<div CLASS="NumberedSideHeadNext">
<ul><font size=+1><b>4.&nbsp;<a NAME="pgfId=1009038"></a></b>Set up space
for the stack<a NAME="marker=1009036"></a> and grab a chunk of memory<a NAME="marker=1009037"></a>.</font></ul>
</div>
</ul>
</ul>

<div CLASS="CodeExample2">
<ul>
<ul>
<ul>
<ul>
<pre><a NAME="pgfId=1009039"></a><font size=+1>.set stack_size, 0x2000 .</font></pre>
</ul>
</ul>
</ul>
</ul>
</div>

<ul>
<ul>
<ul>
<ul>
<pre><font size=+1>comm SYM (stack), stack_size</font></pre>
</ul>
</ul>
</ul>

<ul>
<div CLASS="BodyListFollow3">
<ul><a NAME="pgfId=1009040"></a><font size=+1>This can also be done in
the linker script, although it typically gets done at this point.</font></ul>
</div>

<div CLASS="NumberedSideHeadNext">
<ul><font size=+1><b>5.&nbsp;<a NAME="pgfId=1009041"></a></b>Define an
empty space for the environment, using the following example's input.</font></ul>
</div>
</ul>
</ul>

<div CLASS="CodeExample2">
<ul>
<ul>
<ul>
<ul>
<pre><a NAME="pgfId=1009042"></a><font size=+1>&nbsp;&nbsp;&nbsp;&nbsp; .data</font></pre>
</ul>
</ul>
</ul>
</ul>
</div>

<ul>
<ul>
<ul>
<ul>
<pre><font size=+1>&nbsp;&nbsp;&nbsp;&nbsp; .align 2</font></pre>

<pre><font size=+1>SYM (environ):</font></pre>

<pre><font size=+1>&nbsp;&nbsp;&nbsp;&nbsp; .long 0</font></pre>
</ul>
</ul>

<div CLASS="BodyListFollow3">
<ul><a NAME="pgfId=1009044"></a><font size=+1>This is bogus on almost any
ROM monitor<a NAME="marker=1009043"></a>, although it's best generally
set up as a valid address, then passing the address to <tt>main()<a NAME="marker=1009045"></a></tt>.
This way, if an application checks for an empty environment, it finds one.</font></ul>
</div>

<div CLASS="NumberedSideHeadNext">
<ul><font size=+1><b>6.&nbsp;<a NAME="pgfId=1009047"></a></b>Set up a few
global symbols<a NAME="marker=1009046"></a> that get used elsewhere.</font></ul>
</div>
</ul>
</ul>

<div CLASS="CodeExample2">
<ul>
<ul>
<ul>
<ul>
<pre><a NAME="pgfId=1009048"></a><font size=+1>.align 2</font></pre>
</ul>
</ul>
</ul>
</ul>
</div>

<ul>
<ul>
<ul>
<ul>
<pre><font size=+1>.text</font></pre>

<pre><font size=+1>.global SYM (stack)</font></pre>

<pre CLASS="CodeExample2"><a NAME="pgfId=1009049"></a><font size=+1>.global SYM (main)</font></pre>

<pre><font size=+1>.global SYM (exit)</font></pre>

<pre><font size=+1>.global __bss_start</font></pre>
</ul>
</ul>

<div CLASS="BodyListFollow3">
<ul><a NAME="pgfId=1009051"></a><font size=+1>This really should be <tt>__bss_start</tt>,
not <tt>SYM (__bss_start<a NAME="marker=1009050"></a></tt>.</font></ul>
</div>
</ul>

<ul>
<div CLASS="BodyListFollow3">
<ul><a NAME="pgfId=1009052"></a><font size=+1><tt>__bss_start </tt>needs
to be declared this way because its value is set in the linker script.</font></ul>
</div>

<div CLASS="NumberedSideHeadNext">
<ul><font size=+1><b>7.&nbsp;<a NAME="pgfId=1009054"></a></b>Set up the
global symbol, <tt>start<a NAME="marker=1009053"></a></tt>, for the linker
to use as the default address for the <tt>.text</tt> section. This helps
your program run.</font></ul>
</div>
</ul>
</ul>

<div CLASS="CodeExample2">
<ul>
<ul>
<ul>
<ul>
<pre><a NAME="pgfId=1009055"></a><font size=+1>SYM (start):</font></pre>
</ul>
</ul>
</ul>
</ul>
</div>

<ul TYPE=SQUARE>
<ul TYPE=SQUARE>
<ul>
<ul>
<pre><font size=+1>link a6, #-8</font></pre>

<pre><font size=+1>moveal #SYM (stack) + stack_size, sp</font></pre>
</ul>
</ul>

<li>
<a NAME="pgfId=1009057"></a><a NAME="crt0_zeroes_the_bss_section"></a><font size=+1><tt>crt0
</tt><b>zeroes
the </b><tt>.bss</tt> <b>section</b></font></li>

<ul TYPE=SQUARE><a NAME="marker=1009056"></a><font size=+1>Make sure the
<tt>.bss</tt>
section is cleared for uninitialized data, using the following example's
input. All of the addresses in the <tt>.bss</tt> section need to be initialized
to zero so programs that forget to check new variables' default values
will get predictable results.</font></ul>
</ul>
</ul>

<div CLASS="CodeExample">
<ul>
<ul>
<ul>
<ul>
<pre><a NAME="pgfId=1009058"></a><font size=+1>moveal #__bss_start, a0</font></pre>
</ul>
</ul>
</ul>
</ul>
</div>

<ul TYPE=SQUARE>
<ul TYPE=SQUARE>
<ul>
<ul>
<pre><font size=+1>moveal #SYM (end), a1</font></pre>

<pre><font size=+1>1:</font></pre>

<pre><font size=+1>movel #0, (a0)</font></pre>

<pre><font size=+1>leal 4(a0), a0</font></pre>

<pre><font size=+1>cmpal a0, a1</font></pre>

<pre><font size=+1>bne 1b</font></pre>
</ul>
</ul>

<div CLASS="BodyListFollow">
<ul><a NAME="pgfId=1009059"></a><font size=+1>Applications can get wild
side effects from the <tt>.bss</tt> section being left uncleared, and it
can cause particular problems with some implementations of <tt>malloc()</tt>
.</font><a NAME="marker=1009060"></a></ul>
</div>

<li>
<a NAME="pgfId=1009062"></a><a NAME="crt0_calls_main()"></a><font size=+1><tt>crt0
</tt><b>calls
</b><tt>main()</tt></font></li>
</ul>
</ul>

<ul TYPE=SQUARE>
<ul TYPE=SQUARE>
<ul TYPE=SQUARE><a NAME="marker=1009061"></a><font size=+1>If your ROM
monitor supports it, set up <tt>argc</tt> and <tt>argv</tt> for command
line arguments and an environment pointer before the call to <tt>main()</tt>,
using the following example's input.</font></ul>
</ul>
</ul>

<div CLASS="BodyListFollow">
<ul>
<ul>
<ul><a NAME="pgfId=1009063"></a><font size=+1>For <tt>g++</tt>, the code
generator inserts a branch to <tt>__main</tt> at the top of your <tt>main()</tt>
routine. <tt>g++</tt> uses <tt>__main</tt> to initialize its internal tables
and then returns control to your <tt>main()</tt> routine.</font></ul>
</ul>
</ul>
</div>

<div CLASS="BodyListFollow">
<ul>
<ul>
<ul><a NAME="pgfId=1009064"></a><font size=+1>For <tt>crt0</tt> to call
your <tt>main()</tt> routine, use the following example's input. First,
set up the environment pointer and jump to <tt>main()</tt>. Call the main
routine from the application to get it going, using the following example's
input with <tt>main (argc, argv, environ)</tt>, using <tt>argv<a NAME="marker=1009065"></a></tt>as
a pointer to NULL.</font></ul>
</ul>
</ul>
</div>

<ul>
<ul TYPE=SQUARE>
<ul>
<ul>
<pre CLASS="CodeExample"><a NAME="pgfId=1009066"></a><font size=+1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pea 0</font></pre>

<pre><font size=+1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pea SYM (environ)</font></pre>

<pre><font size=+1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pea sp@(4)</font></pre>

<pre><font size=+1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pea 0</font></pre>

<pre><font size=+1>jsr SYM (main)</font></pre>

<pre><font size=+1>movel d0, sp@-4</font></pre>
</ul>
</ul>

<li>
<a NAME="pgfId=1009062"></a><a NAME="crt0_calls_(exit)"></a><font size=+1><tt>crt0
</tt><b>calls
</b><tt>(exit)</tt></font></li>
</ul>
</ul>

<ul>
<ul TYPE=SQUARE>
<ul TYPE=SQUARE>
<div CLASS="Bullet"><a NAME="marker=1009067"></a><font size=+1>After <tt>main()</tt>
has run, the <tt>crt0</tt> file cleans things up and returns control of
the hardware from the application. On some hardware there is nothing to
return to--especially if your program is in ROM—and if that's the case,
you need to do a hardware reset or branch back to the original start address.</font></div>
</ul>
</ul>
</ul>

<div CLASS="BodyListFollow">
<ul TYPE=SQUARE>
<ul TYPE=SQUARE>
<ul TYPE=SQUARE><a NAME="pgfId=1009069"></a><font size=+1>If you're using
a ROM monitor, you can usually call a user trap to make the ROM take over.
Pick a safe vector with no sides effects. Some ROM's have a built-in trap
handler<a NAME="marker=1009070"></a><a NAME="marker=1009071"></a>just for
this case.</font></ul>
</ul>
</ul>
</div>

<div CLASS="BodyListFollow">
<ul>
<ul>
<ul><a NAME="pgfId=1009072"></a><font size=+1>Implementing <tt>(exit)</tt>
here is easy. First, with <tt>_exit</tt>, exit from the application. Normally,
this causes a user trap to return to the ROM monitor for another run. Then,
using the following example's input, you proceed with the call.</font></ul>
</ul>
</ul>
</div>

<ul>
<ul>
<ul>
<ul>
<ul>
<pre CLASS="CodeExample"><a NAME="pgfId=1009073"></a><font size=+1>SYM (exit):</font></pre>

<pre><font size=+1>trap #0</font></pre>
</ul>
</ul>
</ul>

<div CLASS="BodyListFollow">
<ul><a NAME="pgfId=1009076"></a><font size=+1>Both <tt>rom68k<a NAME="marker=1009074"></a></tt>and
<tt>bug<a NAME="marker=1009075"></a></tt>can
handle a user-caused exception of <tt>0</tt> with no side effects. Although
the <tt>bug</tt> monitor has a user-caused trap that returns control to
the ROM monitor<a NAME="marker=1009077"></a>, the <tt>bug</tt> monitor<a NAME="marker=1009078"></a>
is more portable.</font></ul>
</div>
</ul>
</ul>

<h3 CLASS="Heading1">
<a NAME="pgfId=1009083"></a><a NAME="_Toc385737446"></a><a NAME="_Ref386939565"></a><a NAME="_Toc390660113"></a><a NAME="_Toc399635438"></a></h3>

<h2 CLASS="Heading1">
<a NAME="The_linker_script"></a><b><i><font face="Times New Roman,Times">The
linker script</font></i></b></h2>

<div CLASS="Body"><font size=+1>In the following path, find the example
linker scripts (<i><tt>hosttype</tt></i> signifies your host configuration
and <i><tt>targettype</tt></i> signifies the embedded configuration to
which you target):</font>
<blockquote>
<pre><font size=+1>/usr/cygnus/<i>hosttype</i>/<i>targettype</i>/lib/ldscripts/</font></pre>
</blockquote>
<font size=+1>In that directory, there will be files with the <tt>.x</tt>,
<tt>.xbn</tt>,
<tt>.xn</tt>,
<tt>.xr</tt>,
<tt>.xs</tt>,
and <tt>.xu </tt>extensions. These are examples of linker scripts.</font>
<p><a NAME="pgfId=1009085"></a><font size=+1>The linker script<a NAME="marker=1009084"></a>
accomplishes the following processes to result.</font>
<ul TYPE=SQUARE>
<ul TYPE=SQUARE>
<li>
<a NAME="pgfId=1009087"></a><b><i><font size=+1>Sets up the <a href="#Memory_map">memory
map<a NAME="marker=1009086"></a></a> for the application.</font></i></b></li>

<br><a NAME="pgfId=1009088"></a><font size=+1>When your application is
loaded into memory, it allocates some RAM, some disk space for I/O, and
some registers. The linker script makes a memory map of this memory allocation
which is important to embedded systems because, having no OS, you have
the ability then to manage the behavior of the chip.</font>
<li>
<a NAME="pgfId=1009091"></a><font size=+1><b><i>For </i></b><tt>g++</tt><b><i>,
sets up the <a href="#Constructor_and_destructor_tables_for_g++">constructor
and destructor tables<a NAME="marker=1009089"></a><a NAME="marker=1009090"></a></a>.</i></b></font></li>

<br><a NAME="pgfId=1009093"></a><font size=+1>The actual section names<a NAME="marker=1009092"></a>
vary depending on your object file format. For <tt>a.out</tt> and <tt>coff</tt>,
the three main sections<a NAME="marker=1009094"></a> are <tt>.text<a NAME="marker=1009095"></a></tt>,<tt>
.data<a NAME="marker=1009096"></a></tt> and <tt>.bss<a NAME="marker=1009097"></a></tt>.</font>
<li>
<a NAME="pgfId=1009099"></a><b><i><font size=+1>Sets the default values
for <a href="#pgfId=1009154">variables<a NAME="marker=1009098"></a></a>
used elsewhere.</font></i></b></li>

<br><a NAME="pgfId=1009102"></a><font size=+1>These default variables are
used by <tt>sbrk()<a NAME="marker=1009100"></a></tt>and the <tt>crt0</tt>
file<a NAME="marker=1009101"></a>, typically called by <tt>_bss_start<a NAME="marker=1009103"></a></tt>and&nbsp;<a NAME="_end"></a><tt>_end</tt>.</font></ul>
</ul>
</div>

<div CLASS="BodyListFollow">
<ul>&nbsp;</ul>
<a NAME="Memory_map"></a><a NAME="pgfId=1009105"></a><font size=+1>There
are two ways to ensure the memory map is correct.</font></div>

<div CLASS="Body">
<ul TYPE=SQUARE>
<li>
<a NAME="pgfId=1009107"></a><font size=+1>By having the linker create the
memory map<a NAME="marker=1009106"></a> by using the option,<tt> -Map</tt>.</font></li>

<br>&nbsp;
<li>
<a NAME="pgfId=1009109"></a><font size=+1>By, after linking, using the
<tt>nm</tt>
utility<a NAME="marker=1009108"></a> to check critical addresses like <tt>start</tt>,
<tt>bss_end</tt>
and <tt>_etext</tt>.</font></li>

<br>&nbsp;</ul>
</div>

<div CLASS="Body"><a NAME="pgfId=1009110"></a><font size=+1>The following
is an example of a linker script for an <tt>m68k</tt>-based target board.</font></div>

<ol>
<div CLASS="Numbered">
<ul><font size=+1><b>1.&nbsp;<a NAME="pgfId=1009112"></a></b>Use the <tt>STARTUP</tt>
command,<a NAME="marker=1009111"></a> which loads the file so that it executes
first.</font></ul>
</div>
</ol>

<div CLASS="CodeExample">
<ul>
<ul>
<ul>
<ul>
<pre><a NAME="pgfId=1009113"></a><font size=+1>STARTUP(crt0.o)</font></pre>
</ul>
</ul>
</ul>
</ul>
</div>

<div CLASS="BodyListFollow">
<ul>
<ul><a NAME="pgfId=1009115"></a><font size=+1>The <tt>m68k-coff</tt> configuration<a NAME="marker=1009114"></a>
default does not link in <tt>crt0.o</tt> because it assumes that a developer
has <tt>crt0</tt>. This behavior is controlled in the <tt>config</tt> file
for each architecture in a macro called <tt>STARTFILE_SPEC<a NAME="marker=1009116"></a></tt>.
If <tt>STARTFILE_SPEC</tt> is set to NULL, <tt>gcc</tt> formats its command
line and doesn't add <tt>crt0.o</tt>. Any filename can be specified with
<tt>STARTUP</tt>,
although the default is always <tt>crt0.o</tt> .</font></ul>
</ul>
</div>

<ul>
<ul>
<div CLASS="BodyListFollow"><a NAME="pgfId=1009117"></a><font size=+1>If
you use only <tt>ld</tt> to link, you control whether or not to link in
<tt>crt0.o</tt>
on the command line.</font></div>

<div CLASS="BodyListFollow"><a NAME="pgfId=1009119"></a><font size=+1>If
you have multiple <tt>crt0</tt> files<a NAME="marker=1009118"></a>, you
can leave <tt>STARTUP</tt> out, and link in <tt>crt0.o</tt> in the makefile
or use different linker scripts. Sometimes this option is used to initialize
floating point values or to add device support.</font></div>
</ul>

<div CLASS="NumberedNext">
<ul><font size=+1><b>2.&nbsp;<a NAME="pgfId=1009121"></a></b>Using <tt>GROUP<a NAME="marker=1009120"></a></tt>,
load the specified file.</font></ul>
</div>
</ul>

<div CLASS="CodeExample">
<ul>
<ul>
<ul>
<ul>
<pre><a NAME="pgfId=1009122"></a><font size=+1>GROUP(-lgcc-liop-lc)</font></pre>
</ul>
</ul>
</ul>
</ul>
</div>

<div CLASS="BodyListFollow">
<ul>
<ul>
<ul><a NAME="pgfId=1009123"></a><font size=+1>In this case, the file is
a relocated library that contains the definitions for the low-level functions
needed by <tt>libc.a</tt> . The file to load could have also been specified
on the command line, but as it's always needed, it might as well be here
as a default.</font></ul>
</ul>
</ul>
</div>

<ul>
<div CLASS="NumberedNext">
<ul><font size=+1><b>3.&nbsp;<a NAME="pgfId=1009125"></a></b><tt>SEARCH_DIR<a NAME="marker=1009124"></a></tt>specifies
the path in which to look for files.</font></ul>
</div>
</ul>

<div CLASS="CodeExample">
<ul>
<ul>
<ul>
<ul>
<pre><a NAME="pgfId=1009126"></a><font size=+1>SEARCH_DIR(.)</font></pre>
</ul>
</ul>
</ul>
</ul>
</div>

<ul>
<div CLASS="NumberedNext">
<ul><font size=+1><b>4.&nbsp;<a NAME="pgfId=1009129"></a></b>Using <tt>_DYNAMIC<a NAME="marker=1009127"></a></tt>,
specify whether or not there are shared dynamic libraries<a NAME="marker=1009128"></a>.
In the following example's case, there are no shared libraries.</font></ul>
</div>
</ul>

<div CLASS="CodeExample">
<ul>
<ul>
<ul>
<ul>
<pre><a NAME="pgfId=1009130"></a><font size=+1>__DYNAMIC = 0;</font></pre>
</ul>
</ul>
</ul>
</ul>
</div>

<ul>
<div CLASS="NumberedNext">
<ul><font size=+1><b>5.&nbsp;<a NAME="pgfId=1009132"></a></b>Set <tt>_stack</tt>,
the&nbsp;<a NAME="variable_for_specifying_RAM"></a>variable for specifying
RAM for the ROM monitor.</font></ul>
</div>

<div CLASS="NumberedNext">
<ul><font size=+1><b>6.&nbsp;<a NAME="pgfId=1009133"></a></b>Specify a
name for a section that can be referred to later in the script. In the
following example's case, it's only a pointer to the beginning of free
RAM space<a NAME="marker=1009134"></a> with an upper limit at 2M. If the
output file exceeds the upper limit, <tt>MEMORY<a NAME="marker=1009135"></a></tt>produces
an error message. First, in this case, we'll set up the memory map of the
board's stack for high memory for both the <tt>rom68k</tt> and <tt>mon68k</tt>
monitors<a NAME="marker=1009136"></a>.</font></ul>
</div>
</ul>

<div CLASS="CodeExample">
<ul>
<ul>
<ul>
<ul>
<pre><a NAME="pgfId=1009137"></a><font size=+1>MEMORY</font></pre>
</ul>
</ul>
</ul>
</ul>
</div>

<ul>
<ul>
<ul>
<ul>
<pre><font size=+1>{</font></pre>

<pre><font size=+1>&nbsp;&nbsp;&nbsp; ram&nbsp;&nbsp;&nbsp;&nbsp; :&nbsp;&nbsp;&nbsp;&nbsp; ORIGIN = 0x10000, LENGTH = 2M</font></pre>

<pre><font size=+1>}</font></pre>
</ul>
</ul>
</ul>
</ul>

<div CLASS="Body"><a NAME="Constructor_and_destructor_tables_for_g++"></a><a NAME="pgfId=1009139"></a><font size=+1>The
following discusses setting up constructor and destructor tables for <tt>g++<a NAME="marker=1009138"></a></tt>.</font>
<p><a NAME="pgfId=1009141"></a><font size=+1>Set up the <tt>.text</tt>
section<a NAME="marker=1009140"></a>, using the following example's input.</font></div>

<ol>
<div CLASS="Numbered">&nbsp;</div>
</ol>

<div CLASS="CodeExample">
<ul>
<ul>
<ul>
<pre><a NAME="pgfId=1009142"></a><font size=+1>SECTIONS</font></pre>
</ul>
</ul>
</ul>
</div>

<ul>
<ul>
<ul>
<pre><font size=+1>{</font></pre>

<pre><font size=+1>&nbsp;&nbsp; .text :</font></pre>

<pre><font size=+1>&nbsp;&nbsp; {</font></pre>

<pre><font size=+1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CREATE_OBJECT_SYMBOLS</font><a NAME="marker=1009143"></a></pre>

<pre><font size=+1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; *(.text)</font></pre>

<pre><font size=+1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; etext = .;</font></pre>

<pre><font size=+1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; __CTOR_LIST__ = .;</font></pre>

<pre><font size=+1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; LONG((__CTOR_END__ - __CTOR_LIST__) / 4 - 2)</font></pre>

<pre><font size=+1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; *(.ctors)</font></pre>

<pre><font size=+1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; LONG(0)</font></pre>

<pre><font size=+1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; __CTOR_END__ = .;</font></pre>

<pre><font size=+1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; __DTOR_LIST__ = .;</font></pre>

<pre><font size=+1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; LONG((__DTOR_END__ - __DTOR_LIST__) / 4 - 2)</font></pre>

<pre><font size=+1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; *(.dtors)</font></pre>

<pre><font size=+1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; LONG(0)</font></pre>

<pre><font size=+1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; __DTOR_END__ = .;</font></pre>

<pre><font size=+1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; *(.lit)</font></pre>

<pre><font size=+1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; *(.shdata) }</font></pre>

<pre><font size=+1>&nbsp;&nbsp; > ram</font></pre>

<pre><font size=+1>&nbsp;&nbsp; .shbss SIZEOF(.text) + ADDR(.text) : {</font></pre>

<pre><font size=+1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; *(.shbss)</font></pre>

<pre><font size=+1>&nbsp;&nbsp; }</font></pre>
&nbsp;</ul>
</ul>

<div CLASS="BodyListFollow"><a NAME="pgfId=1009144"></a><font size=+1>In
a <tt>coff</tt> file, all the actual instructions reside in <tt>.text</tt>
for also setting up the constructor and destructor tables for <tt>g++</tt>.
Notice that the section description redirects itself to the RAM variable<a NAME="marker=1009145"></a>
that was set up in Step 5 of the earlier process for the <tt>crt0</tt>
file, <a href="#variable_for_specifying_RAM" CLASS="XRef">variable for
specifying RAM for the ROM monitor</a>.</font></div>

<div CLASS="NumberedNext"><a NAME="pgfId=1009151"></a><font size=+1>Set
up the <tt>.data<a NAME="marker=1009149"></a></tt>section<a NAME="marker=1009150"></a>.</font>
<ul>&nbsp;</ul>
</div>
</ul>

<div CLASS="CodeExample">
<ul>
<ul>
<pre><a NAME="pgfId=1009152"></a>&nbsp;&nbsp; <font size=+1>.talias : { } > ram</font></pre>
</ul>
</ul>
</div>

<ul TYPE=SQUARE>
<ul>
<pre><font size=+1>&nbsp;&nbsp; .data : {</font></pre>

<pre><font size=+1>&nbsp;&nbsp; *(.data)</font></pre>

<pre><font size=+1>&nbsp;&nbsp; CONSTRUCTORS</font><a NAME="marker=1009153"></a></pre>

<pre><font size=+1>&nbsp;&nbsp; _edata = .;</font></pre>

<pre><font size=+1>} > ram</font></pre>
</ul>
</ul>

<div CLASS="Body"><a NAME="pgfId=1009154"></a><font size=+1>In a <tt>coff</tt>
file, this is where all of the initialized data goes. The default values
for <tt>_bss_start</tt> and <tt>_end</tt> are set here for use by the <tt>crt0</tt>
file when it zeros the <tt>.bss</tt> section.</font></div>

<ul>&nbsp;
<ul>
<pre CLASS="CodeExample"><a NAME="pgfId=1009160"></a><font size=+1>&nbsp;&nbsp; .bss SIZEOF(.data) + ADDR(.data) :</font></pre>

<pre><font size=+1>&nbsp;&nbsp; {</font></pre>

<pre><font size=+1>&nbsp;&nbsp; __bss_start = ALIGN(0x8);</font></pre>

<pre><font size=+1>&nbsp;&nbsp; *(.bss)</font></pre>

<pre><font size=+1>&nbsp;&nbsp; *(COMMON)</font></pre>

<pre><font size=+1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; end = ALIGN(0x8);</font></pre>

<pre><font size=+1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _end = ALIGN(0x8);</font></pre>

<pre><font size=+1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; __end = ALIGN(0x8);</font></pre>

<pre><font size=+1>&nbsp;&nbsp; }</font></pre>

<pre><font size=+1>&nbsp;&nbsp; .mstack : { } > ram</font></pre>

<pre><font size=+1>&nbsp;&nbsp; .rstack : { } > ram</font></pre>

<pre><font size=+1>&nbsp;&nbsp; .stab . (NOLOAD) :</font></pre>

<pre><font size=+1>&nbsp;&nbsp; {</font></pre>

<pre><font size=+1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [ .stab ]</font></pre>

<pre><font size=+1>&nbsp;&nbsp; }</font></pre>

<pre><font size=+1>&nbsp;&nbsp; .stabstr . (NOLOAD) :</font></pre>

<pre><font size=+1>&nbsp;&nbsp; {</font></pre>

<pre><font size=+1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [ .stabstr ]</font></pre>

<pre><font size=+1>&nbsp;&nbsp; }</font></pre>

<pre><font size=+1>}</font></pre>
</ul>
</ul>

<h3 CLASS="Heading1">
<a NAME="pgfId=1009170"></a><a NAME="go"></a><a NAME="_Ref385731145"></a><a NAME="_Toc385737447"></a><a NAME="_Toc390660114"></a><a NAME="_Toc399635439"></a></h3>

<h2 CLASS="Heading1">
<a NAME="I/O_support_code"></a><b><i><font face="Times New Roman,Times">I/O
support code</font></i></b></h2>

<div CLASS="Body"><a NAME="pgfId=1009171"></a><font size=+1>Most applications
use calls to the standard C library. However, when you initially link <tt>libc.a</tt>,
several I/O functions<a NAME="marker=1009172"></a> are undefined. If you
don't plan on doing any I/O, you're OK; otherwise, you need to create two
I/O functions: <tt>open()</tt> and <tt>close()</tt>. These don't need to
be fully supported unless you have a file system, so they are normally
stubbed out, using <tt>kill()</tt>.</font><a NAME="marker=1009173"></a></div>

<div CLASS="Body"><a NAME="pgfId=1009176"></a><font size=+1><tt>sbrk()<a NAME="marker=1009174"></a></tt>is
also a stub<a NAME="marker=1009175"></a>, since you can't do process control
on an embedded system, and it is only needed by applications that do dynamic
memory allocation. It uses the variable, <tt>_end<a NAME="marker=1009177"></a></tt>,
which is set in the linker script.</font></div>

<div CLASS="Body"><a NAME="pgfId=1009178"></a><font size=+1>The following
routines are also used for optimization.</font></div>

<ul TYPE=SQUARE>
<li CLASS="BodyHang1">
<font size=+1>&nbsp;<a NAME="pgfId=1009180"></a><tt>-inbyte</tt></font></li>

<ul TYPE=SQUARE><a NAME="marker=1009179"></a><font size=+1>Returns a single
byte from the console.</font></ul>
</ul>

<ul TYPE=SQUARE>
<li CLASS="BodyHang1">
<font size=+1>&nbsp;<a NAME="pgfId=1009182"></a><tt>-outbyte</tt></font></li>

<ul TYPE=SQUARE><a NAME="marker=1009181"></a><font size=+1>Used for low-level
debugging<a NAME="marker=1009183"></a>, takes an argument for <tt>print()</tt>
and prints a byte out to the console (typically used for ASCII text<a NAME="marker=1009184"></a>).</font></ul>
</ul>

<h3 CLASS="Heading1">
<a NAME="pgfId=1009188"></a><a NAME="_Toc385737448"></a><a NAME="_Toc390660115"></a><a NAME="_Toc399635440"></a></h3>

<h2 CLASS="Heading1">
<a NAME="Memory_support"></a><b><i><font face="Times New Roman,Times">Memory
support</font></i></b></h2>

<div CLASS="Body"><a NAME="pgfId=1009190"></a><font size=+1>The following
routines are for dynamic memory allocation<a NAME="marker=1009189"></a>.</font></div>

<ul TYPE=SQUARE>
<ul TYPE=SQUARE>
<ul TYPE=SQUARE>
<li CLASS="BodyHang1">
<font size=+1>&nbsp;<a NAME="pgfId=1009191"></a><tt>sbrk()</tt></font></li>

<ul TYPE=SQUARE><font size=+1>The functions, <tt>malloc()</tt>, <tt>calloc()</tt>,
and <tt>realloc()</tt> all call <tt>sbrk()</tt> at their lowest levels.
<tt>sbrk()</tt>
returns a pointer to the last memory address your application used before
more memory was allocated.</font></ul>

<li>
<font size=+1>&nbsp;<a NAME="pgfId=1009192"></a><tt>caddr_t</tt></font></li>

<ul TYPE=SQUARE><font size=+1>Defined elsewhere as <tt>char *</tt>.</font></ul>

<li>
<font size=+1>&nbsp;<a NAME="pgfId=1009193"></a><tt>RAMSIZE</tt></font></li>

<ul TYPE=SQUARE><font size=+1>A compile-time option that moves a pointer
to heap memory and checks for the upper limit.</font></ul>
</ul>
</ul>
</ul>

<h3 CLASS="Heading1">
<a NAME="pgfId=1009197"></a><a NAME="_Toc385737449"></a><a NAME="_Toc390660116"></a><a NAME="_Toc399635441"></a></h3>

<h2 CLASS="Heading1">
<a NAME="Miscellaneous_support_routines"></a><b><i><font face="Times New Roman,Times">Miscellaneous
support routines</font></i></b></h2>

<div CLASS="Body"><a NAME="pgfId=1009199"></a><font size=+1>The following
support routines<a NAME="marker=1009198"></a> are called by <tt>newlib</tt>,
although they don't apply to the embedded environment.</font></div>

<ul TYPE=SQUARE>
<li CLASS="BodyHang1">
<font size=+1>&nbsp;<a NAME="pgfId=1009201"></a><tt>isatty()</tt></font></li>
</ul>

<ul TYPE=SQUARE>
<ul><a NAME="marker=1009200"></a><font size=+1>Checks for a terminal device.</font></ul>

<li>
<font size=+1>&nbsp;<a NAME="pgfId=1009203"></a><tt>kill()</tt></font></li>

<ul><a NAME="marker=1009202"></a><font size=+1>Simply exits.</font></ul>
</ul>

<ul TYPE=SQUARE>
<li CLASS="BodyHang1">
<font size=+1>&nbsp;<a NAME="pgfId=1009205"></a><tt>getpd()</tt></font></li>

<ul TYPE=SQUARE><a NAME="marker=1009204"></a><font size=+1>Can safely return
any value greater than 1, although the value doesn’t effect anything in
<tt>newlib<a NAME="marker=1009206"></a></tt>.</font></ul>
</ul>

<div CLASS="BodyListFollow">
<h2>
<a NAME="SN"></a><i>Source-Navigator demonstration</i></h2>

<div CLASS="Body"><a NAME="pgfId=1013034"></a><font size=+1>The following
documentation discusses the&nbsp;<a NAME="marker=1013400"></a>Source-Navigator
source code comprehension tool, using a tutorial to demonstrate the usage
of debugging the sources for a project, editing the source files and building
the project, the <tt>monop<a NAME="marker=1014094"></a></tt>game. In this
tutorial, you will create two targets, <tt>monop</tt> and <tt>initdeck</tt>,
and, with them, use many compiling, editing and debugging features of GNUPro
Toolkit. The result is making and running the <tt>monop<a NAME="marker=1014109"></a></tt>project’s
game.</font></div>

<ul TYPE=SQUARE>
<li CLASS="Bullet">
<a NAME="pgfId=1013335"></a><font size=+1><a href="#Creating_the_demo_project" CLASS="XRef">Creating
the Source-Navigator demonstration project</a></font></li>

<li CLASS="Bullet">
<a NAME="pgfId=1013340"></a><font size=+1><a href="#Building_monop" CLASS="XRef">Building
the monop target</a></font></li>

<li CLASS="Bullet">
<a NAME="pgfId=1013344"></a><font size=+1><a href="#Debug_compile_monop" CLASS="XRef">Debugging
and compiling the monop target</a></font></li>

<li CLASS="Bullet">
<a NAME="pgfId=1013345"></a><font size=+1><a href="int04.html#Building_initdeck" CLASS="XRef">Building
the initdeck target</a></font></li>

<li CLASS="Bullet">
<a NAME="pgfId=1013341"></a><font size=+1><a href="int04.html#Debug_initdeck" CLASS="XRef">Debugging
the initdeck target</a></font></li>

<br>&nbsp;</ul>
<font size=+1>Invoke Source-Navigator with the following input, using a
shell window’s commandline interface from the <tt>/usr/cygnus/gnupro/sn99r1/</tt>directory.</font>
<ul TYPE=SQUARE>
<pre><tt><font size=+1>snavigator</font></tt></pre>
</ul>
<font size=+1>For more information about using Source-Navigator, see its
online documentation from its <font face="Arial,Helvetica">Help</font>
menu.</font>
<h2>
<a NAME="Creating_the_demo_project"></a><i>Creating the Source-Navigator
demonstration project</i></h2>
&nbsp;
<div CLASS="Body"><a NAME="pgfId=1013039"></a><font size=+1>With Source-Navigator
active, create a new project.</font></div>

<ol>
<div CLASS="Numbered"><a NAME="pgfId=1014066"></a><font size=+1>1. Choose
</font><font face="Arial,Helvetica">File</font><i><font size=+1>
-> </font></i><font face="Arial,Helvetica">New Project...</font><font size=+1>
from the </font><font face="Arial,Helvetica">Symbol Browser</font><font size=+1>
and define a new project, calling it <tt>monop.proj</tt>.</font></div>
</ol>

<ol>
<div CLASS="NumberedNext"><a NAME="pgfId=1013040"></a><font size=+1>2.
Under </font><font face="Arial,Helvetica">Add Directory</font><font size=+1>,
click the “<i><font face="Arial,Helvetica">...</font></i>” button to select
the <tt>demos\monop</tt> directory. See <a href="#Fig4" CLASS="XRef">Figure
4</a> for the result of defining the new project’s name in the </font><font face="Arial,Helvetica">Auto-Create
Project</font><font size=+1> window. Click </font><font face="Arial,Helvetica">OK</font><font size=+1>
to build the project.</font></div>
</ol>

<blockquote>
<div CLASS="FigureTitle"><a NAME="pgfId=1013743"></a><a NAME="Fig4"></a><font size=+1><b>Figure
4: </b><i>Creating a new project, </i><tt>monop.proj</tt><i>, from the
</i><tt>demos\monop</tt><i>
directory</i></font></div>
</blockquote>

<ol>
<div CLASS="Figure"><a NAME="pgfId=1013315"></a></div>

<p><br><img SRC="int04-2.gif" ></ol>

<h2 CLASS="Heading2">
<a NAME="Building_monop"></a><a NAME="pgfId=1013044"></a><a NAME="37135"></a><b><i>Building
the </i></b><tt>monop</tt> <i>target</i></h2>

<div CLASS="Body"><a NAME="pgfId=1013045"></a><font size=+1>Having created
a project, you must then build its target components.</font></div>

<ol>
<div CLASS="Numbered"><a NAME="pgfId=1014124"></a><font size=+1>1. Choose
</font><font face="Arial,Helvetica">Tools</font><i><font size=+1>
-> </font></i><font face="Arial,Helvetica">Build Settings...</font><font size=+1>
to start the </font><font face="Arial,Helvetica">Build Settings</font><font size=+1>
window.</font></div>
</ol>

<ol>
<div CLASS="NumberedNext"><a NAME="pgfId=1013049"></a><font size=+1>2.
Enter <tt>monop</tt> as the name of the target. See <a href="#Fig5" CLASS="XRef">Figure
5</a> for the result.</font></div>
</ol>

<blockquote>
<div CLASS="FigureTitle"><a NAME="pgfId=1013760"></a><a NAME="Fig5"></a><font size=+1><b>Figure
5: </b><i>Creating a </i><tt>monop</tt><i> target</i></font></div>
</blockquote>

<ol>
<div CLASS="Figure"><a NAME="pgfId=1013411"></a></div>

<p><br><img SRC="int04-3.gif" ></ol>

<blockquote>
<div CLASS="NumberedNext"><a NAME="pgfId=1013050"></a><font size=+1>3.
Click </font><font face="Arial,Helvetica">Create</font><font size=+1>.
The </font><font face="Arial,Helvetica">Edit Target</font><font size=+1>
window appears.</font></div>
</blockquote>

<blockquote>
<div CLASS="NumberedNext"><a NAME="pgfId=1013051"></a><font size=+1>4.
In the </font><font face="Arial,Helvetica">Build Directory</font><font size=+1>
field, click the “<i><font face="Arial,Helvetica">...</font></i>” button
and select the build directory for the <tt>monop</tt> project (see <a href="#Fig6">Figure
6</a>).</font></div>
</blockquote>

<blockquote>
<div CLASS="FigureTitle"><a NAME="pgfId=1013765"></a><a NAME="Fig6"></a><font size=+1><b>Figure
6: </b><i>Defining the project for building</i></font></div>
</blockquote>

<ol>
<div CLASS="Figure"><a NAME="pgfId=1013296"></a></div>

<p><br><img SRC="int04-4.gif" ></ol>

<blockquote>
<div CLASS="NumberedNext"><a NAME="pgfId=1013055"></a><font size=+1>5.
From </font><font face="Arial,Helvetica">Project Files</font><font size=+1>
in the </font><font face="Arial,Helvetica">Edit Target</font><font size=+1>
window for the <tt>monop</tt> project, select <tt>cards.c</tt>, <tt>execute.c</tt>,
<tt>getinp.c</tt>,
<tt>houses.c</tt>,
<tt>jail.c</tt>,
<tt>misc.c</tt>,
<tt>monop.c</tt>,
<tt>morg.c</tt>,
<tt>print.c</tt>,
<tt>prop.c</tt>,
<tt>rent.c</tt>,
<tt>roll.c</tt>,
<tt>spec.c</tt>,
and
<tt>trade.c</tt> files.</font></div>
</blockquote>

<blockquote>
<div CLASS="NumberedNext"><a NAME="pgfId=1013059"></a><font size=+1>6.
Click the </font><font face="Arial,Helvetica">Add Files</font><font size=+1>
button to copy the files to the </font><font face="Arial,Helvetica">Target
Files</font><font size=+1> list. In <a href="#Fig7" CLASS="XRef">Figure
7</a>, see the result of moving the files from the </font><font face="Arial,Helvetica">Target
Files</font><font size=+1> pane to the </font><font face="Arial,Helvetica">Project
Files</font><font size=+1> pane.</font></div>
</blockquote>

<blockquote>
<div CLASS="FigureTitle"><a NAME="pgfId=1013766"></a><a NAME="Fig7"></a><font size=+1><b>Figure
7: </b><i>Adding the project’s files to the target</i></font></div>
</blockquote>

<ol>
<div CLASS="Figure"><a NAME="Fig7"></a></div>

<p><br><img SRC="int04-5.gif" ></ol>

<blockquote>
<blockquote>
<h6 CLASS="Label">
<a NAME="pgfId=1013060"></a><font size=+1>NOTE:</font></h6>

<div CLASS="Note"><a NAME="pgfId=1013061"></a><font size=+1>To execute
the program correctly in UNIX, click the </font><font face="Arial,Helvetica">Link
Rules</font><font size=+1> tab. Enter <tt>xterm -e bmonop</tt> in the </font><font face="Arial,Helvetica">Command
to launch Application</font><font size=+1> field and click </font><font face="Arial,Helvetica">OK</font><font size=+1>
to close the </font><font face="Arial,Helvetica">Link Rules</font><font size=+1>
window.</font></div>
</blockquote>
</blockquote>

<blockquote>
<div CLASS="NumberedNext"><a NAME="pgfId=1013062"></a><font size=+1>7.
Click </font><font face="Arial,Helvetica">OK</font><font size=+1> to close
the </font><font face="Arial,Helvetica">Edit Target</font><font size=+1>window.
Click </font><font face="Arial,Helvetica">Done</font><font size=+1> to
close the&nbsp;&nbsp;<i> Settings </i>window. The target is created. Now
you need to debug and compile the program. See <a href="#Debug_compile_monop" CLASS="XRef">Debugging
and compiling the <tt>monop</tt> target</a>.</font></div>
</blockquote>

<h2 CLASS="Heading2">
<a NAME="Debug_compile_monop"></a><a NAME="marker=1013403"></a><i>Debugging
and compiling the </i><tt>monop</tt><i> target</i></h2>

<div CLASS="Body"><a NAME="pgfId=1013805"></a><font size=+1>To ensure that
a project can&nbsp;<a NAME="marker=1014131"></a>compile (or&nbsp;<a NAME="marker=1014132"></a>build),
you must first run through a debugging process before using the <tt>make<a NAME="marker=1014133"></a></tt>tool
to create the project.</font></div>

<ol>
<div CLASS="Numbered"><a NAME="pgfId=1013064"></a><font size=+1>1. Select
</font><font face="Arial,Helvetica">Tools</font><i><font size=+1>
-> </font></i><font face="Arial,Helvetica">Build</font><font size=+1> from
the menu bar. The </font><font face="Arial,Helvetica">Build</font><font size=+1>window
opens.</font></div>
</ol>

<blockquote>
<div CLASS="NumberedNext"><a NAME="pgfId=1013068"></a><font size=+1>2.
In </font><font face="Arial,Helvetica">Build Targets</font><font size=+1>,
select <tt>monop</tt> from the target list. See <a href="#Fig8" CLASS="XRef">Figure
8</a>. Click </font><font face="Arial,Helvetica">Start</font><font size=+1>.</font></div>
</blockquote>

<blockquote>
<div CLASS="FigureTitle"><a NAME="pgfId=1013799"></a><a NAME="Fig8"></a><font size=+1><b>Figure
8: </b><i>Running a debugging process for the project before compiling</i></font></div>
</blockquote>

<ol>
<div CLASS="Figure"><a NAME="pgfId=1013290"></a></div>

<p><br><img SRC="int04-6.gif" ></ol>

<blockquote>
<div CLASS="NumberedNext"><a NAME="pgfId=1013069"></a><font size=+1>3.
In this tutorial, Source-Navigator generates some errors from the build.
For instance, <tt>lint</tt> needed to have a definition in the source code.
See <a href="#Fig9" CLASS="XRef">Figure 9</a>.</font></div>
</blockquote>

<blockquote>
<div CLASS="FigureTitle"><a NAME="pgfId=1013826"></a><a NAME="Fig9"></a><font size=+1><b>Figure
9: </b><i>Errors in the project</i></font></div>
</blockquote>

<ol>
<div CLASS="Figure"><a NAME="pgfId=1013289"></a></div>

<p><br><img SRC="int04-7.gif" ></ol>

<h2 CLASS="Heading3">
<a NAME="pgfId=1013073"></a><a NAME="marker=1013404"></a><i>Creating the
</i><tt>lint</tt><i>
macro</i></h2>

<div CLASS="Body"><a NAME="pgfId=1013074"></a><font size=+1>To ensure that
a project can build, edit the macro errors that the debugger finds.</font></div>

<ol>
<div CLASS="Numbered"><a NAME="pgfId=1014134"></a><font size=+1>1. Choose
</font><font face="Arial,Helvetica">Tools</font><font size=+1>
-> </font><font face="Arial,Helvetica">Build Settings...</font><font size=+1>
to start the </font><font face="Arial,Helvetica">Edit Target</font><font size=+1>
window. See <a href="int04.html#Fig10" CLASS="XRef">Figure 10</a>.</font></div>
</ol>

<blockquote>
<div CLASS="NumberedNext"><a NAME="pgfId=1013075"></a><font size=+1>2.
Double-click
<tt>monop</tt> to edit it.</font></div>
</blockquote>

<blockquote>
<div CLASS="NumberedNext"><a NAME="pgfId=1013079"></a><font size=+1>3.
Click the </font><font face="Arial,Helvetica">Build Rules</font><font size=+1>
tab to modify the rules for the build.</font></div>
</blockquote>

<blockquote>
<div CLASS="FigureTitle"><a NAME="pgfId=1013831"></a><a NAME="Fig10"></a><font size=+1><b>Figure
10:&nbsp; </b><i>Modifying how the project builds</i></font></div>
</blockquote>

<ol>
<ol>
<div CLASS="Figure"><a NAME="pgfId=1013288"></a></div>

<p><br><img SRC="int04-8.gif" ></ol>
</ol>

<blockquote>
<div CLASS="NumberedNext"><a NAME="pgfId=1013080"></a><font size=+1>4.
Because <tt>monop</tt> is written in C, double-click the </font><font face="Arial,Helvetica">C</font><font size=+1>
rule in the </font><font face="Arial,Helvetica">File Type</font><font size=+1>
column. The </font><font face="Arial,Helvetica">Build Rules Settings</font><font size=+1>
window appears.</font></div>
</blockquote>

<blockquote>
<div CLASS="NumberedNext"><a NAME="pgfId=1013084"></a><font size=+1>5.
Click the </font><font face="Arial,Helvetica">Defines</font><font size=+1>
tab. Enter <tt>lint</tt> in the text entry box. See <a href="int04.html#Fig11" CLASS="XRef">Figure
11</a>.</font></div>
</blockquote>

<blockquote>
<div CLASS="FigureTitle"><a NAME="pgfId=1013836"></a><a NAME="Fig11"></a><font size=+1><b>Figure
11: </b><i>Defining the </i><tt>lint</tt> <i>macro</i></font></div>
</blockquote>

<ol>
<ol>
<div CLASS="Figure"><a NAME="pgfId=1013284"></a></div>

<p><br><img SRC="int04-9.gif" ></ol>
</ol>

<blockquote>
<div CLASS="NumberedNext"><a NAME="pgfId=1013085"></a><font size=+1>6.
Click </font><font face="Arial,Helvetica">New</font><font size=+1> to create
the macro.</font></div>
</blockquote>

<blockquote>
<div CLASS="NumberedNext"><a NAME="pgfId=1013086"></a><font size=+1>7.
Click </font><font face="Arial,Helvetica">OK</font><font size=+1> to close
the </font><font face="Arial,Helvetica">Build Rules Settings</font><font size=+1>
window. Click </font><font face="Arial,Helvetica">OK</font><font size=+1>
to close the </font><font face="Arial,Helvetica">Edit Target</font><font size=+1>
window. Click </font><font face="Arial,Helvetica">Done</font><font size=+1>
to close the </font><font face="Arial,Helvetica">Build Settings</font><font size=+1>
window.</font></div>
</blockquote>

<blockquote>
<div CLASS="NumberedNext"><a NAME="pgfId=1013087"></a><font size=+1>8.
Select </font><font face="Arial,Helvetica">Tools</font><i><font size=+1>
-> </font></i><font face="Arial,Helvetica">Build</font><font size=+1> from
the menu bar and select <tt>monop</tt> from the target list.</font></div>
</blockquote>

<blockquote>
<div CLASS="NumberedNext"><a NAME="pgfId=1013088"></a><font size=+1>9.
<tt>monop</tt>
generates without errors. However, at runtime the program does not run
because we still need to define the path to the cards pack.</font></div>
</blockquote>

<h2 CLASS="Heading3">
<a NAME="pgfId=1013089"></a><a NAME="Create_PATH"></a><i>Creating the</i><tt>
_PATH_CARDS </tt><i>macro</i></h2>

<div CLASS="Body"><a NAME="pgfId=1013843"></a><font size=+1>Now, define
the other macro, <tt>_PATH_CARDS</tt>, to continue making the project work.</font></div>

<ol>
<div CLASS="Numbered"><a NAME="pgfId=1013090"></a><font size=+1>1. Choose
</font><font face="Arial,Helvetica">Tools</font><i><font size=+1>
-> </font></i><font face="Arial,Helvetica">Build Settings...</font><font size=+1>
to start the </font><font face="Arial,Helvetica">Edit Target</font><font size=+1>
window.</font></div>
</ol>

<blockquote>
<div CLASS="NumberedNext"><a NAME="pgfId=1013091"></a><font size=+1>2.
Double-click <tt>monop</tt> to edit it.</font></div>
</blockquote>

<blockquote>
<div CLASS="NumberedNext"><a NAME="pgfId=1013095"></a><font size=+1>3.
Click the </font><font face="Arial,Helvetica">Build Rules</font><font size=+1>
tab to modify the rules for the build. See <a href="#Fig12" CLASS="XRef">Figure
12</a>.</font></div>
</blockquote>

<blockquote>
<div CLASS="FigureTitle"><a NAME="pgfId=1013852"></a><a NAME="Fig12"></a><font size=+1><b>Figure
12: </b><i>Modifying the project’s macros</i></font></div>
</blockquote>

<ol>
<div CLASS="Figure"><a NAME="pgfId=1013283"></a></div>

<p><br><img SRC="int04-10.gif" ></ol>

<blockquote>
<div CLASS="NumberedNext"><a NAME="pgfId=1013096"></a><font size=+1>4.
Because <tt>monop</tt> is written in C, double-click the </font><font face="Arial,Helvetica">C</font><font size=+1>
rule. The </font><font face="Arial,Helvetica">Build Rules Settings</font><font size=+1>window
appears, as in <a href="int04.html#Fig13" CLASS="XRef">Figure 13</a>.</font></div>
</blockquote>

<blockquote>
<div CLASS="NumberedNext"><a NAME="pgfId=1013097"></a><font size=+1>5.
Click the </font><font face="Arial,Helvetica">Defines</font><font size=+1>
tab.</font></div>
</blockquote>

<blockquote>
<div CLASS="NumberedNext"><a NAME="pgfId=1013098"></a><font size=+1>6.
Enter the following input in the dialog below the </font><font face="Arial,Helvetica">Macro
defines </font><font size=+1>pane, replacing </font><i><tt>&lt;project
directory></tt></i><font size=+1> with your path to the <tt>demos\monop</tt>
directory:</font></div>

<blockquote>
<pre CLASS="CodeExample2"><a NAME="pgfId=1013102"></a><font size=+1><tt>_PATH_CARDS=</tt> "<tt> \</tt> "<i> <tt>&lt;project directory></tt></i><tt>/cards.pck\</tt> ""</font></pre>
</blockquote>
</blockquote>

<blockquote>
<div CLASS="FigureTitle"><a NAME="pgfId=1013857"></a><a NAME="Fig13"></a><font size=+1><b>Figure
13: </b><i>Re-defining a project’s macro</i></font></div>
</blockquote>

<ol>
<div CLASS="Figure"><a NAME="pgfId=1013282"></a></div>

<p><br><img SRC="int04-11.gif" >
<div CLASS="BodyListFollow"><a NAME="pgfId=1013106"></a><font size=+1>Now,
GNUPro Toolkit uses an appropriate definition for the card pack macro,
<tt>_PATH_CARDS</tt>,
when running the <tt>monop</tt> program.</font></div>
</ol>

<blockquote>
<div CLASS="NumberedNext"><a NAME="pgfId=1013107"></a><font size=+1>7.
Click </font><font face="Arial,Helvetica">OK</font><font size=+1> to close
the </font><font face="Arial,Helvetica">Build Rules Settings</font><font size=+1>
window. Click </font><font face="Arial,Helvetica">OK</font><font size=+1>
to close the </font><font face="Arial,Helvetica">Edit Target</font><font size=+1>
window. Click </font><font face="Arial,Helvetica">Done</font><font size=+1>
to close the </font><font face="Arial,Helvetica">Build Settings </font><font size=+1>window.</font></div>
</blockquote>

<blockquote>
<div CLASS="NumberedNext"><a NAME="pgfId=1013108"></a><font size=+1>8.
Select </font><font face="Arial,Helvetica">Tools</font><i><font size=+1>
-> </font></i><font face="Arial,Helvetica">Build</font><font size=+1> from
the menu bar and select <tt>monop</tt> from the target list. Click </font><font face="Arial,Helvetica">Start</font><font size=+1>
to perform the build.</font></div>
</blockquote>

<blockquote>
<div CLASS="NumberedNext"><a NAME="pgfId=1013109"></a><font size=+1>9.
<tt>_PATH_CARDS="\"<i>&lt;build
directory></i>/cards.pack\""</tt>&nbsp; is a macro. To ensure that this
change is picked up at compile time, perform a clean build of the <tt>monop</tt>
target project by selecting </font><font face="Arial,Helvetica">Tools</font><i><font size=+1>-></font></i><font face="Arial,Helvetica">Clean
Build</font><font size=+1> in the </font><font face="Arial,Helvetica">Build</font><font size=+1>
window (see <a href="int04.html#Fig14" CLASS="XRef">Figure 14</a>).</font></div>

<div CLASS="NumberedNext"><font size=+1>A clean build is equivalent to
the <tt>make clean</tt> command.</font></div>
</blockquote>

<blockquote>
<div CLASS="FigureTitle"><a NAME="pgfId=1013884"></a><a NAME="Fig14"></a><font size=+1><b>Figure
14: </b><i>Performing a clean build for a project</i></font></div>
</blockquote>

<ol>
<div CLASS="Figure"><a NAME="pgfId=1013281"></a></div>

<p><br><img SRC="int04-12.gif" ></ol>

<blockquote>
<div CLASS="NumberedNext"><a NAME="pgfId=1013113"></a><font size=+1>10.
Click the </font><font face="Arial,Helvetica">Start</font><font size=+1>
button to perform the build.</font></div>
</blockquote>

<blockquote>
<div CLASS="NumberedNext"><a NAME="pgfId=1013117"></a><font size=+1>11.
Now, the <tt>monop</tt> project compiles without errors (see <a href="#Fig15" CLASS="XRef">Figure
15</a>).</font></div>
</blockquote>

<blockquote>
<div CLASS="FigureTitle"><a NAME="pgfId=1013891"></a><a NAME="Fig15"></a><font size=+1><b>Figure
15: </b><i>A clean build of a project</i></font></div>
</blockquote>

<ol>
<div CLASS="Figure"><a NAME="pgfId=1013277"></a></div>

<p><br><img SRC="int04-13.gif" ></ol>

<h2 CLASS="Heading2">
<a NAME="pgfId=1013118"></a><a NAME="41715"></a><a NAME="Building_initdeck"></a><i>Building
the </i><tt>initdeck</tt><i> target</i></h2>

<div CLASS="Body"><a NAME="pgfId=1013119"></a><font size=+1>Next, you need
to create another target to initialize the cards in the <tt>monop</tt>
game.</font></div>

<ol>
<div CLASS="Numbered"><a NAME="pgfId=1013120"></a><font size=+1>1. Choose
</font><font face="Arial,Helvetica">Tools</font><i><font size=+1>
-> </font></i><font face="Arial,Helvetica">Build Settings...</font><font size=+1>
to invoke the </font><font face="Arial,Helvetica">Build Target</font><font size=+1>
window.</font></div>
</ol>

<blockquote>
<div CLASS="NumberedNext"><a NAME="pgfId=1013124"></a><font size=+1>2.
Enter <tt>initdeck</tt> as the name of the target (see <a href="#Fig16" CLASS="XRef">Figure
16</a>).</font></div>
</blockquote>

<blockquote>
<div CLASS="FigureTitle"><a NAME="pgfId=1013898"></a><a NAME="Fig16"></a><font size=+1><b>Figure
16: </b><i>Defining another target for a project</i></font></div>
</blockquote>

<ol>
<div CLASS="Figure"><a NAME="pgfId=1013276"></a></div>

<p><br><img SRC="int04-14.gif" ></ol>

<blockquote>
<div CLASS="NumberedNext"><a NAME="pgfId=1013125"></a><font size=+1>Click
</font><font face="Arial,Helvetica">Create</font><font size=+1>.
The </font><font face="Arial,Helvetica">Edit Target</font><font size=+1>
window appears (see <a href="int04.html#Fig17" CLASS="XRef">Figure 17</a>).</font></div>
</blockquote>

<blockquote>
<div CLASS="NumberedNext"><a NAME="pgfId=1013126"></a><font size=+1>In
the </font><font face="Arial,Helvetica">Build Directory</font><font size=+1>
field, click the “...” button and select the <tt>monop</tt> directory.</font></div>
</blockquote>

<blockquote>
<div CLASS="NumberedNext"><a NAME="pgfId=1013127"></a><font size=+1>From
</font><font face="Arial,Helvetica">Source
Files</font><font size=+1>, select the <tt>initdeck.c </tt>file and click
the </font><font face="Arial,Helvetica">Add Files</font><font size=+1>button
to copy the file to the </font><font face="Arial,Helvetica">Target Files</font><font size=+1>
list.</font></div>
</blockquote>

<blockquote>
<div CLASS="FigureTitle"><a NAME="pgfId=1013912"></a><a NAME="Fig17"></a><b><font size=+1>Figure
17: </font></b><i><font size=+1>Creating a new target for a project</font></i></div>
</blockquote>

<ol>
<div CLASS="Figure"><a NAME="pgfId=1013275"></a></div>

<p><br><img SRC="int04-15.gif" ></ol>

<blockquote>
<div CLASS="NumberedNext"><a NAME="pgfId=1013131"></a><font size=+1>Click
</font><font face="Arial,Helvetica">OK</font><font size=+1>
to close the
</font><font face="Arial,Helvetica">Edit Target</font><font size=+1>
window. Click </font><font face="Arial,Helvetica">Done</font><font size=+1>
to close the </font><font face="Arial,Helvetica">Build Settings</font><font size=+1>window,
having defined and created the new target.</font></div>
</blockquote>

<h2 CLASS="Heading2">
<a NAME="pgfId=1013132"></a><a NAME="33257"></a><a NAME="Debug_initdeck"></a><i>Debugging
the </i><tt>initdeck</tt><i> target</i></h2>

<div CLASS="Body"><a NAME="pgfId=1013133"></a><font size=+1>To ensure that
a project can build with the new target, edit the macro errors that the
debugger finds.</font></div>

<ol>
<div CLASS="Numbered"><a NAME="pgfId=1014151"></a><font size=+1>1. Build
the target by selecting </font><font face="Arial,Helvetica">Tools</font><i><font size=+1>
-> </font></i><font face="Arial,Helvetica">Build</font><font size=+1> from
the menu bar of the </font><font face="Arial,Helvetica">Build</font><font size=+1>
window. Select <tt>initdeck</tt> from the target list, and click </font><font face="Arial,Helvetica">Start</font><font size=+1>.</font></div>
</ol>

<blockquote>
<div CLASS="NumberedNext"><a NAME="pgfId=1013134"></a><font size=+1>2.
<tt>initdeck</tt>
generates with errors. Again, we need to define the <tt>lint</tt> macro
and the path to the cards.</font></div>
</blockquote>

<blockquote>
<div CLASS="NumberedNext"><a NAME="pgfId=1013135"></a><font size=+1>3.
Choose </font><font face="Arial,Helvetica">Tools</font><i><font size=+1>
-> </font></i><font face="Arial,Helvetica">Build Settings...</font><font size=+1>
to start the </font><font face="Arial,Helvetica">Build Settings</font><font size=+1>window.</font></div>
</blockquote>

<blockquote>
<div CLASS="NumberedNext"><a NAME="pgfId=1013136"></a><font size=+1>4.
Double-click <tt>initdeck</tt> to edit it.</font></div>
</blockquote>

<blockquote>
<div CLASS="NumberedNext"><a NAME="pgfId=1013137"></a><font size=+1>5.
Click the </font><font face="Arial,Helvetica">Build Rules</font><font size=+1>
tab. Double-click the </font><font face="Arial,Helvetica">C</font><font size=+1>
rule. The </font><font face="Arial,Helvetica">Build Rules Settings </font><font size=+1>window
appears (see <a href="int04.html#Fig18" CLASS="XRef">Figure 18</a>). Click
the </font><font face="Arial,Helvetica">Defines</font><font size=+1> tab.
Enter <tt>lint</tt> in the text entry box.</font></div>
</blockquote>

<blockquote>
<div CLASS="FigureTitle"><a NAME="pgfId=1013933"></a><a NAME="30130"></a><a NAME="Fig18"></a><font size=+1><b>Figure
18: </b><i>Defining the </i><tt>lint</tt><i> macro for the new target</i></font></div>
</blockquote>

<ol>
<div CLASS="Figure"><a NAME="pgfId=1013274"></a></div>

<p><br><img SRC="int04-16.gif" ></ol>

<blockquote>
<div CLASS="NumberedNext"><a NAME="pgfId=1013141"></a><font size=+1>6.
Click </font><font face="Arial,Helvetica">New</font><font size=+1> to create
the macro. Enter the following input in the dialog below the </font><font face="Arial,Helvetica">Macro
defines</font><font size=+1> pane, replacing </font><tt>&lt;<i>project
directory</i>>
</tt><font size=+1>with your path to the <tt>demos\monop</tt>
directory (see <a href="int04.html#Fig19">Figure 19</a> as an example):</font></div>
</blockquote>

<blockquote>
<pre CLASS="CodeExample2"><a NAME="pgfId=1013146"></a><tt>_PATH_CARDS=</tt> "<tt> \</tt> "<i> &lt;project directory></i><tt>/cards.pck\</tt> ""</pre>
</blockquote>

<blockquote>
<div CLASS="FigureTitle"><a NAME="Fig19"></a><font size=+1><b>Figure 19:
</b><i>Defining
the path for the new target</i></font></div>
</blockquote>

<ol>
<div CLASS="Figure"><a NAME="pgfId=1013271"></a></div>

<p><br><img SRC="int04-17.gif" >
<div CLASS="BodyListFollow"><a NAME="pgfId=1013150"></a><font size=+1>Now,
GNUPro Toolkit uses an appropriate definition for the card pack when running
the <tt>monop</tt> program.</font></div>
</ol>

<blockquote>
<div CLASS="NumberedNext"><a NAME="pgfId=1013151"></a><font size=+1>Click
OK to close the </font><font face="Arial,Helvetica">Build Rules Settings</font><font size=+1>
window. Click </font><font face="Arial,Helvetica">OK</font><font size=+1>
to close the </font><font face="Arial,Helvetica">Edit Target</font><font size=+1>
window. Click </font><font face="Arial,Helvetica">Done</font><font size=+1>
to close the </font><font face="Arial,Helvetica">Build Settings</font><font size=+1>
window, having modified the target for the project.</font></div>
</blockquote>

<blockquote>
<div CLASS="NumberedNext"><a NAME="pgfId=1013152"></a><font size=+1>Open
a shell window and copy the <tt>cards.inp</tt> file in the <tt>demos\monop</tt>directory
into the build directory (see <a href="#Fig20" CLASS="XRef">Figure 20</a>
for an example of the <tt>copy</tt> command in a </font><font face="Arial,Helvetica">Command.com</font><font size=+1>
shell window that a Windows NT developer could use; UNIX users would use
the <tt>cp</tt> command in a shell window).</font></div>
</blockquote>

<blockquote>
<div CLASS="FigureTitle"><a NAME="pgfId=1013972"></a><a NAME="Fig20"></a><font size=+1><b>Figure
20: </b><i>Copying files for the project in a shell window</i></font></div>
</blockquote>

<ol>
<div CLASS="Figure"><a NAME="pgfId=1013270"></a></div>

<p><br><img SRC="int04-18.gif" ></ol>

<blockquote>
<div CLASS="NumberedNext"><a NAME="pgfId=1013156"></a><font size=+1>Select
</font><font face="Arial,Helvetica">Tools</font><i><font size=+1>->
</font></i><font face="Arial,Helvetica">Build</font><font size=+1>
from the menu bar and select <tt>initdeck</tt> from the target list.</font></div>
</blockquote>

<blockquote>
<div CLASS="NumberedNext"><a NAME="pgfId=1013157"></a><font size=+1>To
ensure that the macro changes are picked up at compile time, perform a
clean build of the <tt>initdeck</tt> target by selecting </font><font face="Arial,Helvetica">Tools</font><i><font size=+1>
-> </font></i><font face="Arial,Helvetica">Clean Build</font><font size=+1>
(see <a href="#Fig21">Figure 21</a>).</font></div>
</blockquote>

<blockquote>
<div CLASS="FigureTitle"><a NAME="pgfId=1014000"></a><a NAME="Fig21"></a><font size=+1><b>Figure
21: </b><i>Performing a clean build for the new target for the project</i></font></div>
</blockquote>

<ol>
<div CLASS="Figure"><a NAME="pgfId=1013269"></a></div>

<p><br><img SRC="int04-19.gif" ></ol>

<blockquote>
<div CLASS="NumberedNext"><a NAME="pgfId=1013161"></a><font size=+1>Click
the </font><font face="Arial,Helvetica">Start</font><font size=+1> button
to perform the build.</font></div>
</blockquote>

<blockquote>
<div CLASS="NumberedNext"><a NAME="pgfId=1013162"></a><font size=+1>Now,
<tt>initdeck</tt>
compiles and links without errors. <tt>binitdeck</tt> is the name of the
working executable.</font></div>
</blockquote>

<blockquote>
<div CLASS="NumberedNext"><a NAME="pgfId=1013163"></a><font size=+1>Click
the </font><font face="Arial,Helvetica">Run</font><font size=+1> button
to run <tt>binitdeck</tt> which creates the cards used in the game.</font></div>

<div CLASS="BodyListFollow"><a NAME="pgfId=1013167"></a><font size=+1>A
shell window opens to build the cards (see <a href="#Fig22" CLASS="XRef">Figure
22</a>) and closes after the build is complete.</font></div>
</blockquote>

<blockquote>
<div CLASS="FigureTitle"><a NAME="pgfId=1014012"></a><a NAME="Fig22"></a><font size=+1><b>Figure
22: </b><i>Rebuilding the new target for the project</i></font></div>
</blockquote>

<ol>
<div CLASS="Figure"><a NAME="pgfId=1013266"></a></div>

<p><br><img SRC="int04-20.gif" ></ol>

<blockquote>
<div CLASS="NumberedNext"><a NAME="pgfId=1013168"></a><font size=+1>From
the </font><font face="Arial,Helvetica">Build Targets</font><font size=+1>
field of the </font><font face="Arial,Helvetica">Build</font><font size=+1>
window, select <tt>monop</tt> and click </font><font face="Arial,Helvetica">Run</font><font size=+1>.</font></div>

<div CLASS="BodyListFollow"><a NAME="pgfId=1013255"></a><font size=+1>A
shell window opens and <tt>monop</tt> runs automatically. Enter the number
of players and their names. See <a href="#Fig23">Figure 23</a> for an example
in a shell window of a project that builds and is ready to run.</font></div>

<div CLASS="BodyListFollow"><a NAME="pgfId=1013393"></a><font size=+1>Use
the </font><font face="Arial,Helvetica">?</font><font size=+1><i> </i>key
to get playing options for <tt>monop</tt>. Oh, have fun.</font></div>
</blockquote>

<blockquote>
<div CLASS="FigureTitle"><a NAME="pgfId=1014017"></a><a NAME="Fig23"></a><font size=+1><b>Figure
23: </b><i>A built project that's ready to run</i></font></div>
</blockquote>

<ol>
<div CLASS="Figure"><a NAME="pgfId=1013262"></a></div>

<p><br><img SRC="int04-21.gif" ></ol>

<div CLASS="BodyListFollow"><a NAME="pgfId=1007999"></a></div>

<hr SIZE=6 WIDTH="100%">
<center><a href="#Top">Top</a>|<a href="gsTOC.html">Contents</a>|<a href="int03.html">Previous</a>|<a href="int05.html">Next</a></center>
</div>

</body>
</html>
